(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[905],{7187:function(e){"use strict";var t,n="object"==typeof Reflect?Reflect:null,r=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise(function(n,r){function i(n){e.removeListener(t,o),r(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}m(e,t,o,{once:!0}),"error"!==t&&"function"==typeof e.on&&m(e,"error",i,{once:!0})})},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!=typeof e)throw TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function u(e,t,n,r){if(a(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]),void 0===s)s=o[t]=n,++e._eventsCount;else if("function"==typeof s?s=o[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(i=c(e))>0&&s.length>i&&!s.warned){s.warned=!0;var i,o,s,u=Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,console&&console.warn&&console.warn(u)}return e}function d(){if(!this.fired)return(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0==arguments.length)?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function l(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=d.bind(r);return i.listener=n,r.wrapFn=i,i}function p(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):f(i,i.length)}function h(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function f(e,t){for(var n=Array(t),r=0;r<t;++r)n[r]=e[r];return n}function m(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else if("function"==typeof e.addEventListener)e.addEventListener(t,function i(o){r.once&&e.removeEventListener(t,i),n(o)});else throw TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||i(e))throw RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),o.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return c(this)},o.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var s,a=Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[e];if(void 0===c)return!1;if("function"==typeof c)r(c,this,t);else for(var u=c.length,d=f(c,u),n=0;n<u;++n)r(d[n],this,t);return!0},o.prototype.addListener=function(e,t){return u(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return u(this,e,t,!0)},o.prototype.once=function(e,t){return a(t),this.on(e,l(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,l(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,r,i,o,s;if(a(t),void 0===(r=this._events)||void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0==arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0==arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},o.prototype.listeners=function(e){return p(this,e,!0)},o.prototype.rawListeners=function(e){return p(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},o.prototype.listenerCount=h,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},8483:function(e,t,n){"use strict";var r=n(7879);e.exports=function(e){var t,i={stun:(e||{}).stun||n(8808),turn:(e||{}).turn||n(4576)},o=(e||{}).stunCount||2,s=(e||{}).turnCount||0;function a(e,t){for(var n,o=[],s=[].concat(i[e]);s.length&&o.length<t;)n=Math.random()*s.length|0,o=o.concat(s.splice(n,1));return o.map(function(t){return"string"==typeof t||t instanceof String?r(e+":"+t):t})}return t=[].concat(a("stun",o)),s&&(t=t.concat(a("turn",s))),t}},8233:function(e,t,n){var r,i=n(4114);"undefined"!=typeof window&&(r=window.AudioContext||window.webkitAudioContext);var o=null;e.exports=function(e,t){var n,s,a,c=new i;if(!r)return c;var t=t||{},u=t.smoothing||.1,d=t.interval||50,l=t.threshold,p=t.play,h=t.history||10,f=!0;(a=(o=t.audioContext||o||new r).createAnalyser()).fftSize=512,a.smoothingTimeConstant=u,s=new Float32Array(a.frequencyBinCount),e.jquery&&(e=e[0]),e instanceof HTMLAudioElement||e instanceof HTMLVideoElement?(n=o.createMediaElementSource(e),void 0===p&&(p=!0)):n=o.createMediaStreamSource(e),l=l||-50,n.connect(a),p&&a.connect(o.destination),c.speaking=!1,c.suspend=function(){return o.suspend()},c.resume=function(){return o.resume()},Object.defineProperty(c,"state",{get:function(){return o.state}}),o.onstatechange=function(){c.emit("state_change",o.state)},c.setThreshold=function(e){l=e},c.setInterval=function(e){d=e},c.stop=function(){f=!1,c.emit("volume_change",-100,l),c.speaking&&(c.speaking=!1,c.emit("stopped_speaking")),a.disconnect(),n.disconnect()},c.speakingHistory=[];for(var m=0;m<h;m++)c.speakingHistory.push(0);var v=function(){setTimeout(function(){if(f){var e=function(e,t){var n=-1/0;e.getFloatFrequencyData(t);for(var r=4,i=t.length;r<i;r++)t[r]>n&&t[r]<0&&(n=t[r]);return n}(a,s);c.emit("volume_change",e,l);var t=0;if(e>l&&!c.speaking){for(var n=c.speakingHistory.length-3;n<c.speakingHistory.length;n++)t+=c.speakingHistory[n];t>=2&&(c.speaking=!0,c.emit("speaking"))}else if(e<l&&c.speaking){for(var n=0;n<c.speakingHistory.length;n++)t+=c.speakingHistory[n];0==t&&(c.speaking=!1,c.emit("stopped_speaking"))}c.speakingHistory.shift(),c.speakingHistory.push(0+(e>l)),v()}},d)};return v(),c}},3129:function(e,t){var n,r,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function o(e){if(!e)return o.__;Array.prototype.reduce||(Array.prototype.reduce=function(e,t){for(var n=t,r=0;r<this.length;r++)n=e(n,this[r],r,this);return n});var t="";return("."+e).split(".").reduce(function(e,n,r,i){t?t+="."+n:t=n;var s=e["__"+t];return void 0===s&&(o.Logger.prototype=e,s=new o.Logger(t),e["__"+t]=s),s},o.__)}!function(e){function t(e,t,n){if(void 0!==t[e]){if(null===t[e]){delete n[e];return}n[e]=t[e]}}function n(t){if(null!=e.enabled&&!e.enabled)return!1;try{if(t.userAgentRegex&&!new RegExp(t.userAgentRegex).test(navigator.userAgent))return!1}catch(e){}try{if(t.ipRegex&&e.clientIP&&!new RegExp(t.ipRegex).test(e.clientIP))return!1}catch(e){}return!0}function r(e,t){try{if(e.disallow&&new RegExp(e.disallow).test(t))return!1}catch(e){}return!0}function o(e){return"function"==typeof e?e instanceof RegExp?e.toString():e():e}e.requestId="",e.entryId=0,e._createXMLHttpRequest=function(){return new XMLHttpRequest},e._getTime=function(){return(new Date).getTime()},e._console=console,e._appenderNames=[];var s,a=function(e,t,n){this.msg=e,this.meta=t,this.finalString=n};function c(t){var n,r=o(t);switch(typeof r){case"string":return new a(r,null,r);case"number":case"boolean":return n=r.toString(),new a(n,null,n);case"undefined":return new a("undefined",null,"undefined");case"object":if(r instanceof RegExp||r instanceof String||r instanceof Number||r instanceof Boolean)return n=r.toString(),new a(n,null,n);return n="function"==typeof e.serialize?e.serialize.call(this,r):JSON.stringify(r),new a("",r,n);default:return new a("unknown",null,"unknown")}}function u(){return 1e3}function d(){return 2e3}function l(){return 3e3}function p(){return 4e3}function h(){return 5e3}function f(){return 6e3}e.setOptions=function(e){return t("enabled",e,this),t("maxMessages",e,this),t("defaultAjaxUrl",e,this),t("clientIP",e,this),t("requestId",e,this),t("defaultBeforeSend",e,this),t("serialize",e,this),this},e.getAllLevel=function(){return -2147483648},e.getTraceLevel=u,e.getDebugLevel=d,e.getInfoLevel=l,e.getWarnLevel=p,e.getErrorLevel=h,e.getFatalLevel=f,e.getOffLevel=function(){return 2147483647};var m=function(e,t){this.inner=t,this.name="JL.Exception",this.message=c(e).finalString};e.Exception=m,m.prototype=Error();var v=function(e,t,n,r,i){this.l=e,this.m=t,this.n=n,this.t=r,this.u=i};function g(t,n,r){return e.entryId++,new v(t,n,r,e._getTime(),e.entryId)}function b(e){e.id&&(clearTimeout(e.id),e.id=null)}function E(e,t,n){var r=this;e.id||(e.id=setTimeout(function(){n.call(r)},t))}e.LogItem=v;var y=function(){function i(t,n){this.appenderName=t,this.sendLogItems=n,this.level=e.getTraceLevel(),this.sendWithBufferLevel=2147483647,this.storeInBufferLevel=-2147483648,this.bufferSize=0,this.batchSize=1,this.maxBatchSize=20,this.batchTimeout=2147483647,this.sendTimeout=5e3,this.buffer=[],this.batchBuffer=[],this.batchTimeoutTimer={id:null},this.sendTimeoutTimer={id:null},this.nbrLogItemsSkipped=0,this.nbrLogItemsBeingSent=0;var r="Trying to create an appender without a name or with an empty name";if(void 0==t)throw r;if(-1!=e._appenderNames.indexOf(t)){if(!t)throw r;throw"Multiple appenders use the same name "+t}e._appenderNames.push(t)}return i.prototype.addLogItemsToBuffer=function(t){if(this.batchBuffer.length>=this.maxBatchSize){this.nbrLogItemsSkipped+=t.length;return}if(null!=e.maxMessages){if(e.maxMessages<1)return;e.maxMessages-=t.length}this.batchBuffer=this.batchBuffer.concat(t);var n=this;E(this.batchTimeoutTimer,this.batchTimeout,function(){n.sendBatch.call(n)})},i.prototype.batchBufferHasOverdueMessages=function(){for(var t=0;t<this.batchBuffer.length;t++)if(e._getTime()-this.batchBuffer[t].t>this.batchTimeout)return!0;return!1},i.prototype.batchBufferHasStrandedMessage=function(){return null!=e.maxMessages&&e.maxMessages<1&&this.batchBuffer.length>0},i.prototype.sendBatchIfComplete=function(){(this.batchBuffer.length>=this.batchSize||this.batchBufferHasOverdueMessages()||this.batchBufferHasStrandedMessage())&&this.sendBatch()},i.prototype.onSendingEnded=function(){b(this.sendTimeoutTimer),this.nbrLogItemsBeingSent=0,this.sendBatchIfComplete()},i.prototype.setOptions=function(n){if(t("level",n,this),t("ipRegex",n,this),t("userAgentRegex",n,this),t("disallow",n,this),t("sendWithBufferLevel",n,this),t("storeInBufferLevel",n,this),t("bufferSize",n,this),t("batchSize",n,this),t("maxBatchSize",n,this),t("batchTimeout",n,this),t("sendTimeout",n,this),this.bufferSize<this.buffer.length&&(this.buffer.length=this.bufferSize),this.maxBatchSize<this.batchSize)throw new e.Exception({message:"maxBatchSize cannot be smaller than batchSize",maxBatchSize:this.maxBatchSize,batchSize:this.batchSize});return this},i.prototype.log=function(e,t,i,o,s,a,c){var u;if(n(this)&&r(this,a)&&!(s<this.storeInBufferLevel)){if(u=g(s,a,c),s<this.level){this.bufferSize>0&&(this.buffer.push(u),this.buffer.length>this.bufferSize&&this.buffer.shift());return}this.addLogItemsToBuffer([u]),s>=this.sendWithBufferLevel&&this.buffer.length&&(this.addLogItemsToBuffer(this.buffer),this.buffer.length=0),this.sendBatchIfComplete()}},i.prototype.sendBatch=function(){if(!(this.nbrLogItemsBeingSent>0)&&(b(this.batchTimeoutTimer),0!=this.batchBuffer.length)){this.nbrLogItemsBeingSent=this.batchBuffer.length;var e=this;E(this.sendTimeoutTimer,this.sendTimeout,function(){e.onSendingEnded.call(e)}),this.sendLogItems(this.batchBuffer,function(){e.batchBuffer.splice(0,e.nbrLogItemsBeingSent),e.nbrLogItemsSkipped>0&&(e.batchBuffer.push(g(p(),"Lost "+e.nbrLogItemsSkipped+" messages. Either connection with the server was down or logging was disabled via the enabled option. Reduce lost messages by increasing the ajaxAppender option maxBatchSize.",e.appenderName)),e.nbrLogItemsSkipped=0),e.onSendingEnded.call(e)})}},i}();e.Appender=y;var S=function(r){function o(e){return r.call(this,e,o.prototype.sendLogItemsAjax)||this}return i(o,r),o.prototype.setOptions=function(e){return t("url",e,this),t("beforeSend",e,this),r.prototype.setOptions.call(this,e),this},o.prototype.sendLogItemsAjax=function(t,r){try{if(!n(this))return;this.xhr&&0!=this.xhr.readyState&&4!=this.xhr.readyState&&this.xhr.abort(),this.xhr=e._createXMLHttpRequest();var i="/jsnlog.logger";null!=e.defaultAjaxUrl&&(i=e.defaultAjaxUrl),this.url&&(i=this.url),this.xhr.open("POST",i),this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.setRequestHeader("JSNLog-RequestId",e.requestId);var o=this;this.xhr.onreadystatechange=function(){4==o.xhr.readyState&&o.xhr.status>=200&&o.xhr.status<300&&r()};var s={r:e.requestId,lg:t};"function"==typeof this.beforeSend?this.beforeSend.call(this,this.xhr,s):"function"==typeof e.defaultBeforeSend&&e.defaultBeforeSend.call(this,this.xhr,s);var a=JSON.stringify(s);this.xhr.send(a)}catch(e){}},o}(y);e.AjaxAppender=S;var w=function(t){function r(e){return t.call(this,e,r.prototype.sendLogItemsConsole)||this}return i(r,t),r.prototype.clog=function(t){e._console.log(t)},r.prototype.cerror=function(t){e._console.error?e._console.error(t):this.clog(t)},r.prototype.cwarn=function(t){e._console.warn?e._console.warn(t):this.clog(t)},r.prototype.cinfo=function(t){e._console.info?e._console.info(t):this.clog(t)},r.prototype.cdebug=function(t){e._console.debug?e._console.debug(t):this.cinfo(t)},r.prototype.sendLogItemsConsole=function(t,r){try{if(!n(this)||!e._console)return;for(i=0;i<t.length;++i){var i,o=t[i],s=o.n+": "+o.m;"undefined"==typeof window&&(s=new Date(o.t)+" | "+s),o.l<=e.getDebugLevel()?this.cdebug(s):o.l<=e.getInfoLevel()?this.cinfo(s):o.l<=e.getWarnLevel()?this.cwarn(s):this.cerror(s)}}catch(e){}r()},r}(y);e.ConsoleAppender=w;var O=function(){function e(e){this.loggerName=e,this.seenRegexes=[]}return e.prototype.setOptions=function(e){return t("level",e,this),t("userAgentRegex",e,this),t("disallow",e,this),t("ipRegex",e,this),t("appenders",e,this),t("onceOnly",e,this),this.seenRegexes=[],this},e.prototype.buildExceptionObject=function(e){var t={};return e.stack?t.stack=e.stack:t.e=e,e.message&&(t.message=e.message),e.name&&(t.name=e.name),e.data&&(t.data=e.data),e.inner&&(t.inner=this.buildExceptionObject(e.inner)),t},e.prototype.log=function(e,t,i){var s,a,u=0;if(!this.appenders)return this;if(e>=this.level&&n(this)&&(i?(a=this.buildExceptionObject(i)).logData=o(t):a=t,r(this,(s=c(a)).finalString))){if(this.onceOnly)for(u=this.onceOnly.length-1;u>=0;){if(new RegExp(this.onceOnly[u]).test(s.finalString)){if(this.seenRegexes[u])return this;this.seenRegexes[u]=!0}u--}for(s.meta=s.meta||{},u=this.appenders.length-1;u>=0;)this.appenders[u].log(e<=1e3?"trace":e<=2e3?"debug":e<=3e3?"info":e<=4e3?"warn":e<=5e3?"error":"fatal",s.msg,s.meta,function(){},e,s.finalString,this.loggerName),u--}return this},e.prototype.trace=function(e){return this.log(u(),e)},e.prototype.debug=function(e){return this.log(d(),e)},e.prototype.info=function(e){return this.log(l(),e)},e.prototype.warn=function(e){return this.log(p(),e)},e.prototype.error=function(e){return this.log(h(),e)},e.prototype.fatal=function(e){return this.log(f(),e)},e.prototype.fatalException=function(e,t){return this.log(f(),e,t)},e}();e.Logger=O,e.createAjaxAppender=function(e){return new S(e)},e.createConsoleAppender=function(e){return new w(e)},s="undefined"!=typeof window?new S(""):new w(""),e.__=new e.Logger(""),e.__.setOptions({level:e.getDebugLevel(),appenders:[s]})}(o||(o={})),t.__esModule=!0,t.JL=o,"function"==typeof r&&r.amd&&r("jsnlog",[],function(){return o}),"function"==typeof __jsnlog_configure&&__jsnlog_configure(o),"undefined"==typeof window||window.onerror||(window.onerror=function(e,t,n,r,i){return o("onerrorLogger").fatalException({msg:"Uncaught Exception",errorMsg:e?e.message||e:"",url:t,"line number":n,column:r},i),!1}),"undefined"==typeof window||window.onunhandledrejection||(window.onunhandledrejection=function(e){o("onerrorLogger").fatalException({msg:"unhandledrejection",errorMsg:e.reason?e.reason.message:e.message||null},e.reason)})},9146:function(e){"use strict";function t(){this._types=Object.create(null),this._extensions=Object.create(null);for(let e=0;e<arguments.length;e++)this.define(arguments[e]);this.define=this.define.bind(this),this.getType=this.getType.bind(this),this.getExtension=this.getExtension.bind(this)}t.prototype.define=function(e,t){for(let n in e){let r=e[n].map(function(e){return e.toLowerCase()});n=n.toLowerCase();for(let e=0;e<r.length;e++){let i=r[e];if("*"!==i[0]){if(!t&&i in this._types)throw Error('Attempt to change mapping for "'+i+'" extension from "'+this._types[i]+'" to "'+n+'". Pass `force=true` to allow this, otherwise remove "'+i+'" from the list of extensions for "'+n+'".');this._types[i]=n}}if(t||!this._extensions[n]){let e=r[0];this._extensions[n]="*"!==e[0]?e:e.substr(1)}}},t.prototype.getType=function(e){let t=(e=String(e)).replace(/^.*[/\\]/,"").toLowerCase(),n=t.replace(/^.*\./,"").toLowerCase(),r=t.length<e.length;return(n.length<t.length-1||!r)&&this._types[n]||null},t.prototype.getExtension=function(e){return(e=/^\s*([^;\s]*)/.test(e)&&RegExp.$1)&&this._extensions[e.toLowerCase()]||null},e.exports=t},2109:function(e,t,n){"use strict";let r=n(9146);e.exports=new r(n(4415))},4415:function(e){e.exports={"application/andrew-inset":["ez"],"application/applixware":["aw"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cu-seeme":["cu"],"application/dash+xml":["mpd"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["es","ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["js","mjs"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4s","m4p"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-signature":["asc","sig"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avif":["avif"],"image/bmp":["bmp"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["markdown","md"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]}},7879:function(e){var t=["stun:","turn:"];e.exports=function(e){var n,r,i=(e||{}).url||e,o={};return("string"==typeof i||i instanceof String)&&(i=i.trim(),n=t[t.indexOf(i.slice(0,5))])?(r=(i=i.slice(5)).split("@"),o.username=e.username,o.credential=e.credential,r.length>1&&(i=r[1],r=r[0].split(":"),o.username=r[0],o.credential=(e||{}).credential||r[1]||""),o.url=n+i,o.urls=[o.url],o):e}},3274:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Connection=void 0;var r=n(7686),i=n(5364),o=n(6056),s=i.OpenViduLogger.getInstance(),a=function(){function e(e,t){this.session=e,this.disposed=!1;var n="'Connection' created ";t.role?(this.localOptions=t,this.connectionId=this.localOptions.id,this.creationTime=this.localOptions.createdAt,this.data=this.localOptions.metadata,this.rpcSessionId=this.localOptions.sessionId,this.role=this.localOptions.role,this.record=this.localOptions.record,n+="(local)"):(this.remoteOptions=t,this.connectionId=this.remoteOptions.id,this.creationTime=this.remoteOptions.createdAt,this.remoteOptions.metadata&&(this.data=this.remoteOptions.metadata),this.remoteOptions.streams&&this.initRemoteStreams(this.remoteOptions.streams),n+="(remote) with 'connectionId' ["+this.remoteOptions.id+"]"),s.info(n)}return e.prototype.sendIceCandidate=function(e){var t=this;this.disposed?s.warn("Connection ".concat(this.connectionId," disposed when trying to send an ICE candidate. ICE candidate not sent")):(s.debug((this.stream.outboundStreamOpts?"Local":"Remote")+"candidate for"+this.connectionId,e),this.session.openvidu.sendRequest("onIceCandidate",{endpointName:this.connectionId,candidate:e.candidate,sdpMid:e.sdpMid,sdpMLineIndex:e.sdpMLineIndex},function(e,n){e&&(s.error("Error sending ICE candidate: "+JSON.stringify(e)),t.session.emitEvent("exception",[new o.ExceptionEvent(t.session,o.ExceptionEventName.ICE_CANDIDATE_ERROR,t.session,"There was an unexpected error on the server-side processing an ICE candidate generated and sent by the client-side",e)]))}))},e.prototype.initRemoteStreams=function(e){var t=this;e.forEach(function(e){var n={id:e.id,createdAt:e.createdAt,connection:t,hasAudio:e.hasAudio,hasVideo:e.hasVideo,audioActive:e.audioActive,videoActive:e.videoActive,typeOfVideo:e.typeOfVideo,frameRate:e.frameRate,videoDimensions:e.videoDimensions?JSON.parse(e.videoDimensions):void 0,filter:e.filter?e.filter:void 0},i=new r.Stream(t.session,n);t.addStream(i)}),s.info("Remote 'Connection' with 'connectionId' ["+this.connectionId+"] is now configured for receiving Streams with options: ",this.stream.inboundStreamOpts)},e.prototype.addStream=function(e){e.connection=this,this.stream=e},e.prototype.removeStream=function(){delete this.stream},e.prototype.dispose=function(){this.disposed=!0,this.removeStream()},e}();t.Connection=a},3013:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventDispatcher=void 0;var r=n(5364),i=n(4795),o=r.OpenViduLogger.getInstance(),s=function(){function e(){this.userHandlerArrowHandler=new WeakMap,this.ee=new i}return e.prototype.onAux=function(e,t,n){var r=function(e){e?o.debug(t,e):o.debug(t),n(e)};return this.userHandlerArrowHandler.set(n,r),this.ee.on(e,r),this},e.prototype.onceAux=function(e,t,n){var r=this,i=function(e){e?o.debug(t,e):o.debug(t),n(e),r.userHandlerArrowHandler.delete(n)};return this.userHandlerArrowHandler.set(n,i),this.ee.once(e,i),this},e.prototype.offAux=function(e,t){if(t){var n=this.userHandlerArrowHandler.get(t);n&&this.ee.off(e,n),this.userHandlerArrowHandler.delete(t)}else this.ee.removeAllListeners(e);return this},e}();t.EventDispatcher=s},6153:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Filter=void 0;var r=n(7614),i=n(7009),o=n(5364).OpenViduLogger.getInstance(),s=function(){function e(e,t){this.handlers=new Map,this.type=e,this.options=t}return e.prototype.execMethod=function(e,t){var n=this;return new Promise(function(s,a){o.info("Executing filter method to stream "+n.stream.streamId);var c,u,d=function(t){o.info("Filter method successfully executed on Stream "+n.stream.streamId);var i=Object.assign({},n.stream.filter);return n.stream.filter.lastExecMethod={method:e,params:u},t&&(n.stream.session.emitEvent("streamPropertyChanged",[new r.StreamPropertyChangedEvent(n.stream.session,n.stream,"filter",n.stream.filter,i,"execFilterMethod")]),n.stream.streamManager.emitEvent("streamPropertyChanged",[new r.StreamPropertyChangedEvent(n.stream.streamManager,n.stream,"filter",n.stream.filter,i,"execFilterMethod")])),s()};if(n.type.startsWith("VB:")){if("string"==typeof t)try{t=JSON.parse(t)}catch(e){return a(new i.OpenViduError(i.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"Wrong params syntax: "+e))}if(u=t,"update"!==e)return a(new i.OpenViduError(i.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,'Unknown Virtual Background method "'.concat(e,'"')));if(!(null===(c=n.stream.virtualBackgroundSinkElements)||void 0===c?void 0:c.VB))return a(new i.OpenViduError(i.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"There is no Virtual Background filter applied"));n.stream.virtualBackgroundSinkElements.VB.updateValues(t).then(function(){return d(!1)}).catch(function(e){return e.name===i.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR?a(new i.OpenViduError(e.name,e.message)):a(new i.OpenViduError(i.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"Error updating values on Virtual Background filter: "+e))})}else{var l=void 0;if("string"!=typeof t)try{l=JSON.stringify(t)}catch(e){var p="'params' property must be a JSON formatted object";return o.error(p),a(p)}else l=t;u=l,n.stream.session.openvidu.sendRequest("execFilterMethod",{streamId:n.stream.streamId,method:e,params:l},function(e,t){return e?(o.error("Error executing filter method for Stream "+n.stream.streamId,e),401===e.code)?a(new i.OpenViduError(i.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to execute a filter method")):a(e):d(!0)})}})},e.prototype.addEventListener=function(e,t){var n=this;return new Promise(function(r,s){o.info("Adding filter event listener to event "+e+" to stream "+n.stream.streamId),n.stream.session.openvidu.sendRequest("addFilterEventListener",{streamId:n.stream.streamId,eventType:e},function(a,c){return a?(o.error("Error adding filter event listener to event "+e+"for Stream "+n.stream.streamId,a),401===a.code)?s(new i.OpenViduError(i.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to add a filter event listener")):s(a):(n.handlers.set(e,t),o.info("Filter event listener to event "+e+" successfully applied on Stream "+n.stream.streamId),r())})})},e.prototype.removeEventListener=function(e){var t=this;return new Promise(function(n,r){o.info("Removing filter event listener to event "+e+" to stream "+t.stream.streamId),t.stream.session.openvidu.sendRequest("removeFilterEventListener",{streamId:t.stream.streamId,eventType:e},function(s,a){return s?(o.error("Error removing filter event listener to event "+e+"for Stream "+t.stream.streamId,s),401===s.code)?r(new i.OpenViduError(i.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to add a filter event listener")):r(s):(t.handlers.delete(e),o.info("Filter event listener to event "+e+" successfully removed on Stream "+t.stream.streamId),n())})})},e}();t.Filter=s},1944:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalRecorder=void 0;var r,i=n(9690),o=n(5364),s=n(5971),a=n(2109),c=o.OpenViduLogger.getInstance(),u=function(){function e(e){this.stream=e,this.chunks=[],r=s.PlatformUtils.getInstance(),this.connectionId=this.stream.connection?this.stream.connection.connectionId:"default-connection",this.id=this.stream.streamId+"_"+this.connectionId+"_localrecord",this.state=i.LocalRecorderState.READY}return e.prototype.record=function(e){var t=this;return new Promise(function(n,r){try{if("string"==typeof e||e instanceof String)return r("When calling LocalRecorder.record(options) parameter 'options' cannot be a string. Must be an object like { mimeType: \"".concat(e,'" }'));if("undefined"==typeof MediaRecorder)throw c.error("MediaRecorder not supported on your device. See compatibility in https://caniuse.com/#search=MediaRecorder"),Error("MediaRecorder not supported on your device. See compatibility in https://caniuse.com/#search=MediaRecorder");if(t.state!==i.LocalRecorderState.READY)throw Error("'LocalRecord.record()' needs 'LocalRecord.state' to be 'READY' (current value: '"+t.state+"'). Call 'LocalRecorder.clean()' or init a new LocalRecorder before");c.log("Starting local recording of stream '"+t.stream.streamId+"' of connection '"+t.connectionId+"'"),e?e.mimeType||(e.mimeType="video/webm"):e={mimeType:"video/webm"},t.mediaRecorder=new MediaRecorder(t.stream.getMediaStream(),e),t.mediaRecorder.start()}catch(e){return r(e)}return t.mediaRecorder.ondataavailable=function(e){e.data.size>0&&t.chunks.push(e.data)},t.mediaRecorder.onerror=function(e){c.error("MediaRecorder error: ",e)},t.mediaRecorder.onstart=function(){c.log("MediaRecorder started (state="+t.mediaRecorder.state+")")},t.mediaRecorder.onstop=function(){t.onStopDefault()},t.mediaRecorder.onpause=function(){c.log("MediaRecorder paused (state="+t.mediaRecorder.state+")")},t.mediaRecorder.onresume=function(){c.log("MediaRecorder resumed (state="+t.mediaRecorder.state+")")},t.state=i.LocalRecorderState.RECORDING,n()})},e.prototype.stop=function(){var e=this;return new Promise(function(t,n){try{if(e.state===i.LocalRecorderState.READY||e.state===i.LocalRecorderState.FINISHED)throw Error("'LocalRecord.stop()' needs 'LocalRecord.state' to be 'RECORDING' or 'PAUSED' (current value: '"+e.state+"'). Call 'LocalRecorder.start()' before");e.mediaRecorder.onstop=function(){return e.onStopDefault(),t()},e.mediaRecorder.stop()}catch(e){return n(e)}})},e.prototype.pause=function(){var e=this;return new Promise(function(t,n){try{if(e.state!==i.LocalRecorderState.RECORDING)return n(Error("'LocalRecord.pause()' needs 'LocalRecord.state' to be 'RECORDING' (current value: '"+e.state+"'). Call 'LocalRecorder.start()' or 'LocalRecorder.resume()' before"));return e.mediaRecorder.pause(),e.state=i.LocalRecorderState.PAUSED,t()}catch(e){return n(e)}})},e.prototype.resume=function(){var e=this;return new Promise(function(t,n){try{if(e.state!==i.LocalRecorderState.PAUSED)throw Error("'LocalRecord.resume()' needs 'LocalRecord.state' to be 'PAUSED' (current value: '"+e.state+"'). Call 'LocalRecorder.pause()' before");return e.mediaRecorder.resume(),e.state=i.LocalRecorderState.RECORDING,t()}catch(e){return n(e)}})},e.prototype.preview=function(e){if(this.state!==i.LocalRecorderState.FINISHED)throw Error("'LocalRecord.preview()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+this.state+"'). Call 'LocalRecorder.stop()' before");if(this.videoPreview=document.createElement("video"),this.videoPreview.id=this.id,this.videoPreview.autoplay=!0,r.isSafariBrowser()&&(this.videoPreview.playsInline=!0),"string"==typeof e){var t=document.getElementById(e);t&&(this.videoPreview=t.appendChild(this.videoPreview))}else this.videoPreview=e.appendChild(this.videoPreview);return this.videoPreview.src=this.videoPreviewSrc,this.videoPreview},e.prototype.clean=function(){var e=this,t=function(){delete e.blob,e.chunks=[],e.state=i.LocalRecorderState.READY};this.state===i.LocalRecorderState.RECORDING||this.state===i.LocalRecorderState.PAUSED?this.stop().then(function(){return t()}).catch(function(){return t()}):t()},e.prototype.download=function(){if(this.state!==i.LocalRecorderState.FINISHED)throw Error("'LocalRecord.download()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+this.state+"'). Call 'LocalRecorder.stop()' before");var e=document.createElement("a");e.style.display="none",document.body.appendChild(e);var t=globalThis.URL.createObjectURL(this.blob);e.href=t,e.download=this.id+"."+a.getExtension(this.blob.type),e.click(),globalThis.URL.revokeObjectURL(t),document.body.removeChild(e)},e.prototype.getBlob=function(){if(this.state===i.LocalRecorderState.FINISHED)return this.blob;throw Error("Call 'LocalRecord.stop()' before getting Blob file")},e.prototype.uploadAsBinary=function(e,t){var n=this;return new Promise(function(r,o){if(n.state!==i.LocalRecorderState.FINISHED)return o(Error("'LocalRecord.uploadAsBinary()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+n.state+"'). Call 'LocalRecorder.stop()' before"));var s=new XMLHttpRequest;if(s.open("POST",e,!0),"object"==typeof t)for(var a=0,c=Object.keys(t);a<c.length;a++){var u=c[a];s.setRequestHeader(u,t[u])}s.onreadystatechange=function(){if(4===s.readyState)return"2"===s.status.toString().charAt(0)?r(s.responseText):o(s.status)},s.send(n.blob)})},e.prototype.uploadAsMultipartfile=function(e,t){var n=this;return new Promise(function(r,o){if(n.state!==i.LocalRecorderState.FINISHED)return o(Error("'LocalRecord.uploadAsMultipartfile()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+n.state+"'). Call 'LocalRecorder.stop()' before"));var s=new XMLHttpRequest;if(s.open("POST",e,!0),"object"==typeof t)for(var c=0,u=Object.keys(t);c<u.length;c++){var d=u[c];s.setRequestHeader(d,t[d])}var l=new FormData;l.append("file",n.blob,n.id+"."+a.getExtension(n.blob.type)),s.onreadystatechange=function(){if(4===s.readyState)return"2"===s.status.toString().charAt(0)?r(s.responseText):o(s.status)},s.send(l)})},e.prototype.onStopDefault=function(){c.log("MediaRecorder stopped  (state="+this.mediaRecorder.state+")"),this.blob=new Blob(this.chunks,{type:this.mediaRecorder.mimeType}),this.chunks=[],this.videoPreviewSrc=globalThis.URL.createObjectURL(this.blob),this.state=i.LocalRecorderState.FINISHED},e}();t.LocalRecorder=u},4527:function(e,t,n){"use strict";var r,i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.OpenVidu=void 0;var s=n(1944),a=n(2917),c=n(7678),u=n(3439),d=n(7614),l=n(7009),p=n(4270),h=n(5364),f=n(5971),m=n(3061),v=n(9544),g=n(327),b=n(4795),E=n(4834),y=n(5549),S=h.OpenViduLogger.getInstance(),w=function(){function e(){var e=this;this.masterNodeHasCrashed=!1,this.publishers=[],this.secret="",this.recorder=!1,this.stt=!1,this.life=-1,this.advancedConfiguration={},this.webrtcStatsInterval=-1,this.sendBrowserLogs=g.OpenViduLoggerConfiguration.disabled,this.isAtLeastPro=!1,this.isEnterprise=!1,this.ee=new b,r=f.PlatformUtils.getInstance(),this.libraryVersion=y.version,S.info("OpenVidu initialized"),S.info("Platform detected: "+r.getDescription()),S.info("openvidu-browser version: "+this.libraryVersion),(r.isMobileDevice()||r.isReactNative())&&this.onOrientationChanged(function(){e.publishers.forEach(function(t){t.stream.isLocalStreamPublished&&t.stream&&t.stream.hasVideo&&e.sendNewVideoDimensionsIfRequired(t,"deviceRotated",75,10)})})}return e.prototype.initSession=function(){return this.session=new c.Session(this),this.session},e.prototype.initPublisher=function(e,t,n){r=t&&"function"!=typeof t?{audioSource:void 0!==(r=t).audioSource?r.audioSource:void 0,frameRate:"undefined"!=typeof MediaStreamTrack&&r.videoSource instanceof MediaStreamTrack?void 0:void 0!==r.frameRate?r.frameRate:void 0,insertMode:void 0!==r.insertMode?"string"==typeof r.insertMode?p.VideoInsertMode[r.insertMode]:r.insertMode:p.VideoInsertMode.APPEND,mirror:void 0===r.mirror||r.mirror,publishAudio:void 0===r.publishAudio||r.publishAudio,publishVideo:void 0===r.publishVideo||r.publishVideo,resolution:"undefined"!=typeof MediaStreamTrack&&r.videoSource instanceof MediaStreamTrack?void 0:void 0!==r.resolution?r.resolution:"640x480",videoSource:void 0!==r.videoSource?r.videoSource:void 0,videoSimulcast:r.videoSimulcast,filter:r.filter}:{insertMode:p.VideoInsertMode.APPEND,mirror:!0,publishAudio:!0,publishVideo:!0,resolution:"640x480"};var r,i,o=new a.Publisher(e,r,this);return t&&"function"==typeof t?i=t:n&&(i=n),o.initialize().then(function(){void 0!==i&&i(void 0),o.emitEvent("accessAllowed",[])}).catch(function(e){void 0!==i&&i(e),o.emitEvent("accessDenied",[e])}),this.publishers.push(o),o},e.prototype.initPublisherAsync=function(e,t){var n=this;return new Promise(function(r,i){var o,s=function(e){return e?i(e):r(o)};o=t?n.initPublisher(e,t,s):n.initPublisher(e,s)})},e.prototype.initLocalRecorder=function(e){return new s.LocalRecorder(e)},e.prototype.checkSystemRequirements=function(){return r.isIPhoneOrIPad()?r.isIOSWithSafari()||r.isChromeMobileBrowser()||r.isFirefoxMobileBrowser()||r.isOperaMobileBrowser()||r.isEdgeMobileBrowser()||r.isIonicIos():r.isChromeBrowser()||r.isChromeMobileBrowser()||r.isFirefoxBrowser()||r.isFirefoxMobileBrowser()||r.isOperaBrowser()||r.isOperaMobileBrowser()||r.isEdgeBrowser()||r.isEdgeMobileBrowser()||r.isSamsungBrowser()||r.isSafariBrowser()||r.isAndroidBrowser()||r.isElectron()||r.isNodeJs()||r.isMotorolaEdgeDevice()},e.prototype.checkScreenSharingCapabilities=function(){return r.canScreenShare()},e.prototype.getDevices=function(){return new Promise(function(e,t){navigator.mediaDevices.enumerateDevices().then(function(t){var n,i=[];if(!r.isIonicAndroid()||"undefined"==typeof cordova||null===(n=null==cordova?void 0:cordova.plugins)||void 0===n||!n.EnumerateDevicesPlugin)return t.forEach(function(e){("audioinput"===e.kind||"videoinput"===e.kind)&&i.push({kind:e.kind,deviceId:e.deviceId,label:e.label})}),e(i);cordova.plugins.EnumerateDevicesPlugin.getEnumerateDevices().then(function(n){var r=[],o=[],s=[];return r=n.filter(function(e){return"audioinput"===e.kind}),o=t.filter(function(e){return"videoinput"===e.kind}),s=t.filter(function(e){return"audioinput"===e.kind}),o.forEach(function(e,t){if(e.label)i.push({kind:e.kind,deviceId:e.deviceId,label:e.label});else{var n="";n=0===t?"Front Camera":1===t?"Back Camera":"Unknown Camera",i.push({kind:e.kind,deviceId:e.deviceId,label:n})}}),s.forEach(function(e,t){if(e.label)i.push({kind:e.kind,deviceId:e.deviceId,label:e.label});else{var n="";switch(t){case 0:n="Default";break;case 1:var o=r.filter(function(e){return e.label.includes("Built")})[0];n=o?o.label:"Built-in Microphone";break;case 2:var s=r.filter(function(e){return e.label.includes("Wired")})[0];n=s?s.label:"Headset earpiece";break;case 3:var a=r.filter(function(e){return e.label.includes("Bluetooth")})[0];n=a?a.label:"Wireless";break;default:n="Unknown Microphone"}i.push({kind:e.kind,deviceId:e.deviceId,label:n})}}),e(i)})}).catch(function(e){return S.error("Error getting devices",e),t(e)})})},e.prototype.getUserMedia=function(e){var t,n;return i(this,void 0,void 0,function(){var s,a,c,u,d,p,h,f,m,v=this;return o(this,function(g){switch(g.label){case 0:s=function(e,t){return i(v,void 0,void 0,function(){var n,r,i;return o(this,function(o){switch(o.label){case 0:n={audio:void 0===t.audio||t.audio,video:!1},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,navigator.mediaDevices.getUserMedia(n)];case 2:return r=o.sent(),e.addTrack(r.getAudioTracks()[0]),[2,e];case 3:throw i=o.sent(),e.getAudioTracks().forEach(function(e){e.stop()}),e.getVideoTracks().forEach(function(e){e.stop()}),this.generateAudioDeviceError(i,n);case 4:return[2]}})})},g.label=1;case 1:return g.trys.push([1,20,,21]),[4,this.generateMediaConstraints(e)];case 2:if(!((a=g.sent()).videoTrack&&a.audioTrack||a.audioTrack&&(null===(t=a.constraints)||void 0===t?void 0:t.video)===!1||a.videoTrack&&(null===(n=a.constraints)||void 0===n?void 0:n.audio)===!1))return[3,3];return[2,this.addAlreadyProvidedTracks(a,new MediaStream)];case 3:if(a.videoTrack&&delete a.constraints.video,a.audioTrack&&delete a.constraints.audio,c=!1,"string"!=typeof e.videoSource||!("screen"===e.videoSource||"window"===e.videoSource||r.isElectron()&&e.videoSource.startsWith("screen:")))return[3,12];if(c=!a.audioTrack&&null!==e.audioSource&&!1!==e.audioSource,!(navigator.mediaDevices.getDisplayMedia&&!r.isElectron()))return[3,11];g.label=4;case 4:return g.trys.push([4,9,,10]),[4,navigator.mediaDevices.getDisplayMedia({video:!0})];case 5:if(u=g.sent(),this.addAlreadyProvidedTracks(a,u),!c)return[3,7];return[4,s(u,a.constraints)];case 6:return[2,g.sent()];case 7:return[2,u];case 8:return[3,10];case 9:throw d=g.sent(),p=l.OpenViduErrorName.SCREEN_CAPTURE_DENIED,h=d.toString(),new l.OpenViduError(p,h);case 10:return[3,11];case 11:return[3,12];case 12:f=c?{video:a.constraints.video}:a.constraints,g.label=13;case 13:return g.trys.push([13,18,,19]),[4,navigator.mediaDevices.getUserMedia(f)];case 14:if(u=g.sent(),this.addAlreadyProvidedTracks(a,u),!c)return[3,16];return[4,s(u,a.constraints)];case 15:return[2,g.sent()];case 16:return[2,u];case 17:return[3,19];case 18:throw m=g.sent(),p=void 0,h=m.toString(),p="screen"!==e.videoSource?l.OpenViduErrorName.DEVICE_ACCESS_DENIED:l.OpenViduErrorName.SCREEN_CAPTURE_DENIED,new l.OpenViduError(p,h);case 19:return[3,21];case 20:throw g.sent();case 21:return[2]}})})},e.prototype.enableProdMode=function(){S.enableProdMode()},e.prototype.setAdvancedConfiguration=function(e){this.advancedConfiguration=e},e.prototype.onOrientationChanged=function(e){globalThis.addEventListener("orientationchange",e)},e.prototype.sendNewVideoDimensionsIfRequired=function(e,t,n,r){var i,o,s,a,c=this,u=0,d=(null===(o=null===(i=null==e?void 0:e.stream)||void 0===i?void 0:i.videoDimensions)||void 0===o?void 0:o.width)||0,l=(null===(a=null===(s=null==e?void 0:e.stream)||void 0===s?void 0:s.videoDimensions)||void 0===a?void 0:a.height)||0,p=setInterval(function(){++u>r&&clearTimeout(p),e.getVideoDimensions().then(function(n){(n.width!==d||n.height!==l)&&(clearTimeout(p),c.sendVideoDimensionsChangedEvent(e,t,d,l,n.width,n.height))})},n)},e.prototype.sendVideoDimensionsChangedEvent=function(e,t,n,r,i,o){var s=this;e.stream.videoDimensions={width:i||0,height:o||0},this.sendRequest("streamPropertyChanged",{streamId:e.stream.streamId,property:"videoDimensions",newValue:JSON.stringify(e.stream.videoDimensions),reason:t},function(i,o){i?S.error("Error sending 'streamPropertyChanged' event",i):(s.session.emitEvent("streamPropertyChanged",[new d.StreamPropertyChangedEvent(s.session,e.stream,"videoDimensions",e.stream.videoDimensions,{width:n,height:r},t)]),e.emitEvent("streamPropertyChanged",[new d.StreamPropertyChangedEvent(e,e.stream,"videoDimensions",e.stream.videoDimensions,{width:n,height:r},t)]),s.session.sendVideoData(e))})},e.prototype.sendTrackChangedEvent=function(e,t,n,r){var i=this,o={label:t},s={label:n},a="trackReplaced";e.stream.isLocalStreamPublished?this.sendRequest("streamPropertyChanged",{streamId:e.stream.streamId,property:r,newValue:s,reason:a},function(t,n){t?S.error("Error sending 'streamPropertyChanged' event",t):(i.session.emitEvent("streamPropertyChanged",[new d.StreamPropertyChangedEvent(i.session,e.stream,r,s,o,a)]),e.emitEvent("streamPropertyChanged",[new d.StreamPropertyChangedEvent(e,e.stream,r,s,o,a)]))}):(this.session.emitEvent("streamPropertyChanged",[new d.StreamPropertyChangedEvent(this.session,e.stream,r,s,o,a)]),e.emitEvent("streamPropertyChanged",[new d.StreamPropertyChangedEvent(e,e.stream,r,s,o,a)]))},e.prototype.generateMediaConstraints=function(e){var t=this;return new Promise(function(n,r){var i={audioTrack:void 0,videoTrack:void 0,constraints:{audio:void 0,video:void 0}},o=e.audioSource,s=e.videoSource;if((null===o||!1===o)&&(i.constraints.audio=!1),(null===s||!1===s)&&(i.constraints.video=!1),!1===i.constraints.audio&&!1===i.constraints.video)return r(new l.OpenViduError(l.OpenViduErrorName.NO_INPUT_SOURCE_SET,"Properties 'audioSource' and 'videoSource' cannot be set to false or null at the same time"));if("undefined"!=typeof MediaStreamTrack&&o instanceof MediaStreamTrack&&(i.audioTrack=o),"undefined"!=typeof MediaStreamTrack&&s instanceof MediaStreamTrack&&(i.videoTrack=s),void 0===o&&(i.constraints.audio=!0),void 0===s&&(i.constraints.video={width:{ideal:640},height:{ideal:480}}),null!==s&&!1!==s){if(e.resolution){var a=e.resolution.toLowerCase().split("x"),c=Number(a[0]),u=Number(a[1]);i.constraints.video={width:{ideal:c},height:{ideal:u}}}e.frameRate&&(i.constraints.video.frameRate={ideal:e.frameRate})}return t.configureDeviceIdOrScreensharing(i,e,n,r),n(i)})},e.prototype.startWs=function(e){var t={heartbeat:5e3,ws:{uri:this.wsUri+"?sessionId="+this.session.sessionId,onconnected:e,ondisconnect:this.disconnectCallback.bind(this),onreconnecting:this.reconnectingCallback.bind(this),onreconnected:this.reconnectedCallback.bind(this),ismasternodecrashed:this.isMasterNodeCrashed.bind(this)},rpc:{requestTimeout:1e4,heartbeatRequestTimeout:5e3,participantJoined:this.session.onParticipantJoined.bind(this.session),participantPublished:this.session.onParticipantPublished.bind(this.session),participantUnpublished:this.session.onParticipantUnpublished.bind(this.session),participantLeft:this.session.onParticipantLeft.bind(this.session),participantEvicted:this.session.onParticipantEvicted.bind(this.session),recordingStarted:this.session.onRecordingStarted.bind(this.session),recordingStopped:this.session.onRecordingStopped.bind(this.session),broadcastStarted:this.session.onBroadcastStarted.bind(this.session),broadcastStopped:this.session.onBroadcastStopped.bind(this.session),sendMessage:this.session.onNewMessage.bind(this.session),streamPropertyChanged:this.session.onStreamPropertyChanged.bind(this.session),connectionPropertyChanged:this.session.onConnectionPropertyChanged.bind(this.session),networkQualityLevelChanged:this.session.onNetworkQualityLevelChangedChanged.bind(this.session),filterEventDispatched:this.session.onFilterEventDispatched.bind(this.session),iceCandidate:this.session.recvIceCandidate.bind(this.session),mediaError:this.session.onMediaError.bind(this.session),masterNodeCrashedNotification:this.onMasterNodeCrashedNotification.bind(this),forciblyReconnectSubscriber:this.session.onForciblyReconnectSubscriber.bind(this.session),speechToTextMessage:this.session.onSpeechToTextMessage.bind(this.session),speechToTextDisconnected:this.session.onSpeechToTextDisconnected.bind(this.session)}};this.jsonRpcClient=new E.clients.JsonRpcClient(t)},e.prototype.onMasterNodeCrashedNotification=function(e){console.error("Master Node has crashed"),this.masterNodeHasCrashed=!0,this.session.onLostConnection("nodeCrashed"),this.jsonRpcClient.close(4103,"Master Node has crashed")},e.prototype.getWsReadyState=function(){return this.jsonRpcClient.getReadyState()},e.prototype.closeWs=function(){this.jsonRpcClient.close(4102,"Connection closed by client")},e.prototype.sendRequest=function(e,t,n){var r;t&&t instanceof Function&&(n=t,t={}),S.debug('Sending request: {method:"'+e+'", params: '+JSON.stringify(t)+"}"),null===(r=this.jsonRpcClient)||void 0===r||r.send(e,t,n)},e.prototype.getWsUri=function(){return this.wsUri},e.prototype.getSecret=function(){return this.secret},e.prototype.getRecorder=function(){return this.recorder},e.prototype.getStt=function(){return this.stt},e.prototype.generateAudioDeviceError=function(e,t){var n,r;switch("Error"===e.name&&(e.name=e.constructor.name),e.name.toLowerCase()){case"notfounderror":return n=l.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,r=e.toString(),new l.OpenViduError(n,r);case"notallowederror":return n=l.OpenViduErrorName.DEVICE_ACCESS_DENIED,r=e.toString(),new l.OpenViduError(n,r);case"overconstrainederror":return"deviceid"===e.constraint.toLowerCase()?(n=l.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,r="Audio input device with deviceId '"+t.audio.deviceId.exact+"' not found"):(n=l.OpenViduErrorName.PUBLISHER_PROPERTIES_ERROR,r="Audio input device doesn't support the value passed for constraint '"+e.constraint+"'"),new l.OpenViduError(n,r);case"notreadableerror":return n=l.OpenViduErrorName.DEVICE_ALREADY_IN_USE,r=e.toString(),new l.OpenViduError(n,r);default:return new l.OpenViduError(l.OpenViduErrorName.INPUT_AUDIO_DEVICE_GENERIC_ERROR,e.toString())}},e.prototype.addAlreadyProvidedTracks=function(e,t,n){return e.videoTrack&&(t.addTrack(e.videoTrack),n&&(e.constraints.video?n.lastVideoTrackConstraints=e.constraints.video:n.lastVideoTrackConstraints=e.videoTrack.getConstraints())),e.audioTrack&&t.addTrack(e.audioTrack),t},e.prototype.configureDeviceIdOrScreensharing=function(e,t,n,i){var o=this,s=t.audioSource,a=t.videoSource;if("string"==typeof s&&(e.constraints.audio={deviceId:{exact:s}}),"string"==typeof a){if(this.isScreenShare(a)){if(this.checkScreenSharingCapabilities()){if(r.isElectron()){var c="screen:",u=a.substr(a.indexOf(c)+c.length);return e.constraints.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:u}},n(e)}if(!this.advancedConfiguration.screenShareChromeExtension||r.isFirefoxBrowser()||r.isFirefoxMobileBrowser()||navigator.mediaDevices.getDisplayMedia){if(navigator.mediaDevices.getDisplayMedia)return n(e);var d=r.isFirefoxBrowser()||r.isFirefoxMobileBrowser()?t.videoSource:void 0;return void m.getScreenId(d,function(t,r,s){if(!t)return e.constraints.video=s.video,n(e);if("not-installed"===t){var a=o.advancedConfiguration.screenShareChromeExtension?o.advancedConfiguration.screenShareChromeExtension:"https://chrome.google.com/webstore/detail/openvidu-screensharing/lfcgfepafnobdloecchnfaclibenjold",c=new l.OpenViduError(l.OpenViduErrorName.SCREEN_EXTENSION_NOT_INSTALLED,a);return S.error(c),i(c)}if("installed-disabled"===t){var c=new l.OpenViduError(l.OpenViduErrorName.SCREEN_EXTENSION_DISABLED,"You must enable the screen extension");return S.error(c),i(c)}if("permission-denied"===t){var c=new l.OpenViduError(l.OpenViduErrorName.SCREEN_CAPTURE_DENIED,"You must allow access to one window of your desktop");return S.error(c),i(c)}var c=new l.OpenViduError(l.OpenViduErrorName.GENERIC_ERROR,"Unknown error when accessing screen share");return S.error(c),S.error(t),i(c)})}return void v.getScreenConstraints(function(t,r){if(!t&&(!r.mandatory||"screen"!==r.mandatory.chromeMediaSource))return e.constraints.video=r,n(e);if("permission-denied"===t||"PermissionDeniedError"===t){var s=new l.OpenViduError(l.OpenViduErrorName.SCREEN_CAPTURE_DENIED,"You must allow access to one window of your desktop");return S.error(s),i(s)}var a=o.advancedConfiguration.screenShareChromeExtension.split("/").pop().trim();v.getChromeExtensionStatus(a,function(e){if("installed-disabled"===e){var t=new l.OpenViduError(l.OpenViduErrorName.SCREEN_EXTENSION_DISABLED,"You must enable the screen extension");return S.error(t),i(t)}if("not-installed"===e){var n=new l.OpenViduError(l.OpenViduErrorName.SCREEN_EXTENSION_NOT_INSTALLED,o.advancedConfiguration.screenShareChromeExtension);return S.error(n),i(n)}})})}var p=new l.OpenViduError(l.OpenViduErrorName.SCREEN_SHARING_NOT_SUPPORTED,"You can only screen share in desktop Chrome, Firefox, Opera, Safari (>=13.0), Edge (>= 80) or Electron. Detected client: "+r.getName()+" "+r.getVersion());return S.error(p),i(p)}this.setVideoSource(e,a)}},e.prototype.setVideoSource=function(e,t){e.constraints.video||(e.constraints.video={}),e.constraints.video.deviceId={exact:t}},e.prototype.disconnectCallback=function(){S.warn("Websocket connection lost"),this.isRoomAvailable()?this.session.onLostConnection("networkDisconnect"):alert("Connection error. Please reload page.")},e.prototype.reconnectingCallback=function(){S.warn("Websocket connection lost (reconnecting)"),this.isRoomAvailable()?this.session.emitEvent("reconnecting",[]):alert("Connection error. Please reload page.")},e.prototype.reconnectWebsocketThroughRpcConnectMethod=function(e){var t=this;this.sendRequest("connect",{sessionId:e,reconnect:!0},function(e,n){if(e){if(t.isMasterNodeCrashed())S.warn("Master Node has crashed!");else{S.error(e);var r=function(e,n){S.warn(n),t.session.onLostConnection(e),t.jsonRpcClient.close(4101,"Reconnection fault: "+n)};40007===e.code&&"reconnection error"===e.message&&console.error("Invalid RPC sessionId. Client network disconnection or Master Node crash"),-1===t.life?r("networkDisconnect","WS successfully reconnected but the user was already evicted due to timeout"):t.sendRequest("sessionStatus",{sessionId:t.session.sessionId},function(e,n){null!=e?console.error("Error checking session status",e):t.life===n.life?r("networkDisconnect","WS successfully reconnected but the user was already evicted due to timeout"):r("nodeCrashed","WS successfully reconnected to OpenVidu Server but your Master Node crashed")})}}else t.jsonRpcClient.resetPing(),t.session.onRecoveredConnection()})},e.prototype.reconnectedCallback=function(){if(S.warn("Websocket reconnected"),this.isRoomAvailable()){if(this.session.connection)this.reconnectWebsocketThroughRpcConnectMethod(this.session.connection.rpcSessionId);else{S.warn("There was no previous connection when running reconnection callback");var e=new u.SessionDisconnectedEvent(this.session,"networkDisconnect");this.session.ee.emitEvent("sessionDisconnected",[e]),e.callDefaultBehavior()}}else alert("Connection error. Please reload page.")},e.prototype.isMasterNodeCrashed=function(){return this.masterNodeHasCrashed},e.prototype.isRoomAvailable=function(){return void 0!==this.session&&this.session instanceof c.Session||(S.warn("Session instance not found"),!1)},e.prototype.isScreenShare=function(e){return"screen"===e||"window"===e||r.isElectron()&&e.startsWith("screen:")},e}();t.OpenVidu=w},2917:function(e,t,n){"use strict";var r,i,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Publisher=void 0;var c=n(7678),u=n(7686),d=n(2028),l=n(3590),p=n(7614),h=n(7009),f=n(5364),m=n(5971),v=n(1513),g=f.OpenViduLogger.getInstance(),b=function(e){function t(t,n,r){var o=e.call(this,new u.Stream(r.session?r.session:new c.Session(r),{publisherProperties:n,mediaConstraints:{}}),t)||this;return o.accessAllowed=!1,o.isSubscribedToRemote=!1,o.accessDenied=!1,i=m.PlatformUtils.getInstance(),o.properties=n,o.openvidu=r,o.stream.ee.on("local-stream-destroyed",function(e){o.stream.isLocalStreamPublished=!1;var t=new l.StreamEvent(!0,o,"streamDestroyed",o.stream,e);o.emitEvent("streamDestroyed",[t]),t.callDefaultBehavior()}),o}return o(t,e),t.prototype.publishAudio=function(e){var t=this;this.stream.audioActive!==e&&((this.stream.displayMyRemote()?this.stream.localMediaStreamWhenSubscribedToRemote:this.stream.getMediaStream()).getAudioTracks().forEach(function(t){t.enabled=e}),this.session&&this.stream.streamId&&this.session.openvidu.sendRequest("streamPropertyChanged",{streamId:this.stream.streamId,property:"audioActive",newValue:e,reason:"publishAudio"},function(n,r){n?g.error("Error sending 'streamPropertyChanged' event",n):(t.session.emitEvent("streamPropertyChanged",[new p.StreamPropertyChangedEvent(t.session,t.stream,"audioActive",e,!e,"publishAudio")]),t.emitEvent("streamPropertyChanged",[new p.StreamPropertyChangedEvent(t,t.stream,"audioActive",e,!e,"publishAudio")]),t.session.sendVideoData(t.stream.streamManager))}),this.stream.audioActive=e,g.info("'Publisher' has "+(e?"published":"unpublished")+" its audio stream"))},t.prototype.publishVideo=function(e,t){var n=this;return new Promise(function(r,i){return s(n,void 0,void 0,function(){var n,o,c,u,d=this;return a(this,function(l){switch(l.label){case 0:if(!(this.stream.videoActive!==e))return[3,9];if(n=this.stream.displayMyRemote()?this.stream.localMediaStreamWhenSubscribedToRemote:this.stream.getMediaStream(),o=!1,n.getVideoTracks().forEach(function(n){n.enabled=e,e||!0!==t?e&&"ended"===n.readyState&&(o=!0):n.stop()}),!(!e&&!0===t&&this.stream.filter&&this.stream.filter.type.startsWith("VB:")))return[3,2];return this.stream.lastVBFilter=this.stream.filter,[4,this.stream.removeFilterAux(!0)];case 1:l.sent(),l.label=2;case 2:if(!o)return[3,8];if(c=n.getVideoTracks()[0],n.removeTrack(c),u=function(e){return s(d,void 0,void 0,function(){var t=this;return a(this,function(r){switch(r.label){case 0:if(n.addTrack(e),!this.stream.isLocalStreamPublished)return[3,2];return[4,this.replaceTrackInRtcRtpSender(e)];case 1:r.sent(),r.label=2;case 2:return this.stream.lastVBFilter&&setTimeout(function(){return s(t,void 0,void 0,function(){var e,t;return a(this,function(n){switch(n.label){case 0:return e=this.stream.lastVBFilter.options,(t=this.stream.lastVBFilter.lastExecMethod)&&"update"===t.method&&(e=Object.assign({},e,t.params)),[4,this.stream.applyFilter(this.stream.lastVBFilter.type,e)];case 1:return n.sent(),delete this.stream.lastVBFilter,[2]}})})},1),[2]}})})},!(t&&t instanceof MediaStreamTrack))return[3,4];return[4,u(t)];case 3:case 6:return l.sent(),[3,8];case 4:return l.trys.push([4,7,,8]),[4,navigator.mediaDevices.getUserMedia({audio:!1,video:this.stream.lastVideoTrackConstraints})];case 5:return[4,u(l.sent().getVideoTracks()[0])];case 7:return[2,i(l.sent())];case 8:return this.session&&this.stream.streamId&&this.session.openvidu.sendRequest("streamPropertyChanged",{streamId:this.stream.streamId,property:"videoActive",newValue:e,reason:"publishVideo"},function(t,n){t?g.error("Error sending 'streamPropertyChanged' event",t):(d.session.emitEvent("streamPropertyChanged",[new p.StreamPropertyChangedEvent(d.session,d.stream,"videoActive",e,!e,"publishVideo")]),d.emitEvent("streamPropertyChanged",[new p.StreamPropertyChangedEvent(d,d.stream,"videoActive",e,!e,"publishVideo")]),d.session.sendVideoData(d.stream.streamManager))}),this.stream.videoActive=e,g.info("'Publisher' has "+(e?"published":"unpublished")+" its video stream"),[2,r()];case 9:return[2]}})})})},t.prototype.subscribeToRemote=function(e){e=void 0===e||e,this.isSubscribedToRemote=e,this.stream.subscribeToMyRemote(e)},t.prototype.on=function(t,n){var r=this;return e.prototype.on.call(this,t,n),"streamCreated"===t&&(this.stream&&this.stream.isLocalStreamPublished?this.emitEvent("streamCreated",[new l.StreamEvent(!1,this,"streamCreated",this.stream,"")]):this.stream.ee.on("stream-created-by-publisher",function(){r.emitEvent("streamCreated",[new l.StreamEvent(!1,r,"streamCreated",r.stream,"")])})),"accessAllowed"===t&&this.accessAllowed&&this.emitEvent("accessAllowed",[]),"accessDenied"===t&&this.accessDenied&&this.emitEvent("accessDenied",[]),this},t.prototype.once=function(t,n){var r=this;return e.prototype.once.call(this,t,n),"streamCreated"===t&&(this.stream&&this.stream.isLocalStreamPublished?this.emitEvent("streamCreated",[new l.StreamEvent(!1,this,"streamCreated",this.stream,"")]):this.stream.ee.once("stream-created-by-publisher",function(){r.emitEvent("streamCreated",[new l.StreamEvent(!1,r,"streamCreated",r.stream,"")])})),"accessAllowed"===t&&this.accessAllowed&&this.emitEvent("accessAllowed",[]),"accessDenied"===t&&this.accessDenied&&this.emitEvent("accessDenied",[]),this},t.prototype.off=function(t,n){return e.prototype.off.call(this,t,n),this},t.prototype.replaceTrack=function(e){return s(this,void 0,void 0,function(){return a(this,function(t){return[2,this.replaceTrackAux(e,!0)]})})},t.prototype.initialize=function(){var e=this;return new Promise(function(t,n){return s(e,void 0,void 0,function(){var e,r,o,c,u,d,l,p,f,m,b,E,y,S,w=this;return a(this,function(O){switch(O.label){case 0:e={},r={},o=2e3,u=function(e){return w.accessDenied=!0,w.accessAllowed=!1,g.error("Publisher initialization failed. ".concat(e.name,": ").concat(e.message)),n(e)},d=function(e){var n,r;if(w.accessAllowed=!0,w.accessDenied=!1,"undefined"!=typeof MediaStreamTrack&&w.properties.audioSource instanceof MediaStreamTrack&&(e.removeTrack(e.getAudioTracks()[0]),e.addTrack(w.properties.audioSource)),"undefined"!=typeof MediaStreamTrack&&w.properties.videoSource instanceof MediaStreamTrack&&(e.removeTrack(e.getVideoTracks()[0]),e.addTrack(w.properties.videoSource)),e.getAudioTracks()[0]){var i=void 0!==w.stream.audioActive&&null!==w.stream.audioActive?w.stream.audioActive:!!w.stream.outboundStreamOpts.publisherProperties.publishAudio;e.getAudioTracks()[0].enabled=i}if(e.getVideoTracks()[0]){var i=void 0!==w.stream.videoActive&&null!==w.stream.videoActive?w.stream.videoActive:!!w.stream.outboundStreamOpts.publisherProperties.publishVideo;e.getVideoTracks()[0].enabled=i}for(var o=0,s=e.getAudioTracks();o<s.length;o++){var a=s[o];(null===(n=a.contentHint)||void 0===n?void 0:n.length)||(a.contentHint="",g.info("Audio track Content Hint set: '".concat(a.contentHint,"'")))}for(var c=0,u=e.getVideoTracks();c<u.length;c++){var a=u[c];if(!(null===(r=a.contentHint)||void 0===r?void 0:r.length)){switch(w.stream.typeOfVideo){case v.TypeOfVideo.SCREEN:a.contentHint="detail";break;case v.TypeOfVideo.CUSTOM:g.warn("CUSTOM type video track was provided without Content Hint!"),a.contentHint="motion";break;case v.TypeOfVideo.CAMERA:case v.TypeOfVideo.IPCAM:default:a.contentHint="motion"}g.info("Video track Content Hint set: '".concat(a.contentHint,"'"))}}return w.initializeVideoReference(e),w.stream.displayMyRemote()||w.stream.updateMediaStreamInVideos(),delete w.firstVideoElement,w.stream.isSendVideo()?w.getVideoDimensions().then(function(t){w.stream.videoDimensions={width:t.width,height:t.height},w.stream.isSendScreen()&&(w.screenShareResizeInterval=setInterval(function(){var t=e.getVideoTracks()[0].getSettings(),n=t.width,r=t.height,i=null!=n&&n!==w.stream.videoDimensions.width,o=null!=r&&r!==w.stream.videoDimensions.height;w.stream.isLocalStreamPublished&&(i||o)&&w.openvidu.sendVideoDimensionsChangedEvent(w,"screenResized",w.stream.videoDimensions.width,w.stream.videoDimensions.height,n||0,r||0)},650)),w.stream.isLocalStreamReadyToPublish=!0,w.stream.ee.emitEvent("stream-ready-to-publish",[])}):(w.stream.isLocalStreamReadyToPublish=!0,w.stream.ee.emitEvent("stream-ready-to-publish",[])),t()},l=function(t,n){return s(w,void 0,void 0,function(){var i,s;return a(this,function(a){switch(a.label){case 0:if(this.clearPermissionDialogTimer(c,o),!(this.stream.isSendScreen()&&this.stream.isSendAudio()))return[3,5];r.audio=n,r.video=!1,c=Date.now(),this.setPermissionDialogTimer(o),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,navigator.mediaDevices.getUserMedia(r)];case 2:return i=a.sent(),this.clearPermissionDialogTimer(c,o),t.addTrack(i.getAudioTracks()[0]),d(t),[3,4];case 3:return s=a.sent(),this.clearPermissionDialogTimer(c,o),t.getAudioTracks().forEach(function(e){e.stop()}),t.getVideoTracks().forEach(function(e){e.stop()}),u(this.openvidu.generateAudioDeviceError(s,e)),[2];case 4:return[3,6];case 5:d(t),a.label=6;case 6:return[2]}})})},p=function(t){return s(w,void 0,void 0,function(){var n,r,i,s;return a(this,function(a){switch(a.label){case 0:switch(g.error("getMediaError: ".concat(t.toString())),this.clearPermissionDialogTimer(c,o),"Error"===t.name&&(t.name=t.constructor.name),t.name.toLowerCase()){case"notfounderror":return[3,1];case"notallowederror":return[3,5];case"overconstrainederror":return[3,6];case"aborterror":case"notreadableerror":return[3,10]}return[3,11];case 1:return a.trys.push([1,3,,4]),[4,navigator.mediaDevices.getUserMedia({audio:!1,video:e.video})];case 2:return a.sent().getVideoTracks().forEach(function(e){e.stop()}),n=h.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,r=t.toString(),u(new h.OpenViduError(n,r)),[3,4];case 3:return i=a.sent(),n=h.OpenViduErrorName.INPUT_VIDEO_DEVICE_NOT_FOUND,r=i.toString(),u(new h.OpenViduError(n,r)),[3,4];case 4:case 9:return[3,12];case 5:return n=this.stream.isSendScreen()?h.OpenViduErrorName.SCREEN_CAPTURE_DENIED:h.OpenViduErrorName.DEVICE_ACCESS_DENIED,r=t.toString(),u(new h.OpenViduError(n,r)),[3,12];case 6:return a.trys.push([6,8,,9]),[4,navigator.mediaDevices.getUserMedia({audio:!1,video:e.video})];case 7:return a.sent().getVideoTracks().forEach(function(e){e.stop()}),"deviceid"===t.constraint.toLowerCase()?(n=h.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,r="Audio input device with deviceId '"+e.audio.deviceId.exact+"' not found"):(n=h.OpenViduErrorName.PUBLISHER_PROPERTIES_ERROR,r="Audio input device doesn't support the value passed for constraint '"+t.constraint+"'"),u(new h.OpenViduError(n,r)),[3,9];case 8:return"deviceid"===(s=a.sent()).constraint.toLowerCase()?(n=h.OpenViduErrorName.INPUT_VIDEO_DEVICE_NOT_FOUND,r="Video input device with deviceId '"+e.video.deviceId.exact+"' not found"):(n=h.OpenViduErrorName.PUBLISHER_PROPERTIES_ERROR,r="Video input device doesn't support the value passed for constraint '"+s.constraint+"'"),u(new h.OpenViduError(n,r)),[3,9];case 10:return n=h.OpenViduErrorName.DEVICE_ALREADY_IN_USE,r=t.toString(),u(new h.OpenViduError(n,r)),[3,12];case 11:return n=h.OpenViduErrorName.GENERIC_ERROR,r=t.toString(),u(new h.OpenViduError(n,r)),[3,12];case 12:return[2]}})})},O.label=1;case 1:return O.trys.push([1,14,,15]),[4,this.openvidu.generateMediaConstraints(this.properties)];case 2:if(!((f=O.sent()).videoTrack&&f.audioTrack||f.audioTrack&&(null===(y=f.constraints)||void 0===y?void 0:y.video)===!1||f.videoTrack&&(null===(S=f.constraints)||void 0===S?void 0:S.audio)===!1))return[3,3];return d(this.openvidu.addAlreadyProvidedTracks(f,new MediaStream,this.stream)),[3,13];case 3:m={mediaConstraints:e=f.constraints,publisherProperties:this.properties},this.stream.setOutboundStreamOptions(m),b=void 0===e.audio||e.audio,r.audio=!this.stream.isSendScreen()&&b,r.video=e.video,c=Date.now(),this.setPermissionDialogTimer(o),O.label=4;case 4:if(O.trys.push([4,11,,13]),!(this.stream.isSendScreen()&&navigator.mediaDevices.getDisplayMedia&&!i.isElectron()))return[3,7];return[4,navigator.mediaDevices.getDisplayMedia({video:!0})];case 5:return E=O.sent(),this.openvidu.addAlreadyProvidedTracks(f,E),[4,l(E,b)];case 6:return O.sent(),[3,10];case 7:return this.stream.lastVideoTrackConstraints=r.video,[4,navigator.mediaDevices.getUserMedia(r)];case 8:return E=O.sent(),this.openvidu.addAlreadyProvidedTracks(f,E,this.stream),[4,l(E,b)];case 9:O.sent(),O.label=10;case 10:return[3,13];case 11:return[4,p(O.sent())];case 12:return O.sent(),[3,13];case 13:return[3,15];case 14:return u(O.sent()),[3,15];case 15:return[2]}})})})},t.prototype.replaceTrackAux=function(e,t){return s(this,void 0,void 0,function(){var n,r;return a(this,function(i){switch(i.label){case 0:n=e.enabled,"video"===e.kind?e.enabled=this.stream.videoActive:"audio"===e.kind&&(e.enabled=this.stream.audioActive),i.label=1;case 1:if(i.trys.push([1,5,,6]),!this.stream.isLocalStreamPublished)return[3,3];return this.replaceTrackInMediaStream(e,t),[4,this.replaceTrackInRtcRtpSender(e)];case 2:return[2,i.sent()];case 3:return[2,this.replaceTrackInMediaStream(e,t)];case 4:return[3,6];case 5:throw r=i.sent(),e.enabled=n,r;case 6:return[2]}})})},t.prototype.getVideoDimensions=function(){var e=this;return new Promise(function(t,n){var r,o=(i.isIonicIos()||i.isIOSWithSafari())&&e.videoReference.readyState<1,s=function(){if("function"==typeof e.stream.getMediaStream().getVideoTracks()[0].getSettings){var n,s,a=e.stream.getMediaStream().getVideoTracks()[0].getSettings();n=a.width||e.videoReference.videoWidth,s=a.height||e.videoReference.videoHeight}else g.warn("MediaStreamTrack does not have getSettings method on "+i.getDescription()),n=e.videoReference.videoWidth,s=e.videoReference.videoHeight;return null!=r&&e.videoReference.removeEventListener("loadedmetadata",r),o&&document.body.removeChild(e.videoReference),t({width:n,height:s})};e.videoReference.readyState>=1?s():(r=function(){if(e.videoReference.videoWidth)s();else var t=setInterval(function(){e.videoReference.videoWidth&&(clearInterval(t),s())},40)},e.videoReference.addEventListener("loadedmetadata",r),o&&document.body.appendChild(e.videoReference))})},t.prototype.reestablishStreamPlayingEvent=function(){this.ee.getListeners("streamPlaying").length>0&&this.addPlayEventToFirstVideo()},t.prototype.initializeVideoReference=function(e){this.videoReference=document.createElement("video"),this.videoReference.style.display="none",this.videoReference.muted=!0,this.videoReference.autoplay=!0,this.videoReference.controls=!1,(i.isSafariBrowser()||i.isIPhoneOrIPad()&&(i.isChromeMobileBrowser()||i.isEdgeMobileBrowser()||i.isOperaMobileBrowser()||i.isFirefoxMobileBrowser()))&&(this.videoReference.playsInline=!0),this.stream.setMediaStream(e),this.firstVideoElement&&this.createVideoElement(this.firstVideoElement.targetElement,this.properties.insertMode),this.videoReference.srcObject=this.stream.getMediaStream()},t.prototype.replaceTrackInMediaStream=function(e,t){var n,r=this.stream.displayMyRemote()?this.stream.localMediaStreamWhenSubscribedToRemote:this.stream.getMediaStream();"video"===e.kind?(n=r.getVideoTracks()[0],t&&(this.stream.lastVideoTrackConstraints=e.getConstraints())):n=r.getAudioTracks()[0],n.enabled=!1,n.stop(),r.removeTrack(n),r.addTrack(e);var i={oldLabel:(null==n?void 0:n.label)||"",newLabel:(null==e?void 0:e.label)||""};"video"===e.kind&&t?(this.openvidu.sendNewVideoDimensionsIfRequired(this,"trackReplaced",50,30),this.openvidu.sendTrackChangedEvent(this,i.oldLabel,i.newLabel,"videoTrack"),this.stream.isLocalStreamPublished&&this.session.sendVideoData(this.stream.streamManager,5,!0,5)):"audio"===e.kind&&t&&this.openvidu.sendTrackChangedEvent(this,i.oldLabel,i.newLabel,"audioTrack"),"audio"===e.kind&&(this.stream.disableHarkSpeakingEvent(!1),this.stream.disableHarkStoppedSpeakingEvent(!1),this.stream.disableHarkVolumeChangeEvent(!1),this.stream.initHarkEvents())},t.prototype.setPermissionDialogTimer=function(e){var t=this;this.permissionDialogTimeout=setTimeout(function(){t.emitEvent("accessDialogOpened",[])},e)},t.prototype.clearPermissionDialogTimer=function(e,t){clearTimeout(this.permissionDialogTimeout),Date.now()-e>t&&this.emitEvent("accessDialogClosed",[])},t.prototype.replaceTrackInRtcRtpSender=function(e){return s(this,void 0,void 0,function(){var t,n;return a(this,function(r){switch(r.label){case 0:if(t=this.stream.getRTCPeerConnection().getSenders(),"video"===e.kind){if(!(n=t.find(function(e){return!!e.track&&"video"===e.track.kind})))throw Error("There's no replaceable track for that kind of MediaStreamTrack in this Publisher object")}else if("audio"===e.kind){if(!(n=t.find(function(e){return!!e.track&&"audio"===e.track.kind})))throw Error("There's no replaceable track for that kind of MediaStreamTrack in this Publisher object")}else throw Error("Unknown track kind "+e.kind);return[4,n.replaceTrack(e)];case 1:return r.sent(),[2]}})})},t}(d.StreamManager);t.Publisher=b},7678:function(e,t,n){"use strict";var r,i,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Session=void 0;var c=n(3274),u=n(6153),d=n(4980),l=n(3013),p=n(5223),h=n(146),f=n(8856),m=n(3439),v=n(3685),g=n(1342),b=n(3590),E=n(7614),y=n(6203),S=n(9233),w=n(7009),O=n(4270),C=n(5364),I=n(5971),R=n(6378),P=n(7789),T=n(6056),k=C.OpenViduLogger.getInstance(),_=function(e){function t(t){var n=e.call(this)||this;return n.streamManagers=[],n.remoteStreamsCreated=new Map,n.remoteConnections=new Map,i=I.PlatformUtils.getInstance(),n.openvidu=t,n}return o(t,e),t.prototype.connect=function(e,t){var n=this;return new Promise(function(r,o){if(n.processToken(e),!n.openvidu.checkSystemRequirements())return o(new w.OpenViduError(w.OpenViduErrorName.BROWSER_NOT_SUPPORTED,"Browser "+i.getName()+" (version "+i.getVersion()+") for "+i.getFamily()+" is not supported in OpenVidu"));n.options={sessionId:n.sessionId,participantId:e,metadata:t?n.stringClientMetadata(t):""},n.connectAux(e).then(function(){return r()}).catch(function(e){return o(e)})})},t.prototype.disconnect=function(){this.leave(!1,"disconnect")},t.prototype.subscribe=function(e,t,n,r){var i={};i=n&&"function"!=typeof n?{insertMode:void 0!==n.insertMode?"string"==typeof n.insertMode?O.VideoInsertMode[n.insertMode]:i.insertMode:O.VideoInsertMode.APPEND,subscribeToAudio:void 0===n.subscribeToAudio||n.subscribeToAudio,subscribeToVideo:void 0===n.subscribeToVideo||n.subscribeToVideo}:{insertMode:O.VideoInsertMode.APPEND,subscribeToAudio:!0,subscribeToVideo:!0};var o=void 0;if(n&&"function"==typeof n?o=n:r&&(o=r),!this.sessionConnected())throw void 0!==o&&o(this.notConnectedError()),this.notConnectedError();k.info("Subscribing to "+e.connection.connectionId),e.subscribe().then(function(){k.info("Subscribed correctly to "+e.connection.connectionId),void 0!==o&&o(void 0)}).catch(function(e){void 0!==o&&o(e)});var s=new d.Subscriber(e,t,i);return s.targetElement&&e.streamManager.createVideoElement(s.targetElement,i.insertMode),s},t.prototype.subscribeAsync=function(e,t,n){var r=this;return new Promise(function(i,o){if(!r.sessionConnected())return o(r.notConnectedError());var s,a=function(e){return e?o(e):i(s)};s=n?r.subscribe(e,t,n,a):r.subscribe(e,t,a)})},t.prototype.unsubscribe=function(e){var t=this;return new Promise(function(n,r){if(!t.sessionConnected())return r(t.notConnectedError());var i=e.stream.connection.connectionId;k.info("Unsubscribing from "+i),t.openvidu.sendRequest("unsubscribeFromVideo",{sender:e.stream.connection.connectionId},function(t,o){return t?(k.error("Error unsubscribing from "+i),r(t)):(k.info("Unsubscribed correctly from "+i),e.stream.streamManager.removeAllVideos(),e.stream.disposeWebRtcPeer(),e.stream.disposeMediaStream(),n())})})},t.prototype.publish=function(e){var t=this;return new Promise(function(n,r){if(!t.sessionConnected())return r(t.notConnectedError());e.session=t,e.stream.session=t,e.stream.publishedOnce?e.initialize().then(function(){t.connection.addStream(e.stream),e.reestablishStreamPlayingEvent(),e.stream.publish().then(function(){return t.sendVideoData(e,8,!0,5),n()}).catch(function(e){return r(e)})}).catch(function(e){return r(e)}):(t.connection.addStream(e.stream),e.stream.publish().then(function(){return t.sendVideoData(e,8,!0,5),n()}).catch(function(e){return r(e)}))})},t.prototype.unpublish=function(e){var t=this;return new Promise(function(n,r){if(!t.sessionConnected())throw t.notConnectedError();var i=e.stream;return i.connection?i.connection!==t.connection?r(Error("The associated Connection object of this Publisher is not your local Connection.  Only moderators can force unpublish on remote Streams via 'forceUnpublish' method")):void(k.info("Unpublishing local media ("+i.connection.connectionId+")"),t.openvidu.sendRequest("unpublishVideo",function(t,o){if(t)return r(t);k.info("Media unpublished correctly"),i.disposeWebRtcPeer(),i.connection.stream==i&&delete i.connection.stream;var s=new b.StreamEvent(!0,e,"streamDestroyed",e.stream,"unpublish");return e.emitEvent("streamDestroyed",[s]),s.callDefaultBehavior(),n()})):r(Error("The associated Connection object of this Publisher is null"))})},t.prototype.forceDisconnect=function(e){var t=this;return new Promise(function(n,r){if(!t.sessionConnected())return r(t.notConnectedError());k.info("Forcing disconnect for connection "+e.connectionId),t.openvidu.sendRequest("forceDisconnect",{connectionId:e.connectionId},function(t,i){return t?(k.error("Error forcing disconnect for Connection "+e.connectionId,t),401===t.code)?r(new w.OpenViduError(w.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to force a disconnection")):r(t):(k.info("Forcing disconnect correctly for Connection "+e.connectionId),n())})})},t.prototype.forceUnpublish=function(e){var t=this;return new Promise(function(n,r){if(!t.sessionConnected())return r(t.notConnectedError());k.info("Forcing unpublish for stream "+e.streamId),t.openvidu.sendRequest("forceUnpublish",{streamId:e.streamId},function(t,i){return t?(k.error("Error forcing unpublish for Stream "+e.streamId,t),401===t.code)?r(new w.OpenViduError(w.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to force an unpublishing")):r(t):(k.info("Forcing unpublish correctly for Stream "+e.streamId),n())})})},t.prototype.signal=function(e){var t=this;return new Promise(function(n,r){if(!t.sessionConnected())return r(t.notConnectedError());var i={};if(e.to&&e.to.length>0){var o=[];e.to.forEach(function(e){e.connectionId&&o.push(e.connectionId)}),i.to=o}else i.to=[];i.data=e.data?e.data:"";var s=e.type?e.type:"signal";s&&"signal:"!==s.substring(0,7)&&(s="signal:"+s),i.type=s,t.openvidu.sendRequest("sendMessage",{message:JSON.stringify(i)},function(e,t){return e?r(e):n()})})},t.prototype.subscribeToSpeechToText=function(e,t){var n=this;return new Promise(function(r,i){n.openvidu.sendRequest("subscribeToSpeechToText",{connectionId:e.connection.connectionId,lang:t},function(e,t){return e?i(e):r()})})},t.prototype.unsubscribeFromSpeechToText=function(e){var t=this;return new Promise(function(n,r){t.openvidu.sendRequest("unsubscribeFromSpeechToText",{connectionId:e.connection.connectionId},function(e,t){return e?r(e):n()})})},t.prototype.on=function(t,n){var r,i,o,s;return e.prototype.onAux.call(this,t,"Event '"+t+"' triggered by 'Session'",n),"publisherStartSpeaking"===t&&(this.remoteConnections.forEach(function(e){var t;(null===(t=e.stream)||void 0===t?void 0:t.hasAudio)&&e.stream.enableHarkSpeakingEvent()}),(null===(i=null===(r=this.connection)||void 0===r?void 0:r.stream)||void 0===i?void 0:i.hasAudio)&&this.connection.stream.enableHarkSpeakingEvent()),"publisherStopSpeaking"===t&&(this.remoteConnections.forEach(function(e){var t;(null===(t=e.stream)||void 0===t?void 0:t.hasAudio)&&e.stream.enableHarkStoppedSpeakingEvent()}),(null===(s=null===(o=this.connection)||void 0===o?void 0:o.stream)||void 0===s?void 0:s.hasAudio)&&this.connection.stream.enableHarkStoppedSpeakingEvent()),this},t.prototype.once=function(t,n){var r,i,o,s;return e.prototype.onceAux.call(this,t,"Event '"+t+"' triggered once by 'Session'",n),"publisherStartSpeaking"===t&&(this.remoteConnections.forEach(function(e){var t;(null===(t=e.stream)||void 0===t?void 0:t.hasAudio)&&e.stream.enableOnceHarkSpeakingEvent()}),(null===(i=null===(r=this.connection)||void 0===r?void 0:r.stream)||void 0===i?void 0:i.hasAudio)&&this.connection.stream.enableOnceHarkSpeakingEvent()),"publisherStopSpeaking"===t&&(this.remoteConnections.forEach(function(e){var t;(null===(t=e.stream)||void 0===t?void 0:t.hasAudio)&&e.stream.enableOnceHarkStoppedSpeakingEvent()}),(null===(s=null===(o=this.connection)||void 0===o?void 0:o.stream)||void 0===s?void 0:s.hasAudio)&&this.connection.stream.enableOnceHarkStoppedSpeakingEvent()),this},t.prototype.off=function(t,n){var r,i,o,s,a=this;return e.prototype.offAux.call(this,t,n),"publisherStartSpeaking"===t&&!this.anySpeechEventListenerEnabled("publisherStartSpeaking",!1)&&(this.remoteConnections.forEach(function(e){var t;(null===(t=e.stream)||void 0===t?void 0:t.streamManager)&&!a.anySpeechEventListenerEnabled("publisherStartSpeaking",!1,e.stream.streamManager)&&e.stream.disableHarkSpeakingEvent(!1)}),(null===(i=null===(r=this.connection)||void 0===r?void 0:r.stream)||void 0===i?void 0:i.streamManager)&&!this.anySpeechEventListenerEnabled("publisherStartSpeaking",!1,this.connection.stream.streamManager)&&this.connection.stream.disableHarkSpeakingEvent(!1)),"publisherStopSpeaking"===t&&!this.anySpeechEventListenerEnabled("publisherStopSpeaking",!1)&&(this.remoteConnections.forEach(function(e){var t;(null===(t=e.stream)||void 0===t?void 0:t.streamManager)&&!a.anySpeechEventListenerEnabled("publisherStopSpeaking",!1,e.stream.streamManager)&&e.stream.disableHarkStoppedSpeakingEvent(!1)}),(null===(s=null===(o=this.connection)||void 0===o?void 0:o.stream)||void 0===s?void 0:s.streamManager)&&!this.anySpeechEventListenerEnabled("publisherStopSpeaking",!1,this.connection.stream.streamManager)&&this.connection.stream.disableHarkStoppedSpeakingEvent(!1)),this},t.prototype.onParticipantJoined=function(e){var t=this;this.getConnection(e.id,"").then(function(e){k.warn("Connection "+e.connectionId+" already exists in connections list")}).catch(function(n){var r=new c.Connection(t,e);t.remoteConnections.set(e.id,r),t.ee.emitEvent("connectionCreated",[new p.ConnectionEvent(!1,t,"connectionCreated",r,"")])})},t.prototype.onParticipantLeft=function(e){var t=this;this.getRemoteConnection(e.connectionId,"onParticipantLeft").then(function(n){if(n.stream){var r=n.stream,i=new b.StreamEvent(!0,t,"streamDestroyed",r,e.reason);t.ee.emitEvent("streamDestroyed",[i]),i.callDefaultBehavior(),t.remoteStreamsCreated.delete(r.streamId)}n.dispose(),t.remoteConnections.delete(n.connectionId),t.ee.emitEvent("connectionDestroyed",[new p.ConnectionEvent(!1,t,"connectionDestroyed",n,e.reason)])}).catch(function(e){k.error(e)})},t.prototype.onParticipantPublished=function(e){var t,n=this,r=function(e){n.remoteConnections.set(e.connectionId,e),n.remoteStreamsCreated.get(e.stream.streamId)||n.ee.emitEvent("streamCreated",[new b.StreamEvent(!1,n,"streamCreated",e.stream,"")]),n.remoteStreamsCreated.set(e.stream.streamId,!0)};this.getRemoteConnection(e.id,"onParticipantPublished").then(function(n){t=n,e.metadata=n.data,t.remoteOptions=e,t.initRemoteStreams(e.streams),r(t)}).catch(function(i){r(t=new c.Connection(n,e))})},t.prototype.onParticipantUnpublished=function(e){var t=this;e.connectionId===this.connection.connectionId?this.stopPublisherStream(e.reason):this.getRemoteConnection(e.connectionId,"onParticipantUnpublished").then(function(n){var r=new b.StreamEvent(!0,t,"streamDestroyed",n.stream,e.reason);if(t.ee.emitEvent("streamDestroyed",[r]),r.callDefaultBehavior(),null!=n.stream){var i=n.stream.streamId;t.remoteStreamsCreated.delete(i),n.removeStream()}}).catch(function(e){k.error(e)})},t.prototype.onParticipantEvicted=function(e){e.connectionId===this.connection.connectionId&&this.sessionId&&!this.connection.disposed&&this.leave(!0,e.reason)},t.prototype.onNewMessage=function(e){var t=this;k.info("New signal: "+JSON.stringify(e));var n=e.type?e.type.replace(/^(signal:)/,""):void 0;e.from?this.getConnection(e.from,"Connection '"+e.from+"' unknown when 'onNewMessage'. Existing remote connections: "+JSON.stringify(this.remoteConnections.keys())+". Existing local connection: "+this.connection.connectionId).then(function(r){t.ee.emitEvent("signal",[new v.SignalEvent(t,n,e.data,r)]),e.type&&"signal"!==e.type&&t.ee.emitEvent(e.type,[new v.SignalEvent(t,n,e.data,r)])}).catch(function(e){k.error(e)}):(this.ee.emitEvent("signal",[new v.SignalEvent(this,n,e.data,void 0)]),e.type&&"signal"!==e.type&&this.ee.emitEvent(e.type,[new v.SignalEvent(this,n,e.data,void 0)]))},t.prototype.onStreamPropertyChanged=function(e){var t=this,n=function(n){var r,i;if(n.stream&&n.stream.streamId===e.streamId){var o=n.stream,s=void 0;switch(e.property){case"audioActive":s=o.audioActive,e.newValue="true"===e.newValue,o.audioActive=e.newValue;break;case"videoActive":s=o.videoActive,e.newValue="true"===e.newValue,o.videoActive=e.newValue;var a=null===(i=null===(r=null==o?void 0:o.getMediaStream())||void 0===r?void 0:r.getVideoTracks())||void 0===i?void 0:i[0];a&&!a.enabled&&o.videoActive&&(a.enabled=!0);break;case"videoTrack":case"audioTrack":e.newValue=JSON.parse(e.newValue);break;case"videoDimensions":s=o.videoDimensions,e.newValue=JSON.parse(JSON.parse(e.newValue)),o.videoDimensions=e.newValue;break;case"filter":s=o.filter,e.newValue=Object.keys(e.newValue).length>0?e.newValue:void 0,void 0!==e.newValue?(o.filter=new u.Filter(e.newValue.type,e.newValue.options),o.filter.stream=o,e.newValue.lastExecMethod&&(o.filter.lastExecMethod=e.newValue.lastExecMethod)):delete o.filter,e.newValue=o.filter}t.ee.emitEvent("streamPropertyChanged",[new E.StreamPropertyChangedEvent(t,o,e.property,e.newValue,s,e.reason)]),o.streamManager&&o.streamManager.emitEvent("streamPropertyChanged",[new E.StreamPropertyChangedEvent(o.streamManager,o,e.property,e.newValue,s,e.reason)])}else k.error("No stream with streamId '"+e.streamId+"' found for connection '"+e.connectionId+"' on 'streamPropertyChanged' event")};e.connectionId===this.connection.connectionId?n(this.connection):this.getRemoteConnection(e.connectionId,"onStreamPropertyChanged").then(function(e){n(e)}).catch(function(e){k.error(e)})},t.prototype.onConnectionPropertyChanged=function(e){var t;switch(e.property){case"role":t=this.connection.role.slice(),this.connection.role=e.newValue,this.connection.localOptions.role=e.newValue;break;case"record":t=this.connection.record,e.newValue="true"===e.newValue,this.connection.record=e.newValue,this.connection.localOptions.record=e.newValue}this.ee.emitEvent("connectionPropertyChanged",[new y.ConnectionPropertyChangedEvent(this,this.connection,e.property,e.newValue,t)])},t.prototype.onNetworkQualityLevelChangedChanged=function(e){var t=this;e.connectionId===this.connection.connectionId?this.ee.emitEvent("networkQualityLevelChanged",[new S.NetworkQualityLevelChangedEvent(this,e.newValue,e.oldValue,this.connection)]):this.getConnection(e.connectionId,"Connection not found for connectionId "+e.connectionId).then(function(n){t.ee.emitEvent("networkQualityLevelChanged",[new S.NetworkQualityLevelChangedEvent(t,e.newValue,e.oldValue,n)])}).catch(function(e){k.error(e)})},t.prototype.recvIceCandidate=function(e){var t={candidate:e.candidate,sdpMLineIndex:e.sdpMLineIndex,sdpMid:e.sdpMid},n=new RTCIceCandidate(t);this.getConnection(e.senderConnectionId,"Connection not found for connectionId "+e.senderConnectionId+" owning endpoint "+e.endpointName+". Ice candidate will be ignored: "+n).then(function(t){var r=t.stream;r.getWebRtcPeer().addIceCandidate(n).catch(function(t){k.error("Error adding candidate for "+r.streamId+" stream of endpoint "+e.endpointName+": "+t)})}).catch(function(e){k.error(e)})},t.prototype.onSessionClosed=function(e){k.info("Session closed: "+JSON.stringify(e));var t=e.sessionId;void 0!==t?this.ee.emitEvent("session-closed",[{session:t}]):k.warn("Session undefined on session closed",e)},t.prototype.onLostConnection=function(e){k.warn("Lost connection in Session "+this.sessionId),this.sessionId&&this.connection&&!this.connection.disposed&&this.leave(!0,e)},t.prototype.onRecoveredConnection=function(){k.info("Recovered connection in Session "+this.sessionId),this.reconnectBrokenStreams(),this.ee.emitEvent("reconnected",[])},t.prototype.onMediaError=function(e){k.error("Media error: "+JSON.stringify(e));var t=e.error;t?this.ee.emitEvent("error-media",[{error:t}]):k.warn("Received undefined media error:",e)},t.prototype.onRecordingStarted=function(e){this.ee.emitEvent("recordingStarted",[new f.RecordingEvent(this,"recordingStarted",e.id,e.name)])},t.prototype.onRecordingStopped=function(e){this.ee.emitEvent("recordingStopped",[new f.RecordingEvent(this,"recordingStopped",e.id,e.name,e.reason)])},t.prototype.onBroadcastStarted=function(){this.ee.emitEvent("broadcastStarted",[])},t.prototype.onBroadcastStopped=function(){this.ee.emitEvent("broadcastStopped",[])},t.prototype.onFilterEventDispatched=function(e){var t=this,n=e.connectionId;this.getConnection(n,"No connection found for connectionId "+n).then(function(n){k.info('Filter event of type "'.concat(e.eventType,'" dispatched'));var r=n.stream;if(!r||!r.filter)return k.error('Filter event of type "'.concat(e.eventType,'" dispatched for stream ').concat(r.streamId," but there is no ").concat(r?"filter":"stream"," defined"));var i=r.filter.handlers.get(e.eventType);if(i&&"function"==typeof i)i.call(t,new h.FilterEvent(r.filter,e.eventType,e.data));else{var o=Array.from(r.filter.handlers.keys());return k.error('Filter event of type "'.concat(e.eventType,'" not handled or not a function! Active filter events: ').concat(o.join(",")))}})},t.prototype.onForciblyReconnectSubscriber=function(e){var t=this;return new Promise(function(n,r){t.getRemoteConnection(e.connectionId,"onForciblyReconnectSubscriber").then(function(i){if(i.stream&&i.stream.streamId===e.streamId){var o=i.stream;if(o.setupReconnectionEventEmitter(n,r)){if(null!=o.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent)return o.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent=e,r("Ongoing forced subscriber reconnection");o.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent=e;var s=function(){var e=o.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent;delete o.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent,t.onForciblyReconnectSubscriber(e)};return o.reconnectionEventEmitter.once("success",function(){s()}),void o.reconnectionEventEmitter.once("error",function(){s()})}o.completeWebRtcPeerReceive(!0,!0,e.sdpOffer).then(function(){return o.finalResolveForSubscription(!0,n)}).catch(function(t){return o.finalRejectForSubscription(!0,"Error while forcibly reconnecting remote stream ".concat(e.streamId,": ").concat(t.toString()),r)})}else{var a="No stream with streamId '"+e.streamId+"' found for connection '"+e.connectionId+"' on 'streamPropertyChanged' event";return k.error(a),r(a)}}).catch(function(e){return k.error(e),r(e)})})},t.prototype.reconnectBrokenStreams=function(){k.info("Re-establishing media connections...");var e=!1;this.connection.stream&&this.connection.stream.streamIceConnectionStateBroken()&&(k.warn("Re-establishing Publisher "+this.connection.stream.streamId),this.connection.stream.initWebRtcPeerSend(!0),e=!0),this.remoteConnections.forEach(function(t){t.stream&&t.stream.streamIceConnectionStateBroken()&&(k.warn("Re-establishing Subscriber "+t.stream.streamId),t.stream.initWebRtcPeerReceive(!0),e=!0)}),e||k.info("There were no media streams in need of a reconnection")},t.prototype.onSpeechToTextMessage=function(e){return s(this,void 0,void 0,function(){var t,n;return a(this,function(r){switch(r.label){case 0:return[4,this.getConnection(e.connectionId,"No connection found for connectionId "+e.connectionId)];case 1:return t=r.sent(),n=new g.SpeechToTextEvent(this,t,e.text,e.reason.toLowerCase(),e.raw,e.lang),this.ee.emitEvent("speechToTextMessage",[n]),[2]}})})},t.prototype.onSpeechToTextDisconnected=function(e){return s(this,void 0,void 0,function(){return a(this,function(t){return this.emitEvent("exception",[new T.ExceptionEvent(this,T.ExceptionEventName.SPEECH_TO_TEXT_DISCONNECTED,this,e.message)]),[2]})})},t.prototype.emitEvent=function(e,t){this.ee.emitEvent(e,t)},t.prototype.leave=function(e,t){var n=this;if(e=!!e,k.info("Leaving Session (forced="+e+")"),this.stopVideoDataIntervals(),this.connection){if(this.connection.disposed||e?this.openvidu.closeWs():this.openvidu.sendRequest("leaveRoom",function(e,t){e&&k.error("leaveRoom error: ".concat(JSON.stringify(e))),n.openvidu.closeWs()}),this.stopPublisherStream(t),!this.connection.disposed){var r=new m.SessionDisconnectedEvent(this,t);this.ee.emitEvent("sessionDisconnected",[r]),r.callDefaultBehavior()}}else k.warn("You were not connected to the session "+this.sessionId);k.flush()},t.prototype.initializeParams=function(e){return{token:e||"",session:this.sessionId,platform:i.getDescription()?i.getDescription():"unknown",sdkVersion:this.openvidu.libraryVersion,metadata:this.options.metadata?this.options.metadata:"",secret:this.openvidu.getSecret(),recorder:this.openvidu.getRecorder(),stt:this.openvidu.getStt()}},t.prototype.sendVideoData=function(e,t,n,r){var o,c,u=this;if(void 0===t&&(t=1),void 0===n&&(n=!1),void 0===r&&(r=1),i.isChromeBrowser()||i.isChromeMobileBrowser()||i.isOperaBrowser()||i.isOperaMobileBrowser()||i.isEdgeBrowser()||i.isEdgeMobileBrowser()||i.isElectron()||i.isSafariBrowser()&&!i.isIonicIos()||i.isAndroidBrowser()||i.isSamsungBrowser()||i.isIonicAndroid()||i.isIOSWithSafari()){var d=function(){return s(u,void 0,void 0,function(){var t,n,r;return a(this,function(i){switch(i.label){case 0:if("connected"!==(t=e.stream.getRTCPeerConnection()).connectionState)return[3,2];return[4,t.getStats()];case 1:n=i.sent(),r=[],n.forEach(function(e){"frameWidth"in e&&"frameHeight"in e&&0===r.length&&r.push(e)}),r.length>0&&this.openvidu.sendRequest("videoData",{height:r[0].frameHeight,width:r[0].frameWidth,videoActive:null!=e.stream.videoActive&&e.stream.videoActive,audioActive:null!=e.stream.audioActive&&e.stream.audioActive},function(e,t){e&&k.error("Error sending 'videoData' event",e)}),i.label=2;case 2:return[2]}})})};if(n){var l=1;this.videoDataInterval=setInterval(function(){l<r?(l++,d()):clearInterval(u.videoDataInterval)},1e3*t)}else this.videoDataTimeout=setTimeout(d,1e3*t)}else i.isFirefoxBrowser()||i.isFirefoxMobileBrowser()||i.isIonicIos()||i.isReactNative()?this.openvidu.sendRequest("videoData",{height:(null===(o=e.stream.videoDimensions)||void 0===o?void 0:o.height)||0,width:(null===(c=e.stream.videoDimensions)||void 0===c?void 0:c.width)||0,videoActive:null!=e.stream.videoActive&&e.stream.videoActive,audioActive:null!=e.stream.audioActive&&e.stream.audioActive},function(e,t){e&&k.error("Error sending 'videoData' event",e)}):k.error("Browser "+i.getName()+" (version "+i.getVersion()+") for "+i.getFamily()+" is not supported in OpenVidu for Network Quality")},t.prototype.sessionConnected=function(){return null!=this.connection},t.prototype.notConnectedError=function(){return new w.OpenViduError(w.OpenViduErrorName.OPENVIDU_NOT_CONNECTED,"There is no connection to the session. Method 'Session.connect' must be successfully completed first")},t.prototype.anySpeechEventListenerEnabled=function(e,t,n){var r=this.ee.getListeners(e);if(t&&(r=r.filter(function(e){return e.once})),r.length>0)return!0;var i=0;if(n){var o=n.ee.getListeners(e);t&&(o=o.filter(function(e){return e.once})),i=o.length}return i>0},t.prototype.getTokenParams=function(e){var t=e.match(/^(wss?)\:\/\/(([^:\/?#]*)(?:\:([0-9]+))?)([\/]{0,1}[^?#]*)(\?[^#]*|)(#.*|)$/);if(t){var n={protocol:t[1],host:t[2],hostname:t[3],port:t[4],pathname:t[5],search:t[6],hash:t[7]},r=decodeURI(e.split("?")[1]).split("&").map(function(e){return e.split("=")}).reduce(function(e,t){var n=t[0],r=t[1];return e[n]=r,e},{});return{sessionId:r.sessionId,secret:r.secret,recorder:r.recorder,stt:r.stt,webrtcStatsInterval:r.webrtcStatsInterval,sendBrowserLogs:r.sendBrowserLogs,edition:r.edition,wsUri:n.protocol+"://"+n.host+"/openvidu",httpUri:"https://"+n.host}}throw Error('Token not valid: "'.concat(e,'"'))},t.prototype.connectAux=function(e){var t=this;return new Promise(function(n,r){t.openvidu.startWs(function(i){if(i)return r(i);var o=t.initializeParams(e);t.openvidu.sendRequest("joinRoom",o,function(i,o){if(i)return r(i);t.processJoinRoomResponse(o,e),t.connection=new c.Connection(t,o);var s={connections:[],streams:[]};return o.value.forEach(function(e){var n=new c.Connection(t,e);t.remoteConnections.set(n.connectionId,n),s.connections.push(n),n.stream&&(t.remoteStreamsCreated.set(n.stream.streamId,!0),s.streams.push(n.stream))}),t.ee.emitEvent("connectionCreated",[new p.ConnectionEvent(!1,t,"connectionCreated",t.connection,"")]),s.connections.forEach(function(e){t.ee.emitEvent("connectionCreated",[new p.ConnectionEvent(!1,t,"connectionCreated",e,"")])}),s.streams.forEach(function(e){t.ee.emitEvent("streamCreated",[new b.StreamEvent(!1,t,"streamCreated",e,"")])}),o.recordingId&&o.recordingName&&t.ee.emitEvent("recordingStarted",[new f.RecordingEvent(t,"recordingStarted",o.recordingId,o.recordingName)]),n()})})})},t.prototype.stopPublisherStream=function(e){this.connection.stream&&(this.connection.stream.disposeWebRtcPeer(),this.connection.stream.isLocalStreamPublished&&this.connection.stream.ee.emitEvent("local-stream-destroyed",[e]))},t.prototype.stopVideoDataIntervals=function(){clearInterval(this.videoDataInterval),clearTimeout(this.videoDataTimeout)},t.prototype.stringClientMetadata=function(e){return"string"!=typeof e?JSON.stringify(e):e},t.prototype.getConnection=function(e,t){var n=this;return new Promise(function(r,i){var o=n.remoteConnections.get(e);return o?r(o):n.connection.connectionId===e?r(n.connection):i(new w.OpenViduError(w.OpenViduErrorName.GENERIC_ERROR,t))})},t.prototype.getRemoteConnection=function(e,t){var n=this;return new Promise(function(r,i){var o=n.remoteConnections.get(e);if(o)return r(o);var s="Remote connection "+e+" unknown when '"+t+"'. Existing remote connections: "+JSON.stringify(n.remoteConnections.keys());return i(new w.OpenViduError(w.OpenViduErrorName.GENERIC_ERROR,s))})},t.prototype.processToken=function(e){var t=this.getTokenParams(e);this.sessionId=t.sessionId,t.secret&&(this.openvidu.secret=t.secret),t.recorder&&(this.openvidu.recorder=!0),t.stt&&(this.openvidu.stt=!0),t.webrtcStatsInterval&&(this.openvidu.webrtcStatsInterval=t.webrtcStatsInterval),t.sendBrowserLogs&&(this.openvidu.sendBrowserLogs=t.sendBrowserLogs),this.openvidu.isAtLeastPro="pro"===t.edition||"enterprise"===t.edition,this.openvidu.isEnterprise="enterprise"===t.edition,this.openvidu.wsUri=t.wsUri,this.openvidu.httpUri=t.httpUri},t.prototype.processJoinRoomResponse=function(e,t){if(this.sessionId=e.session,null!=e.customIceServers&&e.customIceServers.length>0){this.openvidu.iceServers=[];for(var n=0,r=e.customIceServers;n<r.length;n++){var i=r[n],o={urls:[i.url]};k.log("STUN/TURN server IP: "+i.url),null!=i.username&&null!=i.credential&&(o.username=i.username,o.credential=i.credential,k.log("TURN credentials ["+i.username+":"+i.credential+"]")),this.openvidu.iceServers.push(o)}}this.openvidu.role=e.role,this.openvidu.finalUserId=e.finalUserId,this.openvidu.mediaServer=e.mediaServer,this.openvidu.videoSimulcast=e.videoSimulcast,this.capabilities={subscribe:!0,publish:"SUBSCRIBER"!==this.openvidu.role,forceUnpublish:"MODERATOR"===this.openvidu.role,forceDisconnect:"MODERATOR"===this.openvidu.role},k.info("openvidu-server version: "+e.version),null!=e.life&&(this.openvidu.life=e.life);var s=P(e.version)-P(this.openvidu.libraryVersion);R(e.version)===R(this.openvidu.libraryVersion)&&(0==s||1==s)?1==s&&k.warn("openvidu-browser version ".concat(this.openvidu.libraryVersion," does not match openvidu-server version ").concat(e.version,". ")+"These versions are still compatible with each other, but openvidu-browser version must be updated as soon as possible to ".concat(R(e.version),".").concat(P(e.version),".x. ")+"This client using openvidu-browser ".concat(this.openvidu.libraryVersion," will become incompatible with the next release of openvidu-server")):k.error("openvidu-browser (".concat(this.openvidu.libraryVersion,") and openvidu-server (").concat(e.version,") versions are incompatible. ")+"Errors are likely to occur. openvidu-browser SDK is only compatible with the same version or the immediately following minor version of an OpenVidu deployment"),C.OpenViduLogger.configureJSNLog(this.openvidu,t),this.token=t},t}(l.EventDispatcher);t.Session=_},7686:function(e,t,n){"use strict";var r,i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Stream=void 0;var s=n(6153),a=n(4980),c=n(734),u=n(7137),d=n(6056),l=n(8271),p=n(3977),h=n(7614),f=n(7009),m=n(1513),v=n(5364),g=n(5971),b=n(7429),E=n(8233),y=n(4795),S=v.OpenViduLogger.getInstance(),w=function(){function e(e,t){var n=this;this.isSubscribeToRemote=!1,this.isLocalStreamReadyToPublish=!1,this.isLocalStreamPublished=!1,this.publishedOnce=!1,this.harkSpeakingEnabled=!1,this.harkSpeakingEnabledOnce=!1,this.harkStoppedSpeakingEnabled=!1,this.harkStoppedSpeakingEnabledOnce=!1,this.harkVolumeChangeEnabled=!1,this.harkVolumeChangeEnabledOnce=!1,this.ee=new y,r=g.PlatformUtils.getInstance(),this.session=e,t.hasOwnProperty("id")?(this.inboundStreamOpts=t,this.streamId=this.inboundStreamOpts.id,this.creationTime=this.inboundStreamOpts.createdAt,this.hasAudio=this.inboundStreamOpts.hasAudio,this.hasVideo=this.inboundStreamOpts.hasVideo,this.hasAudio&&(this.audioActive=this.inboundStreamOpts.audioActive),this.hasVideo&&(this.videoActive=this.inboundStreamOpts.videoActive,this.typeOfVideo=this.inboundStreamOpts.typeOfVideo?this.inboundStreamOpts.typeOfVideo:void 0,this.frameRate=-1===this.inboundStreamOpts.frameRate?void 0:this.inboundStreamOpts.frameRate,this.videoDimensions=this.inboundStreamOpts.videoDimensions),this.inboundStreamOpts.filter&&Object.keys(this.inboundStreamOpts.filter).length>0&&(this.inboundStreamOpts.filter.lastExecMethod&&0===Object.keys(this.inboundStreamOpts.filter.lastExecMethod).length&&delete this.inboundStreamOpts.filter.lastExecMethod,this.filter=this.inboundStreamOpts.filter)):(this.outboundStreamOpts=t,this.hasAudio=this.isSendAudio(),this.hasVideo=this.isSendVideo(),this.hasAudio&&(this.audioActive=!!this.outboundStreamOpts.publisherProperties.publishAudio),this.hasVideo&&(this.videoActive=!!this.outboundStreamOpts.publisherProperties.publishVideo,this.frameRate=this.outboundStreamOpts.publisherProperties.frameRate,"undefined"!=typeof MediaStreamTrack&&this.outboundStreamOpts.publisherProperties.videoSource instanceof MediaStreamTrack?this.typeOfVideo=m.TypeOfVideo.CUSTOM:this.typeOfVideo=this.isSendScreen()?m.TypeOfVideo.SCREEN:m.TypeOfVideo.CAMERA),this.outboundStreamOpts.publisherProperties.filter&&(this.filter=this.outboundStreamOpts.publisherProperties.filter)),this.ee.on("mediastream-updated",function(){var e;n.streamManager.updateMediaStream(n.mediaStream),S.debug("Video srcObject ["+(null===(e=n.mediaStream)||void 0===e?void 0:e.id)+"] updated in stream ["+n.streamId+"]")})}return e.prototype.reconnect=function(){return this.reconnectStream("API")},e.prototype.applyFilter=function(e,t){var n=this;return new Promise(function(r,a){return i(n,void 0,void 0,function(){var n,c,u,d,l,p,m=this;return o(this,function(v){if(this.filter)return[2,a(new f.OpenViduError(f.OpenViduErrorName.GENERIC_ERROR,"There is already a filter applied to Stream "+this.streamId))];if(n=function(n,i){if(n)return(S.error("Error applying filter for Stream "+m.streamId,n),401===n.code)?a(new f.OpenViduError(f.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to apply a filter")):a(n);S.info("Filter successfully applied on Stream "+m.streamId);var o=m.filter;return m.filter=new s.Filter(e,t),m.filter.stream=m,i&&(m.session.emitEvent("streamPropertyChanged",[new h.StreamPropertyChangedEvent(m.session,m,"filter",m.filter,o,"applyFilter")]),m.streamManager.emitEvent("streamPropertyChanged",[new h.StreamPropertyChangedEvent(m.streamManager,m,"filter",m.filter,o,"applyFilter")])),r(m.filter)},e.startsWith("VB:")){if(!this.hasVideo)return[2,a(new f.OpenViduError(f.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"The Virtual Background filter requires a video track to be applied"))];if(!this.mediaStream||0===this.streamManager.videos.length)return[2,a(new f.OpenViduError(f.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"The StreamManager requires some video element to be attached to it in order to apply a Virtual Background filter"))];if(!(c=this.session.token?this.session.token:t.token))return[2,a(new f.OpenViduError(f.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,'Virtual Background requires the client to be connected to a Session or to have a "token" property available in "options" parameter with a valid OpenVidu token'))];if("pro"!==(u=this.session.getTokenParams(c)).edition&&"enterprise"!==u.edition)return[2,a(new f.OpenViduError(f.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"OpenVidu Virtual Background API is available from OpenVidu Pro edition onwards"))];c=encodeURIComponent(btoa(c)),S.info("Applying Virtual Background to stream "+this.streamId),d=function(){return i(m,void 0,void 0,function(){var r,i,s,a,d,l;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,8,,9]),r=this.streamId+"_"+(0,b.v4)(),i=this.mediaStream.clone(),(s=this.streamManager.videos[0].video.cloneNode(!1)).id=VirtualBackground.VirtualBackground.SOURCE_VIDEO_PREFIX+r,s.srcObject=i,s.muted=!0,this.virtualBackgroundSourceElements={videoClone:s,mediaStreamClone:i},VirtualBackground.VirtualBackground.hideHtmlElement(s,!1),VirtualBackground.VirtualBackground.appendHtmlElementToHiddenContainer(s,r),[4,s.play()];case 1:switch(o.sent(),a=new VirtualBackground.VirtualBackground({id:r,openviduServerUrl:new URL(u.httpUri),openviduToken:c,inputVideo:s,inputResolution:"160x96",outputFramerate:24}),d=void 0,e){case"VB:blur":return[3,2];case"VB:image":return[3,4]}return[3,6];case 2:return[4,a.backgroundBlur(t)];case 3:case 5:return d=o.sent(),[3,7];case 4:return[4,a.backgroundImage(t)];case 6:throw Error("Unknown Virtual Background filter: "+e);case 7:return this.virtualBackgroundSinkElements={VB:a,video:d},s.style.display="none",this.streamManager.remote?this.streamManager.replaceTrackInMediaStream(this.virtualBackgroundSinkElements.video.srcObject.getVideoTracks()[0],!1):this.streamManager.replaceTrackAux(this.virtualBackgroundSinkElements.video.srcObject.getVideoTracks()[0],!1),n(void 0,!1),[3,9];case 8:return(l=o.sent()).name===f.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR?n(new f.OpenViduError(f.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,l.message),!1):n(l,!1),[3,9];case 9:return[2]}})})},"undefined"==typeof VirtualBackground?((l=document.createElement("script")).type="text/javascript",l.src=u.httpUri+"/openvidu/virtual-background/openvidu-virtual-background.js?token="+c,l.onload=function(){return i(m,void 0,void 0,function(){return o(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,d()];case 1:return n.sent(),r(new s.Filter(e,t)),[3,3];case 2:return a(n.sent()),[3,3];case 3:return[2]}})})},document.body.appendChild(l)):d().then(function(){return r(new s.Filter(e,t))}).catch(function(e){return a(e)})}else{if(!this.session.sessionConnected())return[2,a(this.session.notConnectedError())];S.info("Applying server filter to stream "+this.streamId),"string"!=typeof(p=t=null!=t?t:{})&&(p=JSON.stringify(p)),this.session.openvidu.sendRequest("applyFilter",{streamId:this.streamId,type:e,options:p},function(e,t){n(e,!0)})}return[2]})})})},e.prototype.removeFilter=function(){return i(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,this.removeFilterAux(!1)];case 1:return[2,e.sent()]}})})},e.prototype.getRTCPeerConnection=function(){return this.webRtcPeer.pc},e.prototype.getMediaStream=function(){return this.mediaStream},e.prototype.removeFilterAux=function(e){var t=this;return new Promise(function(n,r){return i(t,void 0,void 0,function(){var t,i,s,a=this;return o(this,function(o){switch(o.label){case 0:if(t=function(e,t){if(e)return(delete a.filter,S.error("Error removing filter for Stream "+a.streamId,e),401===e.code)?r(new f.OpenViduError(f.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to remove a filter")):r(e);S.info("Filter successfully removed from Stream "+a.streamId);var i=a.filter;return delete a.filter,t&&(a.session.emitEvent("streamPropertyChanged",[new h.StreamPropertyChangedEvent(a.session,a,"filter",a.filter,i,"applyFilter")]),a.streamManager.emitEvent("streamPropertyChanged",[new h.StreamPropertyChangedEvent(a.streamManager,a,"filter",a.filter,i,"applyFilter")])),n()},!this.filter)return[3,11];if(!(null===(s=this.filter)||void 0===s?void 0:s.type.startsWith("VB:")))return[3,9];o.label=1;case 1:if(o.trys.push([1,7,,8]),i=this.virtualBackgroundSourceElements.mediaStreamClone,e)return[3,5];if(!this.streamManager.remote)return[3,2];return this.streamManager.replaceTrackInMediaStream(i.getVideoTracks()[0],!1),[3,4];case 2:return[4,this.streamManager.replaceTrackAux(i.getVideoTracks()[0],!1)];case 3:o.sent(),o.label=4;case 4:return[3,6];case 5:i.getTracks().forEach(function(e){return e.stop()}),o.label=6;case 6:return this.virtualBackgroundSinkElements.VB.cleanUp(),delete this.virtualBackgroundSinkElements,delete this.virtualBackgroundSourceElements,[2,t(void 0,!1)];case 7:return[2,t(o.sent(),!1)];case 8:return[3,10];case 9:if(!this.session.sessionConnected())return[2,r(this.session.notConnectedError())];S.info("Removing filter of stream "+this.streamId),this.session.openvidu.sendRequest("removeFilter",{streamId:this.streamId},function(e,n){return t(e,!0)}),o.label=10;case 10:return[3,12];case 11:return[2,r(new f.OpenViduError(f.OpenViduErrorName.GENERIC_ERROR,"Stream "+this.streamId+" has no filter applied"))];case 12:return[2]}})})})},e.prototype.setMediaStream=function(e){this.mediaStream=e},e.prototype.updateMediaStreamInVideos=function(){this.ee.emitEvent("mediastream-updated",[])},e.prototype.getWebRtcPeer=function(){return this.webRtcPeer},e.prototype.subscribeToMyRemote=function(e){this.isSubscribeToRemote=e},e.prototype.setOutboundStreamOptions=function(e){this.outboundStreamOpts=e},e.prototype.subscribe=function(){var e=this;return new Promise(function(t,n){e.initWebRtcPeerReceive(!1).then(function(){return t()}).catch(function(e){return n(e)})})},e.prototype.publish=function(){var e=this;return new Promise(function(t,n){e.isLocalStreamReadyToPublish?e.initWebRtcPeerSend(!1).then(function(){return t()}).catch(function(e){return n(e)}):e.ee.once("stream-ready-to-publish",function(){e.publish().then(function(){return t()}).catch(function(e){return n(e)})})})},e.prototype.disposeWebRtcPeer=function(){var e;this.webRtcPeer&&(this.webRtcPeer.dispose(),e=this.webRtcPeer.getId()),this.stopWebRtcStats(),S.info((this.outboundStreamOpts?"Outbound ":"Inbound ")+"RTCPeerConnection with id ["+e+"] from 'Stream' with id ["+this.streamId+"] is now closed")},e.prototype.disposeMediaStream=function(){return i(this,void 0,void 0,function(){var e;return o(this,function(t){switch(t.label){case 0:if(!(this.filter&&this.filter.type.startsWith("VB:")))return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.removeFilterAux(!0)];case 2:return t.sent(),console.debug("Success removing Virtual Background filter for stream ".concat(this.streamId)),[3,4];case 3:return e=t.sent(),console.error("Error removing Virtual Background filter for stream ".concat(this.streamId),e),[3,4];case 4:return this.mediaStream&&(this.mediaStream.getAudioTracks().forEach(function(e){e.stop()}),this.mediaStream.getVideoTracks().forEach(function(e){e.stop()}),delete this.mediaStream),this.localMediaStreamWhenSubscribedToRemote&&(this.localMediaStreamWhenSubscribedToRemote.getAudioTracks().forEach(function(e){e.stop()}),this.localMediaStreamWhenSubscribedToRemote.getVideoTracks().forEach(function(e){e.stop()}),delete this.localMediaStreamWhenSubscribedToRemote),this.speechEvent&&(this.speechEvent.stop&&this.speechEvent.stop(),delete this.speechEvent),S.info((this.outboundStreamOpts?"Local ":"Remote ")+"MediaStream from 'Stream' with id ["+this.streamId+"] is now disposed"),[2]}})})},e.prototype.displayMyRemote=function(){return this.isSubscribeToRemote},e.prototype.isSendAudio=function(){return!!this.outboundStreamOpts&&null!==this.outboundStreamOpts.publisherProperties.audioSource&&!1!==this.outboundStreamOpts.publisherProperties.audioSource},e.prototype.isSendVideo=function(){return!!this.outboundStreamOpts&&null!==this.outboundStreamOpts.publisherProperties.videoSource&&!1!==this.outboundStreamOpts.publisherProperties.videoSource},e.prototype.isSendScreen=function(){var e=!1;if("undefined"!=typeof MediaStreamTrack&&this.outboundStreamOpts.publisherProperties.videoSource instanceof MediaStreamTrack){var t=this.outboundStreamOpts.publisherProperties.videoSource.getSettings();t.displaySurface&&(e=["monitor","window","browser"].includes(t.displaySurface))}return!e&&r.isElectron()&&(e="string"==typeof this.outboundStreamOpts.publisherProperties.videoSource&&this.outboundStreamOpts.publisherProperties.videoSource.startsWith("screen:")),e||(e="screen"===this.outboundStreamOpts.publisherProperties.videoSource),!!this.outboundStreamOpts&&e},e.prototype.enableHarkSpeakingEvent=function(){var e=this;this.setHarkListenerIfNotExists(),!this.harkSpeakingEnabled&&this.speechEvent&&(this.harkSpeakingEnabled=!0,this.speechEvent.on("speaking",function(){e.session.emitEvent("publisherStartSpeaking",[new l.PublisherSpeakingEvent(e.session,"publisherStartSpeaking",e.connection,e.streamId)]),e.streamManager.emitEvent("publisherStartSpeaking",[new l.PublisherSpeakingEvent(e.streamManager,"publisherStartSpeaking",e.connection,e.streamId)]),e.harkSpeakingEnabledOnce=!1}))},e.prototype.enableOnceHarkSpeakingEvent=function(){var e=this;this.setHarkListenerIfNotExists(),!this.harkSpeakingEnabledOnce&&this.speechEvent&&(this.harkSpeakingEnabledOnce=!0,this.speechEvent.once("speaking",function(){e.harkSpeakingEnabledOnce&&(e.session.emitEvent("publisherStartSpeaking",[new l.PublisherSpeakingEvent(e.session,"publisherStartSpeaking",e.connection,e.streamId)]),e.streamManager.emitEvent("publisherStartSpeaking",[new l.PublisherSpeakingEvent(e.streamManager,"publisherStartSpeaking",e.connection,e.streamId)])),e.disableHarkSpeakingEvent(!0)}))},e.prototype.disableHarkSpeakingEvent=function(e){if(this.speechEvent){if(this.harkSpeakingEnabledOnce=!1,e){if(this.harkSpeakingEnabled)return}else this.harkSpeakingEnabled=!1;this.harkVolumeChangeEnabled||this.harkVolumeChangeEnabledOnce||this.harkStoppedSpeakingEnabled||this.harkStoppedSpeakingEnabledOnce?this.speechEvent.off("speaking"):(this.speechEvent.stop(),delete this.speechEvent)}},e.prototype.enableHarkStoppedSpeakingEvent=function(){var e=this;this.setHarkListenerIfNotExists(),!this.harkStoppedSpeakingEnabled&&this.speechEvent&&(this.harkStoppedSpeakingEnabled=!0,this.speechEvent.on("stopped_speaking",function(){e.session.emitEvent("publisherStopSpeaking",[new l.PublisherSpeakingEvent(e.session,"publisherStopSpeaking",e.connection,e.streamId)]),e.streamManager.emitEvent("publisherStopSpeaking",[new l.PublisherSpeakingEvent(e.streamManager,"publisherStopSpeaking",e.connection,e.streamId)]),e.harkStoppedSpeakingEnabledOnce=!1}))},e.prototype.enableOnceHarkStoppedSpeakingEvent=function(){var e=this;this.setHarkListenerIfNotExists(),!this.harkStoppedSpeakingEnabledOnce&&this.speechEvent&&(this.harkStoppedSpeakingEnabledOnce=!0,this.speechEvent.once("stopped_speaking",function(){e.harkStoppedSpeakingEnabledOnce&&(e.session.emitEvent("publisherStopSpeaking",[new l.PublisherSpeakingEvent(e.session,"publisherStopSpeaking",e.connection,e.streamId)]),e.streamManager.emitEvent("publisherStopSpeaking",[new l.PublisherSpeakingEvent(e.streamManager,"publisherStopSpeaking",e.connection,e.streamId)])),e.disableHarkStoppedSpeakingEvent(!0)}))},e.prototype.disableHarkStoppedSpeakingEvent=function(e){if(this.speechEvent){if(this.harkStoppedSpeakingEnabledOnce=!1,e){if(this.harkStoppedSpeakingEnabled)return}else this.harkStoppedSpeakingEnabled=!1;this.harkVolumeChangeEnabled||this.harkVolumeChangeEnabledOnce||this.harkSpeakingEnabled||this.harkSpeakingEnabledOnce?this.speechEvent.off("stopped_speaking"):(this.speechEvent.stop(),delete this.speechEvent)}},e.prototype.enableHarkVolumeChangeEvent=function(e){var t=this;this.setHarkListenerIfNotExists()?(!this.harkVolumeChangeEnabled||e)&&(this.harkVolumeChangeEnabled=!0,this.speechEvent.on("volume_change",function(e){var n=t.speechEvent.oldVolumeValue;t.speechEvent.oldVolumeValue=e,t.streamManager.emitEvent("streamAudioVolumeChange",[new p.StreamManagerEvent(t.streamManager,"streamAudioVolumeChange",{newValue:e,oldValue:n})])})):this.harkVolumeChangeEnabled=!0},e.prototype.enableOnceHarkVolumeChangeEvent=function(e){var t=this;this.setHarkListenerIfNotExists()?(!this.harkVolumeChangeEnabledOnce||e)&&(this.harkVolumeChangeEnabledOnce=!0,this.speechEvent.once("volume_change",function(e){var n=t.speechEvent.oldVolumeValue;t.speechEvent.oldVolumeValue=e,t.disableHarkVolumeChangeEvent(!0),t.streamManager.emitEvent("streamAudioVolumeChange",[new p.StreamManagerEvent(t.streamManager,"streamAudioVolumeChange",{newValue:e,oldValue:n})])})):this.harkVolumeChangeEnabledOnce=!0},e.prototype.disableHarkVolumeChangeEvent=function(e){if(this.speechEvent){if(this.harkVolumeChangeEnabledOnce=!1,e){if(this.harkVolumeChangeEnabled)return}else this.harkVolumeChangeEnabled=!1;this.harkSpeakingEnabled||this.harkSpeakingEnabledOnce||this.harkStoppedSpeakingEnabled||this.harkStoppedSpeakingEnabledOnce?this.speechEvent.off("volume_change"):(this.speechEvent.stop(),delete this.speechEvent)}},e.prototype.isLocal=function(){return!this.inboundStreamOpts&&!!this.outboundStreamOpts},e.prototype.getSelectedIceCandidate=function(){var e=this;return new Promise(function(t,n){e.webRtcStats.getSelectedIceCandidateInfo().then(function(e){return t(e)}).catch(function(e){return n(e)})})},e.prototype.getRemoteIceCandidateList=function(){return this.webRtcPeer.remoteCandidatesQueue},e.prototype.getLocalIceCandidateList=function(){return this.webRtcPeer.localCandidatesQueue},e.prototype.streamIceConnectionStateBroken=function(){if(!this.getWebRtcPeer()||!this.getRTCPeerConnection())return!1;if(this.isLocal()&&this.session.openvidu.advancedConfiguration.forceMediaReconnectionAfterNetworkDrop)return S.warn('OpenVidu Browser advanced configuration option "forceMediaReconnectionAfterNetworkDrop" is enabled. Stream '.concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") will force a reconnection")),!0;var e=this.getRTCPeerConnection().iceConnectionState;return"connected"!==e&&"completed"!==e},e.prototype.setHarkListenerIfNotExists=function(){if(this.mediaStream){if(!this.speechEvent){var e=this.harkOptions?this.harkOptions:this.session.openvidu.advancedConfiguration.publisherSpeakingEventsOptions||{};e.interval="number"==typeof e.interval?e.interval:100,e.threshold="number"==typeof e.threshold?e.threshold:-50,this.speechEvent=E(this.mediaStream,e)}return!0}return!1},e.prototype.setupReconnectionEventEmitter=function(e,t){return void 0==this.reconnectionEventEmitter?(this.reconnectionEventEmitter=new y,!1):(console.warn("Trying to reconnect stream ".concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") but an ongoing reconnection process is active. Waiting for response...")),this.reconnectionEventEmitter.once("success",function(){return e()}),this.reconnectionEventEmitter.once("error",function(e){return t(e)}),!0)},e.prototype.initWebRtcPeerSend=function(e){var t=this;return new Promise(function(n,r){if(e){if(t.setupReconnectionEventEmitter(n,r))return}else t.initHarkEvents();var i,o=function(){var r;return e&&(null===(r=t.reconnectionEventEmitter)||void 0===r||r.emitEvent("success"),delete t.reconnectionEventEmitter),n()},s=function(n){var i;return e&&(null===(i=t.reconnectionEventEmitter)||void 0===i||i.emitEvent("error",[n]),delete t.reconnectionEventEmitter),r(n)},a=function(n){S.debug("Sending SDP offer to publish as "+t.streamId,n);var r,i=e?"reconnectStream":"publishVideo";if(e)r={stream:t.streamId,sdpString:n};else{var a=void 0;t.isSendVideo()&&(a="undefined"!=typeof MediaStreamTrack&&t.outboundStreamOpts.publisherProperties.videoSource instanceof MediaStreamTrack?m.TypeOfVideo.CUSTOM:t.isSendScreen()?m.TypeOfVideo.SCREEN:m.TypeOfVideo.CAMERA),r={doLoopback:t.displayMyRemote()||!1,hasAudio:t.isSendAudio(),hasVideo:t.isSendVideo(),audioActive:t.audioActive,videoActive:t.videoActive,typeOfVideo:a,frameRate:t.frameRate?t.frameRate:-1,videoDimensions:JSON.stringify(t.videoDimensions),filter:t.outboundStreamOpts.publisherProperties.filter,sdpOffer:n}}t.session.openvidu.sendRequest(i,r,function(n,r){n?401===n.code?s(new f.OpenViduError(f.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to publish")):s("Error on publishVideo: "+JSON.stringify(n)):t.webRtcPeer.processRemoteAnswer(r.sdpAnswer).then(function(){t.streamId=r.id,t.creationTime=r.createdAt,t.isLocalStreamPublished=!0,t.publishedOnce=!0,t.displayMyRemote()&&(t.localMediaStreamWhenSubscribedToRemote=t.mediaStream,t.remotePeerSuccessfullyEstablished(e)),e?t.ee.emitEvent("stream-reconnected-by-publisher",[]):t.ee.emitEvent("stream-created-by-publisher",[]),t.initWebRtcStats(),S.info("'Publisher' ("+t.streamId+") successfully "+(e?"reconnected":"published")+" to session"),o()}).catch(function(e){s(e)})})},u={mediaConstraints:{audio:t.hasAudio,video:t.hasVideo},simulcast:null!==(i=t.outboundStreamOpts.publisherProperties.videoSimulcast)&&void 0!==i?i:t.session.openvidu.videoSimulcast,onIceCandidate:t.connection.sendIceCandidate.bind(t.connection),onIceConnectionStateException:t.onIceConnectionStateExceptionHandler.bind(t),iceServers:t.getIceServersConf(),mediaStream:t.mediaStream,mediaServer:t.session.openvidu.mediaServer,typeOfVideo:t.typeOfVideo?m.TypeOfVideo[t.typeOfVideo]:void 0};"mediasoup"!==t.session.openvidu.mediaServer&&(u.simulcast=!1),e&&t.disposeWebRtcPeer(),t.displayMyRemote()?t.webRtcPeer=new c.WebRtcPeerSendrecv(u):t.webRtcPeer=new c.WebRtcPeerSendonly(u),t.webRtcPeer.addIceConnectionStateChangeListener("publisher of "+t.connection.connectionId),t.webRtcPeer.createOffer().then(function(e){t.webRtcPeer.processLocalOffer(e).then(function(){a(e.sdp)}).catch(function(e){s(Error("(publish) SDP process local offer error: "+JSON.stringify(e)))})}).catch(function(e){s(Error("(publish) SDP create offer error: "+JSON.stringify(e)))})})},e.prototype.finalResolveForSubscription=function(e,t){var n;return S.info("'Subscriber' ("+this.streamId+") successfully "+(e?"reconnected":"subscribed")),this.remotePeerSuccessfullyEstablished(e),this.initWebRtcStats(),e&&(null===(n=this.reconnectionEventEmitter)||void 0===n||n.emitEvent("success"),delete this.reconnectionEventEmitter),t()},e.prototype.finalRejectForSubscription=function(e,t,n){var r;return S.error("Error for 'Subscriber' ("+this.streamId+") while trying to "+(e?"reconnect":"subscribe")+": "+t.toString()),e&&(null===(r=this.reconnectionEventEmitter)||void 0===r||r.emitEvent("error",[t]),delete this.reconnectionEventEmitter),n(t)},e.prototype.initWebRtcPeerReceive=function(e){var t=this;return new Promise(function(n,r){e&&t.setupReconnectionEventEmitter(n,r)||("mediasoup"===t.session.openvidu.mediaServer?t.initWebRtcPeerReceiveFromServer(e).then(function(){return t.finalResolveForSubscription(e,n)}).catch(function(n){return t.finalRejectForSubscription(e,n,r)}):t.initWebRtcPeerReceiveFromClient(e).then(function(){return t.finalResolveForSubscription(e,n)}).catch(function(n){return t.finalRejectForSubscription(e,n,r)}))})},e.prototype.initWebRtcPeerReceiveFromClient=function(e){var t=this;return new Promise(function(n,r){t.completeWebRtcPeerReceive(e,!1).then(function(e){t.webRtcPeer.processRemoteAnswer(e.sdpAnswer).then(function(){return n()}).catch(function(e){return r(e)})}).catch(function(e){return r(e)})})},e.prototype.initWebRtcPeerReceiveFromServer=function(e){var t=this;return new Promise(function(n,r){t.session.openvidu.sendRequest("prepareReceiveVideoFrom",{sender:t.streamId,reconnect:e},function(i,o){if(i)return r(Error("Error on prepareReceiveVideoFrom: "+JSON.stringify(i)));t.completeWebRtcPeerReceive(e,!1,o.sdpOffer).then(function(){return n()}).catch(function(e){return r(e)})})})},e.prototype.completeWebRtcPeerReceive=function(e,t,n){var r=this;return new Promise(function(i,o){S.debug("'Session.subscribe(Stream)' called");var s=function(s){S.debug("Sending local SDP ".concat(n?"answer":"offer"," to subscribe to ").concat(r.streamId),s);var a=e?"reconnectStream":"receiveVideoFrom",c={};c[e?"stream":"sender"]=r.streamId,n?c[e?"sdpString":"sdpAnswer"]=s:c.sdpOffer=s,e&&(c.forciblyReconnect=t),r.session.openvidu.sendRequest(a,c,function(e,t){return e?o(Error("Error on "+a+" : "+JSON.stringify(e))):i(t)})},a={mediaConstraints:{audio:r.hasAudio,video:r.hasVideo},simulcast:!1,onIceCandidate:r.connection.sendIceCandidate.bind(r.connection),onIceConnectionStateException:r.onIceConnectionStateExceptionHandler.bind(r),iceServers:r.getIceServersConf(),mediaServer:r.session.openvidu.mediaServer,typeOfVideo:r.typeOfVideo?m.TypeOfVideo[r.typeOfVideo]:void 0};e&&r.disposeWebRtcPeer(),r.webRtcPeer=new c.WebRtcPeerRecvonly(a),r.webRtcPeer.addIceConnectionStateChangeListener(r.streamId),n?r.webRtcPeer.processRemoteOffer(n).then(function(){r.webRtcPeer.createAnswer().then(function(e){r.webRtcPeer.processLocalAnswer(e).then(function(){s(e.sdp)}).catch(function(e){return o(Error("(subscribe) SDP process local answer error: "+JSON.stringify(e)))})}).catch(function(e){return o(Error("(subscribe) SDP create answer error: "+JSON.stringify(e)))})}).catch(function(e){return o(Error("(subscribe) SDP process remote offer error: "+JSON.stringify(e)))}):r.webRtcPeer.createOffer().then(function(e){r.webRtcPeer.processLocalOffer(e).then(function(){s(e.sdp)}).catch(function(e){return o(Error("(subscribe) SDP process local offer error: "+JSON.stringify(e)))})}).catch(function(e){return o(Error("(subscribe) SDP create offer error: "+JSON.stringify(e)))})})},e.prototype.remotePeerSuccessfullyEstablished=function(e){e&&null!=this.mediaStream&&this.disposeMediaStream(),this.mediaStream=new MediaStream;for(var t,n=0,r=this.webRtcPeer.pc.getReceivers();n<r.length;n++)(t=r[n]).track&&this.mediaStream.addTrack(t.track);if(S.debug("Peer remote stream",this.mediaStream),this.mediaStream){if(this.streamManager instanceof a.Subscriber){if(this.mediaStream.getAudioTracks()[0]){var i=e?this.audioActive:!!this.streamManager.properties.subscribeToAudio;this.mediaStream.getAudioTracks()[0].enabled=i}if(this.mediaStream.getVideoTracks()[0]){var i=e?this.videoActive:!!this.videoActive&&!!this.streamManager.properties.subscribeToVideo;this.mediaStream.getVideoTracks()[0].enabled=i}}this.updateMediaStreamInVideos(),this.initHarkEvents()}},e.prototype.initHarkEvents=function(){this.mediaStream.getAudioTracks()[0]&&(this.session.anySpeechEventListenerEnabled("publisherStartSpeaking",!0,this.streamManager)&&this.enableOnceHarkSpeakingEvent(),this.session.anySpeechEventListenerEnabled("publisherStartSpeaking",!1,this.streamManager)&&this.enableHarkSpeakingEvent(),this.session.anySpeechEventListenerEnabled("publisherStopSpeaking",!0,this.streamManager)&&this.enableOnceHarkStoppedSpeakingEvent(),this.session.anySpeechEventListenerEnabled("publisherStopSpeaking",!1,this.streamManager)&&this.enableHarkStoppedSpeakingEvent(),this.harkVolumeChangeEnabledOnce&&this.enableOnceHarkVolumeChangeEvent(!0),this.harkVolumeChangeEnabled&&this.enableHarkVolumeChangeEvent(!0))},e.prototype.onIceConnectionStateExceptionHandler=function(e,t,n){switch(e){case d.ExceptionEventName.ICE_CONNECTION_FAILED:this.onIceConnectionFailed();break;case d.ExceptionEventName.ICE_CONNECTION_DISCONNECTED:this.onIceConnectionDisconnected()}this.session.emitEvent("exception",[new d.ExceptionEvent(this.session,e,this,t,n)])},e.prototype.onIceConnectionFailed=function(){S.log("[ICE_CONNECTION_FAILED] Handling ICE_CONNECTION_FAILED event. Reconnecting stream ".concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",")")),this.reconnectStreamAndLogResultingIceConnectionState(d.ExceptionEventName.ICE_CONNECTION_FAILED)},e.prototype.onIceConnectionDisconnected=function(){var e=this;S.log("[ICE_CONNECTION_DISCONNECTED] Handling ICE_CONNECTION_DISCONNECTED event. Waiting for ICE to be restored and reconnect stream ".concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") if not possible"));var t=this.session.openvidu.advancedConfiguration.iceConnectionDisconnectedExceptionTimeout||4e3;this.awaitWebRtcPeerConnectionState(t).then(function(n){switch(n){case"failed":S.warn("[ICE_CONNECTION_DISCONNECTED] ICE connection of stream ".concat(e.streamId," (").concat(e.isLocal()?"Publisher":"Subscriber",") is now failed after ICE_CONNECTION_DISCONNECTED"));break;case"connected":case"completed":S.log("[ICE_CONNECTION_DISCONNECTED] ICE connection of stream ".concat(e.streamId," (").concat(e.isLocal()?"Publisher":"Subscriber",") automatically restored after ICE_CONNECTION_DISCONNECTED. Current ICE connection state: ").concat(n));break;case"closed":case"checking":case"new":case"disconnected":S.warn("[ICE_CONNECTION_DISCONNECTED] ICE connection of stream ".concat(e.streamId," (").concat(e.isLocal()?"Publisher":"Subscriber",") couldn't be restored after ICE_CONNECTION_DISCONNECTED event. Current ICE connection state after ").concat(t," ms: ").concat(n)),e.reconnectStreamAndLogResultingIceConnectionState(d.ExceptionEventName.ICE_CONNECTION_DISCONNECTED)}})},e.prototype.reconnectStreamAndLogResultingIceConnectionState=function(e){return i(this,void 0,void 0,function(){var t,n;return o(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.reconnectStreamAndReturnIceConnectionState(e)];case 1:switch(t=r.sent()){case"connected":case"completed":S.log("[".concat(e,"] Stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") successfully reconnected after ").concat(e,". Current ICE connection state: ").concat(t));break;default:S.error("[".concat(e,"] Stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") failed to reconnect after ").concat(e,". Current ICE connection state: ").concat(t))}return[3,3];case 2:return n=r.sent(),S.error("[".concat(e,"] Error reconnecting stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") after ").concat(e,": ").concat(n)),[3,3];case 3:return[2]}})})},e.prototype.reconnectStreamAndReturnIceConnectionState=function(e){return i(this,void 0,void 0,function(){var t,n;return o(this,function(r){switch(r.label){case 0:S.log("[".concat(e,"] Reconnecting stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") after event ").concat(e)),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.reconnectStream(e)];case 2:return r.sent(),t=this.session.openvidu.advancedConfiguration.iceConnectionDisconnectedExceptionTimeout||4e3,[2,this.awaitWebRtcPeerConnectionState(t)];case 3:return n=r.sent(),S.warn("[".concat(e,"] Error reconnecting stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber","). Reason: ").concat(n)),[2,this.awaitWebRtcPeerConnectionState(1)];case 4:return[2]}})})},e.prototype.awaitWebRtcPeerConnectionState=function(e){return i(this,void 0,void 0,function(){var t,n,r,i;return o(this,function(o){switch(o.label){case 0:t=this.getRTCPeerConnection().iceConnectionState,r=Math.ceil(e/(n=150)),i=0,o.label=1;case 1:if(!(i<r)||"connected"===(t=this.getRTCPeerConnection().iceConnectionState)||"completed"===t)return[3,4];return[4,new Promise(function(e){return setTimeout(e,n)})];case 2:o.sent(),o.label=3;case 3:return i++,[3,1];case 4:return[2,t]}})})},e.prototype.reconnectStream=function(e){return i(this,void 0,void 0,function(){var t;return o(this,function(n){switch(n.label){case 0:return[4,this.isWebsocketConnected(e,3e3)];case 1:if(n.sent()){if(S.log("[".concat(e,"] Trying to reconnect stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") and the websocket is opened")),this.isLocal())return[2,this.initWebRtcPeerSend(!0)];return[2,this.initWebRtcPeerReceive(!0)]}throw t="[".concat(e,"] Trying to reconnect stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") but the websocket wasn't opened"),S.error(t),Error(t)}})})},e.prototype.isWebsocketConnected=function(e,t){var n=this;return new Promise(function(r,i){var o=n.session.openvidu.getWsReadyState();if(1!==o)return console.warn("[".concat(e,"] Websocket readyState is ").concat(o)),r(!1);var s=setTimeout(function(){return console.warn("[".concat(e,"] Websocket timeout of ").concat(t,"ms")),r(!1)},t);n.session.openvidu.sendRequest("echo",{},function(t,n){return(clearTimeout(s),t)?(console.warn("[".concat(e,"] Websocket 'echo' returned error: ").concat(t)),r(!1)):r(!0)})})},e.prototype.initWebRtcStats=function(){this.webRtcStats=new u.WebRtcStats(this),this.webRtcStats.initWebRtcStats()},e.prototype.stopWebRtcStats=function(){this.webRtcStats&&this.webRtcStats.isEnabled()&&this.webRtcStats.stopWebRtcStats()},e.prototype.getIceServersConf=function(){return this.session.openvidu.advancedConfiguration.iceServers?"freeice"===this.session.openvidu.advancedConfiguration.iceServers?void 0:this.session.openvidu.advancedConfiguration.iceServers:this.session.openvidu.iceServers?this.session.openvidu.iceServers:void 0},e.prototype.gatherStatsForPeer=function(){var e=this;return new Promise(function(t,n){e.isLocal()?e.getRTCPeerConnection().getSenders().forEach(function(t){return t.getStats().then(function(t){t.forEach(function(t){if(e.isReportWanted(t)){var n={};n.type=t.type,n.timestamp=t.timestamp,n.id=t.id,"outbound-rtp"===t.type&&(n.ssrc=t.ssrc,n.firCount=t.firCount,n.pliCount=t.pliCount,n.nackCount=t.nackCount,n.qpSum=t.qpSum,t.kind?n.mediaType=t.kind:t.mediaType?n.mediaType=t.mediaType:n.mediaType=-1!==t.id.indexOf("VideoStream")?"video":"audio","video"===n.mediaType&&(n.framesEncoded=t.framesEncoded),n.packetsSent=t.packetsSent,n.bytesSent=t.bytesSent),"candidate-pair"===t.type&&void 0!==t.totalRoundTripTime&&(n.availableOutgoingBitrate=t.availableOutgoingBitrate,n.rtt=t.currentRoundTripTime,n.averageRtt=t.totalRoundTripTime/t.responsesReceived),"remote-inbound-rtp"===t.type||t.type,S.log(n)}})})}):e.getRTCPeerConnection().getReceivers().forEach(function(t){return t.getStats().then(function(t){t.forEach(function(t){if(e.isReportWanted(t)){var n={};n.type=t.type,n.timestamp=t.timestamp,n.id=t.id,"inbound-rtp"===t.type&&(n.ssrc=t.ssrc,n.firCount=t.firCount,n.pliCount=t.pliCount,n.nackCount=t.nackCount,n.qpSum=t.qpSum,t.kind?n.mediaType=t.kind:t.mediaType?n.mediaType=t.mediaType:n.mediaType=-1!==t.id.indexOf("VideoStream")?"video":"audio","video"===n.mediaType&&(n.framesDecoded=t.framesDecoded),n.packetsReceived=t.packetsReceived,n.packetsLost=t.packetsLost,n.jitter=t.jitter,n.bytesReceived=t.bytesReceived),"candidate-pair"===t.type&&void 0!==t.totalRoundTripTime&&(n.availableIncomingBitrate=t.availableIncomingBitrate,n.rtt=t.currentRoundTripTime,n.averageRtt=t.totalRoundTripTime/t.responsesReceived),"remote-inbound-rtp"===t.type||t.type,S.log(n)}})})})})},e.prototype.isReportWanted=function(e){return"inbound-rtp"===e.type&&!this.isLocal()||"outbound-rtp"===e.type&&this.isLocal()||"candidate-pair"===e.type&&e.nominated&&e.bytesSent>0},e}();t.Stream=w},2028:function(e,t,n){"use strict";var r,i,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.StreamManager=void 0;var s=n(3013),a=n(3977),c=n(6367),u=n(6056),d=n(4270),l=n(5364),p=n(5971),h=l.OpenViduLogger.getInstance(),f=function(e){function t(t,n){var r=e.call(this)||this;if(r.videos=[],r.lazyLaunchVideoElementCreatedEvent=!1,i=p.PlatformUtils.getInstance(),r.stream=t,r.stream.streamManager=r,r.remote=!r.stream.isLocal(),n){var o=void 0;"string"==typeof n?o=document.getElementById(n):n instanceof HTMLElement&&(o=n),o&&(r.firstVideoElement={targetElement:o,video:document.createElement("video"),id:"",canplayListenerAdded:!1},(i.isSafariBrowser()||i.isIPhoneOrIPad()&&(i.isChromeMobileBrowser()||i.isEdgeMobileBrowser()||i.isOperaMobileBrowser()||i.isFirefoxMobileBrowser()))&&(r.firstVideoElement.video.playsInline=!0),r.targetElement=o,r.element=o)}return r.canPlayListener=function(){r.deactivateStreamPlayingEventExceptionTimeout(),r.ee.emitEvent("streamPlaying",[new a.StreamManagerEvent(r,"streamPlaying",void 0)])},r}return o(t,e),t.prototype.on=function(t,n){return e.prototype.onAux.call(this,t,"Event '"+t+"' triggered by '"+(this.remote?"Subscriber":"Publisher")+"'",n),"videoElementCreated"===t&&this.stream&&this.lazyLaunchVideoElementCreatedEvent&&(this.ee.emitEvent("videoElementCreated",[new c.VideoElementEvent(this.videos[0].video,this,"videoElementCreated")]),this.lazyLaunchVideoElementCreatedEvent=!1),"streamPlaying"===t&&this.videos[0]&&this.videos[0].video&&this.videos[0].video.currentTime>0&&!1===this.videos[0].video.paused&&!1===this.videos[0].video.ended&&4===this.videos[0].video.readyState&&this.ee.emitEvent("streamPlaying",[new a.StreamManagerEvent(this,"streamPlaying",void 0)]),this.stream.hasAudio&&("publisherStartSpeaking"===t&&this.stream.enableHarkSpeakingEvent(),"publisherStopSpeaking"===t&&this.stream.enableHarkStoppedSpeakingEvent(),"streamAudioVolumeChange"===t&&this.stream.enableHarkVolumeChangeEvent(!1)),this},t.prototype.once=function(t,n){return e.prototype.onceAux.call(this,t,"Event '"+t+"' triggered once by '"+(this.remote?"Subscriber":"Publisher")+"'",n),"videoElementCreated"===t&&this.stream&&this.lazyLaunchVideoElementCreatedEvent&&this.ee.emitEvent("videoElementCreated",[new c.VideoElementEvent(this.videos[0].video,this,"videoElementCreated")]),"streamPlaying"===t&&this.videos[0]&&this.videos[0].video&&this.videos[0].video.currentTime>0&&!1===this.videos[0].video.paused&&!1===this.videos[0].video.ended&&4===this.videos[0].video.readyState&&this.ee.emitEvent("streamPlaying",[new a.StreamManagerEvent(this,"streamPlaying",void 0)]),this.stream.hasAudio&&("publisherStartSpeaking"===t&&this.stream.enableOnceHarkSpeakingEvent(),"publisherStopSpeaking"===t&&this.stream.enableOnceHarkStoppedSpeakingEvent(),"streamAudioVolumeChange"===t&&this.stream.enableOnceHarkVolumeChangeEvent(!1)),this},t.prototype.off=function(t,n){return e.prototype.offAux.call(this,t,n),"publisherStartSpeaking"===t&&0===this.ee.getListeners(t).length+this.stream.session.ee.getListeners(t).length&&this.stream.disableHarkSpeakingEvent(!1),"publisherStopSpeaking"===t&&0===this.ee.getListeners(t).length+this.stream.session.ee.getListeners(t).length&&this.stream.disableHarkStoppedSpeakingEvent(!1),"streamAudioVolumeChange"===t&&0===this.ee.getListeners(t).length&&this.stream.disableHarkVolumeChangeEvent(!1),this},t.prototype.addVideoElement=function(e){this.initializeVideoProperties(e),!this.remote&&this.stream.displayMyRemote()&&e.srcObject!==this.stream.getMediaStream()&&(e.srcObject=this.stream.getMediaStream());for(var t=0,n=this.videos;t<n.length;t++)if(n[t].video===e)return 0;for(var r=1,i=0,o=this.stream.session.streamManagers;i<o.length;i++)if(o[i].disassociateVideo(e)){r=-1;break}return this.stream.session.streamManagers.forEach(function(t){t.disassociateVideo(e)}),this.pushNewStreamManagerVideo({video:e,id:e.id,canplayListenerAdded:!1}),h.info("New video element associated to ",this),r},t.prototype.createVideoElement=function(e,t){if("string"==typeof e){if(!(n=document.getElementById(e)))throw Error("The provided 'targetElement' couldn't be resolved to any HTML element: "+e)}else if(e instanceof HTMLElement)n=e;else throw Error("The provided 'targetElement' couldn't be resolved to any HTML element: "+e);var n,r=this.createVideo();this.initializeVideoProperties(r);var i=t||d.VideoInsertMode.APPEND;switch(i){case d.VideoInsertMode.AFTER:n.parentNode.insertBefore(r,n.nextSibling);break;case d.VideoInsertMode.APPEND:n.appendChild(r);break;case d.VideoInsertMode.BEFORE:n.parentNode.insertBefore(r,n);break;case d.VideoInsertMode.PREPEND:n.insertBefore(r,n.childNodes[0]);break;case d.VideoInsertMode.REPLACE:n.parentNode.replaceChild(r,n);break;default:i=d.VideoInsertMode.APPEND,n.appendChild(r)}var o={targetElement:n,video:r,insertMode:i,id:r.id,canplayListenerAdded:!1};return this.pushNewStreamManagerVideo(o),this.ee.emitEvent("videoElementCreated",[new c.VideoElementEvent(o.video,this,"videoElementCreated")]),this.lazyLaunchVideoElementCreatedEvent=!!this.firstVideoElement,r},t.prototype.updatePublisherSpeakingEventsOptions=function(e){var t=this.stream.harkOptions?this.stream.harkOptions:this.stream.session.openvidu.advancedConfiguration.publisherSpeakingEventsOptions||{},n="number"==typeof e.interval?e.interval:"number"==typeof t.interval?t.interval:100,r="number"==typeof e.threshold?e.threshold:"number"==typeof t.threshold?t.threshold:-50;this.stream.harkOptions={interval:n,threshold:r},this.stream.speechEvent&&(this.stream.speechEvent.setInterval(n),this.stream.speechEvent.setThreshold(r))},t.prototype.initializeVideoProperties=function(e){!this.remote&&this.stream.displayMyRemote()||e.srcObject===this.stream.getMediaStream()||(e.srcObject=this.stream.getMediaStream()),e.autoplay=!0,e.controls=!1,(i.isSafariBrowser()||i.isIPhoneOrIPad()&&(i.isChromeMobileBrowser()||i.isEdgeMobileBrowser()||i.isOperaMobileBrowser()||i.isFirefoxMobileBrowser()))&&(e.playsInline=!0),e.id||(e.id=(this.remote?"remote-":"local-")+"video-"+this.stream.streamId,this.id||!this.targetElement||(this.id=e.id)),this.remote&&this.isMirroredVideo(e)?this.removeMirrorVideo(e):this.remote||this.stream.displayMyRemote()||(e.muted=!0,this.isMirroredVideo(e)&&!this.stream.outboundStreamOpts.publisherProperties.mirror?this.removeMirrorVideo(e):this.stream.outboundStreamOpts.publisherProperties.mirror&&!this.stream.isSendScreen()&&this.mirrorVideo(e))},t.prototype.removeAllVideos=function(){for(var e=this,t=this.stream.session.streamManagers.length-1;t>=0;--t)this.stream.session.streamManagers[t]===this&&this.stream.session.streamManagers.splice(t,1);this.videos.forEach(function(t){t.video&&t.video.removeEventListener&&t.video.removeEventListener("canplay",e.canPlayListener),t.canplayListenerAdded=!1,t.targetElement&&(t.video.parentNode.removeChild(t.video),e.ee.emitEvent("videoElementDestroyed",[new c.VideoElementEvent(t.video,e,"videoElementDestroyed")])),e.removeSrcObject(t),e.videos.filter(function(e){return!e.targetElement})})},t.prototype.disassociateVideo=function(e){for(var t=!1,n=0;n<this.videos.length;n++)if(this.videos[n].video===e){this.videos[n].video.removeEventListener("canplay",this.canPlayListener),this.videos.splice(n,1),t=!0,h.info("Video element disassociated from ",this);break}return t},t.prototype.addPlayEventToFirstVideo=function(){this.videos[0]&&this.videos[0].video&&!this.videos[0].canplayListenerAdded&&(this.activateStreamPlayingEventExceptionTimeout(),this.videos[0].video.addEventListener("canplay",this.canPlayListener),this.videos[0].canplayListenerAdded=!0)},t.prototype.updateMediaStream=function(e){this.videos.forEach(function(t){if(t.video.srcObject=e,i.isIonicIos()){var n=t.video.parentElement,r=t.video;n.replaceChild(r,t.video),t.video=r}})},t.prototype.emitEvent=function(e,t){this.ee.emitEvent(e,t)},t.prototype.createVideo=function(){return document.createElement("video")},t.prototype.removeSrcObject=function(e){e.video.srcObject=null,this.deactivateStreamPlayingEventExceptionTimeout()},t.prototype.pushNewStreamManagerVideo=function(e){this.videos.push(e),this.addPlayEventToFirstVideo(),-1===this.stream.session.streamManagers.indexOf(this)&&this.stream.session.streamManagers.push(this)},t.prototype.mirrorVideo=function(e){i.isIonicIos()||(e.style.transform="rotateY(180deg)",e.style.webkitTransform="rotateY(180deg)")},t.prototype.removeMirrorVideo=function(e){e.style.transform="unset",e.style.webkitTransform="unset"},t.prototype.isMirroredVideo=function(e){return"rotateY(180deg)"===e.style.transform||"rotateY(180deg)"===e.style.webkitTransform},t.prototype.activateStreamPlayingEventExceptionTimeout=function(){var e=this;if(this.remote&&null==this.streamPlayingEventExceptionTimeout){var t=this.stream.session.openvidu.advancedConfiguration.noStreamPlayingEventExceptionTimeout||4e3;this.streamPlayingEventExceptionTimeout=setTimeout(function(){var n="StreamManager of Stream "+e.stream.streamId+" ("+(e.remote?"Subscriber":"Publisher")+') did not trigger "streamPlaying" event in '+t+" ms";h.warn(n),e.stream.session.emitEvent("exception",[new u.ExceptionEvent(e.stream.session,u.ExceptionEventName.NO_STREAM_PLAYING_EVENT,e,n)]),delete e.streamPlayingEventExceptionTimeout},t)}},t.prototype.deactivateStreamPlayingEventExceptionTimeout=function(){clearTimeout(this.streamPlayingEventExceptionTimeout),delete this.streamPlayingEventExceptionTimeout},t}(s.EventDispatcher);t.StreamManager=f},4980:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Subscriber=void 0;var o=n(2028),s=n(5364).OpenViduLogger.getInstance(),a=function(e){function t(t,n,r){var i=e.call(this,t,n)||this;return i.element=i.targetElement,i.stream=t,i.properties=r,i}return i(t,e),t.prototype.subscribeToAudio=function(e){return this.stream.getMediaStream().getAudioTracks().forEach(function(t){t.enabled=e}),this.stream.audioActive=e,s.info("'Subscriber' has "+(e?"subscribed to":"unsubscribed from")+" its audio stream"),this},t.prototype.subscribeToVideo=function(e){return this.stream.getMediaStream().getVideoTracks().forEach(function(t){t.enabled=e}),this.stream.videoActive=e,s.info("'Subscriber' has "+(e?"subscribed to":"unsubscribed from")+" its video stream"),this},t.prototype.replaceTrackInMediaStream=function(e,t){var n,r=this.stream.getMediaStream();"video"===e.kind?(n=r.getVideoTracks()[0],t&&(this.stream.lastVideoTrackConstraints=e.getConstraints())):n=r.getAudioTracks()[0],r.removeTrack(n),n.stop(),r.addTrack(e)},t}(o.StreamManager);t.Subscriber=a},9690:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.LocalRecorderState=void 0,(n=t.LocalRecorderState||(t.LocalRecorderState={})).READY="READY",n.RECORDING="RECORDING",n.PAUSED="PAUSED",n.FINISHED="FINISHED"},7009:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.OpenViduError=t.OpenViduErrorName=void 0,(n=t.OpenViduErrorName||(t.OpenViduErrorName={})).BROWSER_NOT_SUPPORTED="BROWSER_NOT_SUPPORTED",n.DEVICE_ACCESS_DENIED="DEVICE_ACCESS_DENIED",n.DEVICE_ALREADY_IN_USE="DEVICE_ALREADY_IN_USE",n.SCREEN_CAPTURE_DENIED="SCREEN_CAPTURE_DENIED",n.SCREEN_SHARING_NOT_SUPPORTED="SCREEN_SHARING_NOT_SUPPORTED",n.SCREEN_EXTENSION_NOT_INSTALLED="SCREEN_EXTENSION_NOT_INSTALLED",n.SCREEN_EXTENSION_DISABLED="SCREEN_EXTENSION_DISABLED",n.INPUT_VIDEO_DEVICE_NOT_FOUND="INPUT_VIDEO_DEVICE_NOT_FOUND",n.INPUT_AUDIO_DEVICE_NOT_FOUND="INPUT_AUDIO_DEVICE_NOT_FOUND",n.INPUT_AUDIO_DEVICE_GENERIC_ERROR="INPUT_AUDIO_DEVICE_GENERIC_ERROR",n.NO_INPUT_SOURCE_SET="NO_INPUT_SOURCE_SET",n.PUBLISHER_PROPERTIES_ERROR="PUBLISHER_PROPERTIES_ERROR",n.OPENVIDU_PERMISSION_DENIED="OPENVIDU_PERMISSION_DENIED",n.OPENVIDU_NOT_CONNECTED="OPENVIDU_NOT_CONNECTED",n.VIRTUAL_BACKGROUND_ERROR="VIRTUAL_BACKGROUND_ERROR",n.GENERIC_ERROR="GENERIC_ERROR",t.OpenViduError=function(e,t){this.name=e,this.message=t}},1513:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.TypeOfVideo=void 0,(n=t.TypeOfVideo||(t.TypeOfVideo={})).CAMERA="CAMERA",n.SCREEN="SCREEN",n.CUSTOM="CUSTOM",n.IPCAM="IPCAM"},4270:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.VideoInsertMode=void 0,(n=t.VideoInsertMode||(t.VideoInsertMode={})).AFTER="AFTER",n.APPEND="APPEND",n.BEFORE="BEFORE",n.PREPEND="PREPEND",n.REPLACE="REPLACE"},5223:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionEvent=void 0;var o=function(e){function t(t,n,r,i,o){var s=e.call(this,t,n,r)||this;return s.connection=i,s.reason=o,s}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(6300).Event);t.ConnectionEvent=o},6203:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionPropertyChangedEvent=void 0;var o=function(e){function t(t,n,r,i,o){var s=e.call(this,!1,t,"connectionPropertyChanged")||this;return s.connection=n,s.changedProperty=r,s.newValue=i,s.oldValue=o,s}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(6300).Event);t.ConnectionPropertyChangedEvent=o},6300:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Event=void 0;var n=function(){function e(e,t,n){this.hasBeenPrevented=!1,this.cancelable=e,this.target=t,this.type=n}return e.prototype.isDefaultPrevented=function(){return this.hasBeenPrevented},e.prototype.preventDefault=function(){this.callDefaultBehavior=function(){},this.hasBeenPrevented=!0},e}();t.Event=n},6056:function(e,t,n){"use strict";var r,i,o=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.ExceptionEvent=t.ExceptionEventName=void 0;var s=n(6300);(r=t.ExceptionEventName||(t.ExceptionEventName={})).ICE_CANDIDATE_ERROR="ICE_CANDIDATE_ERROR",r.ICE_CONNECTION_FAILED="ICE_CONNECTION_FAILED",r.ICE_CONNECTION_DISCONNECTED="ICE_CONNECTION_DISCONNECTED",r.NO_STREAM_PLAYING_EVENT="NO_STREAM_PLAYING_EVENT",r.SPEECH_TO_TEXT_DISCONNECTED="SPEECH_TO_TEXT_DISCONNECTED";var a=function(e){function t(t,n,r,i,o){var s=e.call(this,!1,t,"exception")||this;return s.name=n,s.origin=r,s.message=i,s.data=o,s}return o(t,e),t.prototype.callDefaultBehavior=function(){},t}(s.Event);t.ExceptionEvent=a},146:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.FilterEvent=void 0;var o=function(e){function t(t,n,r){var i=e.call(this,!1,t,n)||this;return i.data=r,i}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(6300).Event);t.FilterEvent=o},9233:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkQualityLevelChangedEvent=void 0;var o=function(e){function t(t,n,r,i){var o=e.call(this,!1,t,"networkQualityLevelChanged")||this;return o.newValue=n,o.oldValue=r,o.connection=i,o}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(6300).Event);t.NetworkQualityLevelChangedEvent=o},8271:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.PublisherSpeakingEvent=void 0;var o=function(e){function t(t,n,r,i){var o=e.call(this,!1,t,n)||this;return o.type=n,o.connection=r,o.streamId=i,o}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(6300).Event);t.PublisherSpeakingEvent=o},8856:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.RecordingEvent=void 0;var o=function(e){function t(t,n,r,i,o){var s=e.call(this,!1,t,n)||this;return s.id=r,i!==r&&(s.name=i),s.reason=o,s}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(6300).Event);t.RecordingEvent=o},3439:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.SessionDisconnectedEvent=void 0;var o=n(6300),s=n(5364).OpenViduLogger.getInstance(),a=function(e){function t(t,n){var r=e.call(this,!0,t,"sessionDisconnected")||this;return r.reason=n,r}return i(t,e),t.prototype.callDefaultBehavior=function(){s.info("Calling default behavior upon '"+this.type+"' event dispatched by 'Session'");var e=this.target;e.remoteConnections.forEach(function(t){var n,r,i,o,s,a,c,u,d=t.connectionId;if(null===(n=e.remoteConnections.get(d))||void 0===n?void 0:n.stream){null===(r=e.remoteConnections.get(d))||void 0===r||r.stream.disposeWebRtcPeer(),null===(i=e.remoteConnections.get(d))||void 0===i||i.stream.disposeMediaStream(),(null===(o=e.remoteConnections.get(d))||void 0===o?void 0:o.stream.streamManager)&&(null===(s=e.remoteConnections.get(d))||void 0===s||s.stream.streamManager.removeAllVideos());var l=null===(c=null===(a=e.remoteConnections.get(d))||void 0===a?void 0:a.stream)||void 0===c?void 0:c.streamId;l&&e.remoteStreamsCreated.delete(l),null===(u=e.remoteConnections.get(d))||void 0===u||u.dispose()}e.remoteConnections.delete(d)})},t}(o.Event);t.SessionDisconnectedEvent=a},3685:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.SignalEvent=void 0;var o=function(e){function t(t,n,r,i){var o=e.call(this,!1,t,"signal")||this;return n&&(o.type="signal:"+n),o.data=r,o.from=i,o}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(6300).Event);t.SignalEvent=o},1342:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.SpeechToTextEvent=void 0;var o=function(e){function t(t,n,r,i,o,s){var a=e.call(this,!1,t,"speechToTextMessage")||this;return a.connection=n,a.text=r,a.reason=i,a.raw=o,a.lang=s,a}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(6300).Event);t.SpeechToTextEvent=o},3590:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.StreamEvent=void 0;var o=n(6300),s=n(2917),a=n(7678),c=n(5364).OpenViduLogger.getInstance(),u=function(e){function t(t,n,r,i,o){var s=e.call(this,t,n,r)||this;return s.stream=i,s.reason=o,s}return i(t,e),t.prototype.callDefaultBehavior=function(){if("streamDestroyed"===this.type){if(this.target instanceof a.Session)c.info("Calling default behavior upon '"+this.type+"' event dispatched by 'Session'"),this.stream.disposeWebRtcPeer();else if(this.target instanceof s.Publisher){c.info("Calling default behavior upon '"+this.type+"' event dispatched by 'Publisher'"),clearInterval(this.target.screenShareResizeInterval),this.stream.isLocalStreamReadyToPublish=!1;for(var e=this.target.openvidu.publishers,t=0;t<e.length;t++)if(e[t]===this.target){e.splice(t,1);break}}this.stream.disposeMediaStream(),this.stream.streamManager&&this.stream.streamManager.removeAllVideos(),this.stream.session.remoteStreamsCreated.delete(this.stream.streamId);var n=this.stream.session.remoteConnections.get(this.stream.connection.connectionId);if(n&&n.remoteOptions)for(var r=n.remoteOptions.streams,t=r.length-1;t>=0;--t)r[t].id===this.stream.streamId&&r.splice(t,1)}},t}(o.Event);t.StreamEvent=u},3977:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.StreamManagerEvent=void 0;var o=function(e){function t(t,n,r){var i=e.call(this,!1,t,n)||this;return i.value=r,i}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(6300).Event);t.StreamManagerEvent=o},7614:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.StreamPropertyChangedEvent=void 0;var o=function(e){function t(t,n,r,i,o,s){var a=e.call(this,!1,t,"streamPropertyChanged")||this;return a.stream=n,a.changedProperty=r,a.newValue=i,a.oldValue=o,a.reason=s,a}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(6300).Event);t.StreamPropertyChangedEvent=o},6252:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},6367:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.VideoElementEvent=void 0;var o=function(e){function t(t,n,r){var i=e.call(this,!1,n,r)||this;return i.element=t,i}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(6300).Event);t.VideoElementEvent=o},4113:function(e){function t(){var e={};this.forEach=function(t){for(var n in e){var r=e[n];for(var i in r)t(r[i])}},this.get=function(t,n){var r=e[n];if(void 0!=r)return r[t]},this.remove=function(t,n){var r=e[n];if(void 0!=r){for(var i in delete r[t],r)return!1;delete e[n]}},this.set=function(t,n,r){if(void 0==t)return this.remove(n,r);var i=e[r];void 0==i&&(e[r]=i={}),i[n]=t}}t.prototype.pop=function(e,t){var n=this.get(e,t);if(void 0!=n)return this.remove(e,t),n},e.exports=t},264:function(e,t,n){var r=n(9972);t.JsonRpcClient=r},9972:function(e,t,n){var r=n(4834),i=n(1889),o=n(5364).OpenViduLogger;Date.now=Date.now||function(){return+new Date};var s="RECONNECTING",a="CONNECTED",c="DISCONNECTED",u=o.getInstance();e.exports=function(e){var t,n=this,o=e.ws,d=-1,l=0,p=!0,h=!1,f=c,m=o.onreconnecting,v=o.onreconnected,g=o.onconnected,b=o.onerror;e.rpc.pull=function(e,t){t.reply(null,"push")},o.onreconnecting=function(){if(u.debug("--------- ONRECONNECTING -----------"),f===s){u.error("Websocket already in RECONNECTING state when receiving a new ONRECONNECTING message. Ignoring it");return}I(),f=s,m&&m()},o.onreconnected=function(){if(u.debug("--------- ONRECONNECTED -----------"),f===a){u.error("Websocket already in CONNECTED state when receiving a new ONRECONNECTED message. Ignoring it");return}f=a,w(),v&&v()},o.onconnected=function(){if(u.debug("--------- ONCONNECTED -----------"),f===a){u.error("Websocket already in CONNECTED state when receiving a new ONCONNECTED message. Ignoring it");return}f=a,p=!0,C(),g&&g()},o.onerror=function(e){u.debug("--------- ONERROR -----------"),f=c,I(),b&&b(e)};var E=new i(o);u.debug("Connecting websocket to URI: "+o.uri);var y={request_timeout:e.rpc.requestTimeout,ping_request_timeout:e.rpc.heartbeatRequestTimeout},S=new r(r.packers.JsonRPC,y,E,function(t){u.debug("Received request: "+JSON.stringify(t));try{var n=e.rpc[t.method];void 0===n?u.error("Method "+t.method+" not registered in client"):n(t.params,t)}catch(e){u.error("Exception processing request: "+JSON.stringify(t)),u.error(e)}});function w(){u.debug("notReconnectIfNumLessThan = "+l+" (old="+d+")"),d=l}function O(){if(p){var t,r=null;(0==l||l==d)&&(r={interval:e.heartbeat||5e3}),l++,n.send("ping",r,(t=l,function(e,n){e&&(u.debug("Error in ping request #"+t+" ("+e.message+")"),t>d&&(p=!1,w(),u.debug("Server did not respond to ping message #"+t+". Reconnecting... "),E.reconnectWs()))}))}else u.debug("Trying to send ping, but ping is not enabled")}function C(){h||(u.debug("Starting ping (if configured)"),h=!0,void 0!=e.heartbeat&&(t=setInterval(O,e.heartbeat),O()))}function I(){clearInterval(t),h=!1,p=!1,l=-1,S.cancel()}this.send=function(e,t,n){var r=Date.now();S.encode(e,t,function(i,o){if(i){try{u.error("ERROR:"+i.message+" in Request: method:"+e+" params:"+JSON.stringify(t)+" request:"+i.request),i.data&&u.error("ERROR DATA:"+JSON.stringify(i.data))}catch(e){}i.requestTime=r}n&&(void 0!=o&&"pong"!==o.value&&u.debug("Response: "+JSON.stringify(o)),n(i,o))})},this.close=function(e,n){u.debug("Closing  with code: "+e+" because: "+n),void 0!=t&&(u.debug("Clearing ping interval"),clearInterval(t)),h=!1,p=!1,E.close(e,n)},this.reconnect=function(){E.reconnectWs()},this.resetPing=function(){p=!0,l=0,C()},this.getReadyState=function(){return E.getReadyState()}}},6115:function(e,t,n){var r=n(1889);t.WebSocketWithReconnection=r},1889:function(e,t,n){"use strict";var r=n(5364).OpenViduLogger.getInstance();e.exports=function(e){var t,n=!1,i=e.uri,o=!1,s=new WebSocket(i);s.onopen=function(){r.debug("WebSocket connected to "+i),e.onconnected&&e.onconnected()},s.onerror=function(t){r.error("Could not connect to "+i+" (invoking onerror if defined)",t),e.onerror&&e.onerror(t)};var a=function(){3===s.readyState?n?r.debug("Connection closed by user"):e.ismasternodecrashed()?r.error("Master Node has crashed. Stopping reconnection process"):(r.debug("Connection closed unexpectedly. Reconnecting..."),c(2e3,1)):r.debug("Close callback from previous websocket. Ignoring it")};function c(n,u){var d,l;if(r.debug("reconnect (attempt #"+u+", max="+n+")"),1===u){if(o){r.warn("Trying to reconnect when already reconnecting... Ignoring this reconnection.");return}o=!0,e.onreconnecting&&e.onreconnecting()}r.debug("Reconnection attempt #"+u),s.close(4104,"Connection closed for reconnection"),d=i,(l=new URLSearchParams(new URL(d).search)).has("reconnect")||(d=Array.from(l).length>0?d+"&reconnect=true":d+"?reconnect=true"),i=d,(s=new WebSocket(i)).onopen=function(){r.debug("Reconnected to "+i+" after "+u+" attempts..."),o=!1,t(),e.onreconnected()&&e.onreconnected(),s.onclose=a},s.onerror=function(t){r.warn("Reconnection error: ",t),u===n?e.ondisconnect&&e.ondisconnect():setTimeout(function(){c(n,u+1)},3e3)}}s.onclose=a,this.close=function(e,t){n=!0,s.close(e,t)},this.reconnectWs=function(){r.debug("reconnectWs"),c(2e3,1)},this.send=function(e){s.send(e)},this.addEventListener=function(e,n){(t=function(){s.addEventListener(e,n)})()},this.getReadyState=function(){return s.readyState}}},4834:function(e,t,n){var r=!1;if(Object.defineProperty)try{Object.defineProperty({},"x",{})}catch(e){r=!0}Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,r=function(){},i=function(){return n.apply(this instanceof r&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return r.prototype=this.prototype,i.prototype=new r,i});var i=n(7187).EventEmitter,o=n(5717),s=n(6622),a=n(4113);function c(e){if(e){if(e instanceof Function)return{send:e};if(e.send instanceof Function)return e;if(e.postMessage instanceof Function)return e.send=e.postMessage,e;if(e.write instanceof Function)return e.send=e.write,e;if(void 0===e.onmessage&&!(e.pause instanceof Function))throw SyntaxError("Transport is not a function nor a valid object")}}function u(e,t){r?(this.method=e,this.params=t):(Object.defineProperty(this,"method",{value:e,enumerable:!0}),Object.defineProperty(this,"params",{value:t,enumerable:!0}))}function d(e,t,n,s){var d=this;if(!e)throw SyntaxError("Packer is not defined");if(!e.pack||!e.unpack)throw SyntaxError("Packer is invalid");var l=function(e){if(!e)return{};for(var t in e){var n=e[t];"string"==typeof n&&(e[t]={response:n})}return e}(e.responseMethods);if(t instanceof Function){if(void 0!=n)throw SyntaxError("There can't be parameters after onRequest");s=t,n=void 0,t=void 0}if(t&&t.send instanceof Function){if(n&&!(n instanceof Function))throw SyntaxError("Only a function can be after transport");s=n,n=t,t=void 0}if(n instanceof Function){if(void 0!=s)throw SyntaxError("There can't be parameters after onRequest");s=n,n=void 0}if(n&&n.send instanceof Function&&s&&!(s instanceof Function))throw SyntaxError("Only a function can be after transport");t=t||{},i.call(this),s&&this.on("request",s),r?this.peerID=t.peerID:Object.defineProperty(this,"peerID",{value:t.peerID});var p=t.max_retries||0;function h(e){d.decode(e.data||e)}this.getTransport=function(){return n},this.setTransport=function(e){n&&(n.removeEventListener?n.removeEventListener("message",h):n.removeListener&&n.removeListener("data",h)),e&&(e.addEventListener?e.addEventListener("message",h):e.addListener&&e.addListener("data",h)),n=c(e)},r||Object.defineProperty(this,"transport",{get:this.getTransport.bind(this),set:this.setTransport.bind(this)}),this.setTransport(n);var f=t.request_timeout||5e3,m=t.ping_request_timeout||f,v=t.response_timeout||5e3,g=t.duplicates_timeout||5e3,b=0,E=new a,y=new a,S=new a,w={};function O(e,t){var n=setTimeout(function(){S.remove(e,t)},g);S.set(n,e,t)}function C(t,n,i,o,s){u.call(this,t,n),this.getTransport=function(){return s},this.setTransport=function(e){s=c(e)},r||Object.defineProperty(this,"transport",{get:this.getTransport.bind(this),set:this.setTransport.bind(this)});var a=y.get(i,o);s||d.getTransport()||(r?this.duplicated=!!a:Object.defineProperty(this,"duplicated",{value:!!a}));var p=l[t];this.pack=e.pack.bind(e,this,i),this.reply=function(t,n,r){var s,u;if(t instanceof Function||t&&t.send instanceof Function){if(void 0!=n)throw SyntaxError("There can't be parameters after callback");r=t,n=null,t=void 0}else if(n instanceof Function||n&&n.send instanceof Function){if(void 0!=r)throw SyntaxError("There can't be parameters after callback");r=n,n=null}return(r=c(r),a&&clearTimeout(a.timeout),void 0!=o&&(t&&(t.dest=o),n&&(n.dest=o)),t||void 0!=n)?(void 0!=d.peerID&&(t?t.from=d.peerID:n.from=d.peerID),s=p?void 0==p.error&&t?{error:t}:{method:t?p.error:p.response,params:t||n}:{error:t,result:n},s=e.pack(s,i)):s=a?a.message:e.pack({result:null},i),(u={message:s,timeout:setTimeout(function(){y.remove(i,o)},v)},y.set(u,i,o),r=r||this.getTransport()||d.getTransport())?r.send(s):s}}function I(e){var t=w[e];if(t){delete w[e];var n=E.pop(t.id,t.dest);n&&(clearTimeout(n.timeout),O(t.id,t.dest))}}o(C,u),this.cancel=function(e){if(e)return I(e);for(var e in w)I(e)},this.close=function(){var e=this.getTransport();e&&e.close&&e.close(4003,"Cancel request"),this.cancel(),S.forEach(clearTimeout),y.forEach(function(e){clearTimeout(e.timeout)})},this.encode=function(t,n,r,i,o){if(n instanceof Function){if(void 0!=r)throw SyntaxError("There can't be parameters after callback");o=n,i=void 0,r=void 0,n=void 0}else if(r instanceof Function){if(void 0!=i)throw SyntaxError("There can't be parameters after callback");o=r,i=void 0,r=void 0}else if(i instanceof Function){if(void 0!=o)throw SyntaxError("There can't be parameters after callback");o=i,i=void 0}void 0!=d.peerID&&((n=n||{}).from=d.peerID),void 0!=r&&((n=n||{}).dest=r);var s={method:t,params:n};if(o){var a=b++,u=0;function h(e,t){d.cancel(s),o(e,t)}var v={message:s=e.pack(s,a),callback:h,responseMethods:l[t]||{}},g=c(i);function y(e){var n="ping"===t?m:f;return(v.timeout=setTimeout(C,n*Math.pow(2,u++)),w[s]={id:a,dest:r},E.set(v,a,r),e=e||g||d.getTransport())?e.send(s):s}function O(e){return e=c(e),console.warn(u+" retry for request message:",s),clearTimeout(S.pop(a,r)),y(e)}function C(){if(u<p)return O(i);var e=Error("Request has timed out");e.request=s,e.retry=O,h(e)}return y(i)}return(s=e.pack(s),i=i||this.getTransport())?i.send(s):s},this.decode=function(t,n){if(!t)throw TypeError("Message is not defined");try{t=e.unpack(t)}catch(e){return console.debug(e,t)}var r=t.id,i=t.ack,o=t.method,s=t.params||{},a=s.from,l=s.dest;if(void 0==d.peerID||a!=d.peerID){if(void 0==r&&void 0==i){var p=new u(o,s);if(d.emit("request",p))return;return p}if(o){if(void 0==l||l==d.peerID){var h=E.get(i,a);if(h){var f=h.responseMethods;return o==f.error?w(h,s):o==f.response?w(h,null,s):b()}var m=S.get(i,a);if(m)return I(m)}return b()}var v=t.error,g=t.result;if((!v||!v.dest||v.dest==d.peerID)&&(!g||!g.dest||g.dest==d.peerID)){var h=E.get(i,a);if(!h){var m=S.get(i,a);return m?I(m):console.warn("No callback was defined for this message",t)}w(h,v,g)}}function b(){if(n=c(n)||d.getTransport()){var e=y.get(r,a);if(e)return n.send(e.message)}var t=void 0!=r?r:i,u=new C(o,s,t,a,n);if(!d.emit("request",u))return u}function w(e,t,n){e.callback(t,n)}function I(e){console.warn("Response already processed",t),clearTimeout(e),O(i,a)}}}o(d,i),d.RpcNotification=u,e.exports=d;var l=n(264),p=n(6115);d.clients=l,d.clients.transports=p,d.packers=s},8447:function(e,t){t.pack=function(e,t){var n={jsonrpc:"2.0"};if(e.method)n.method=e.method,e.params&&(n.params=e.params),void 0!=t&&(n.id=t);else if(void 0!=t){if(e.error){if(void 0!==e.result)throw TypeError("Both result and error are defined");n.error=e.error}else if(void 0!==e.result)n.result=e.result;else throw TypeError("No result or error is defined");n.id=t}return JSON.stringify(n)},t.unpack=function(e){var t=e;("string"==typeof e||e instanceof String)&&(t=JSON.parse(e));var n=t.jsonrpc;if("2.0"!==n)throw TypeError("Invalid JsonRPC version '"+n+"': "+e);if(void 0==t.method){if(void 0==t.id)throw TypeError("Invalid message: "+e);var r=void 0!==t.result,i=void 0!==t.error;if(r&&i)throw TypeError("Both result and error are defined: "+e);if(!r&&!i)throw TypeError("No result or error is defined: "+e);t.ack=t.id,delete t.id}return t}},7632:function(e,t){t.pack=function(e){throw TypeError("Not yet implemented")},t.unpack=function(e){throw TypeError("Not yet implemented")}},6622:function(e,t,n){var r=n(8447),i=n(7632);t.JsonRPC=r,t.XmlRPC=i},8982:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConsoleLogger=void 0,t.ConsoleLogger=function(e){this.logger=e,this.log=e.log,this.info=e.info,this.debug=e.debug,this.warn=e.warn,this.error=e.error}},5364:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpenViduLogger=void 0;var r=n(3129),i=n(8982),o=n(327),s=function(){function e(){this.JSNLOG_URL="/openvidu/elk/openvidu-browser-logs",this.MAX_JSNLOG_BATCH_LOG_MESSAGES=100,this.MAX_MSECONDS_BATCH_MESSAGES=5e3,this.MAX_LENGTH_STRING_JSON=1e3,this.defaultConsoleLogger=new i.ConsoleLogger(globalThis.console),this.isProdMode=!1,this.isJSNLogSetup=!1}return e.configureJSNLog=function(e,t){var n=this;try{if(globalThis.LOG_JSNLOG_RESULTS||this.instance&&e.isAtLeastPro&&this.instance.isOpenViduBrowserLogsDebugActive(e)&&this.instance.canConfigureJSNLog(e,this.instance)){e.sendBrowserLogs===o.OpenViduLoggerConfiguration.debug_app&&this.instance.replaceWindowConsole(),this.instance.isJSNLogSetup=!1,this.instance.info("Configuring JSNLogs.");var i=e.finalUserId,s=e.session.sessionId;this.instance.currentAppender=r.JL.createAjaxAppender("appender-".concat(i,"-").concat(s)),this.instance.currentAppender.setOptions({beforeSend:function(e){var r=e.onreadystatechange;e.onreadystatechange=function(){n.isInvalidResponse(e)&&(Object.defineProperty(e,"readyState",{value:4}),Object.defineProperty(e,"status",{value:200}),n.instance.disableLogger()),r()},e.setRequestHeader("Authorization","Basic "+btoa("".concat(i,"%/%").concat(s)+":"+t)),e.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.setRequestHeader("OV-Final-User-Id",i),e.setRequestHeader("OV-Session-Id",s),e.setRequestHeader("OV-Token",t)},maxBatchSize:1e3,batchSize:this.instance.MAX_JSNLOG_BATCH_LOG_MESSAGES,batchTimeout:this.instance.MAX_MSECONDS_BATCH_MESSAGES}),r.JL.setOptions({defaultAjaxUrl:e.httpUri+this.instance.JSNLOG_URL,serialize:function(e){var t,r=JSON.stringify(e,(t=new WeakSet,function(e,n){if("object"==typeof n&&null!=n){if(t.has(n)||globalThis.HTMLElement&&n instanceof HTMLElement)return;t.add(n)}return n}));return r.length>n.instance.MAX_LENGTH_STRING_JSON&&(r="".concat(r.substring(0,n.instance.MAX_LENGTH_STRING_JSON),"...")),globalThis.LOG_JSNLOG_RESULTS&&console.log(r),r},enabled:!0}),(0,r.JL)().setOptions({appenders:[this.instance.currentAppender]}),this.instance.isJSNLogSetup=!0,this.instance.loggingSessionId=s,this.instance.info("JSNLog configured.")}}catch(e){console.error("Error configuring JSNLog: "),console.error(e),this.instance.disableLogger()}},e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.isInvalidResponse=function(e){return 401==e.status||403==e.status||404==e.status||0==e.status},e.prototype.canConfigureJSNLog=function(e,t){return e.session.sessionId!=t.loggingSessionId},e.prototype.isOpenViduBrowserLogsDebugActive=function(e){return e.sendBrowserLogs===o.OpenViduLoggerConfiguration.debug||e.sendBrowserLogs===o.OpenViduLoggerConfiguration.debug_app},e.prototype.getConsoleWithJSNLog=function(){var e;return e=this,{log:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.defaultConsoleLogger.log.apply(e.defaultConsoleLogger.logger,arguments),e.isJSNLogSetup&&(0,r.JL)().info(arguments)},info:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.defaultConsoleLogger.info.apply(e.defaultConsoleLogger.logger,arguments),e.isJSNLogSetup&&(0,r.JL)().info(arguments)},debug:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.defaultConsoleLogger.debug.apply(e.defaultConsoleLogger.logger,arguments)},warn:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.defaultConsoleLogger.warn.apply(e.defaultConsoleLogger.logger,arguments),e.isJSNLogSetup&&(0,r.JL)().warn(arguments)},error:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.defaultConsoleLogger.error.apply(e.defaultConsoleLogger.logger,arguments),e.isJSNLogSetup&&(0,r.JL)().error(arguments)}}},e.prototype.replaceWindowConsole=function(){globalThis.console=this.defaultConsoleLogger.logger,globalThis.console.log=this.getConsoleWithJSNLog().log,globalThis.console.info=this.getConsoleWithJSNLog().info,globalThis.console.debug=this.getConsoleWithJSNLog().debug,globalThis.console.warn=this.getConsoleWithJSNLog().warn,globalThis.console.error=this.getConsoleWithJSNLog().error},e.prototype.disableLogger=function(){r.JL.setOptions({enabled:!1}),this.isJSNLogSetup=!1,this.loggingSessionId=void 0,this.currentAppender=void 0,globalThis.console=this.defaultConsoleLogger.logger,globalThis.console.log=this.defaultConsoleLogger.log,globalThis.console.info=this.defaultConsoleLogger.info,globalThis.console.debug=this.defaultConsoleLogger.debug,globalThis.console.warn=this.defaultConsoleLogger.warn,globalThis.console.error=this.defaultConsoleLogger.error},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.isProdMode||this.defaultConsoleLogger.log.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&(0,r.JL)().info(arguments)},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.isProdMode||this.defaultConsoleLogger.debug.apply(this.defaultConsoleLogger.logger,arguments)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.isProdMode||this.defaultConsoleLogger.info.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&(0,r.JL)().info(arguments)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.defaultConsoleLogger.warn.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&(0,r.JL)().warn(arguments)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.defaultConsoleLogger.error.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&(0,r.JL)().error(arguments)},e.prototype.flush=function(){this.isJSNLogSetup&&null!=this.currentAppender&&this.currentAppender.sendBatch()},e.prototype.enableProdMode=function(){this.isProdMode=!0},e}();t.OpenViduLogger=s},327:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.OpenViduLoggerConfiguration=void 0,(n=t.OpenViduLoggerConfiguration||(t.OpenViduLoggerConfiguration={})).disabled="disabled",n.debug="debug",n.debug_app="debug_app"},3061:function(e,t){var n;function r(e,t,n){var r={audio:!1,video:{mandatory:{chromeMediaSource:e?"screen":"desktop",maxWidth:globalThis.screen.width>1920?globalThis.screen.width:1920,maxHeight:globalThis.screen.height>1080?globalThis.screen.height:1080},optional:[]}};return n&&(r.audio={mandatory:{chromeMediaSource:e?"screen":"desktop"},optional:[]}),t&&(r.video.mandatory.chromeMediaSourceId=t,r.audio&&r.audio.mandatory&&(r.audio.mandatory.chromeMediaSourceId=t)),r}function i(e){if(!n){o(function(){i(e)});return}if(!n.isLoaded){setTimeout(function(){i(e)},100);return}e?e.forEach?n.contentWindow.postMessage({captureCustomSourceId:e},"*"):n.contentWindow.postMessage({captureSourceIdWithAudio:!0},"*"):n.contentWindow.postMessage({captureSourceId:!0},"*")}function o(e){if(n){e();return}(n=document.createElement("iframe")).onload=function(){n.isLoaded=!0,e()},n.src="https://openvidu.github.io/openvidu-screen-sharing-chrome-extension/",n.style.display="none",(document.body||document.documentElement).appendChild(n)}function s(){if(!n){o(s);return}if(!n.isLoaded){setTimeout(s,100);return}n.contentWindow.postMessage({getChromeExtensionStatus:!0},"*")}globalThis.getScreenId=function(e,t,n){if(-1!==navigator.userAgent.indexOf("Edge")&&(navigator.msSaveOrOpenBlob||navigator.msSaveBlob)){t({video:!0});return}if(navigator.mozGetUserMedia){t(null,"firefox",{video:{mozMediaSource:e,mediaSource:e}});return}globalThis.addEventListener("message",function e(n){n.data&&(n.data.chromeMediaSourceId&&("PermissionDeniedError"===n.data.chromeMediaSourceId?t("permission-denied"):t(null,n.data.chromeMediaSourceId,r(null,n.data.chromeMediaSourceId,n.data.canRequestAudioTrack)),globalThis.removeEventListener("message",e)),n.data.chromeExtensionStatus&&(t(n.data.chromeExtensionStatus,null,r(n.data.chromeExtensionStatus)),globalThis.removeEventListener("message",e)))}),n?setTimeout(function(){i(n)},100):setTimeout(i,100)},globalThis.getScreenConstraints=function(e){o(function(){getScreenId(function(t,n,r){r||(r={video:!0}),e(t,r.video)})})},globalThis.getChromeExtensionStatus=function(e){if(navigator.mozGetUserMedia){e("installed-enabled");return}globalThis.addEventListener("message",function t(n){n.data&&n.data.chromeExtensionStatus&&(e(n.data.chromeExtensionStatus),globalThis.removeEventListener("message",t))}),setTimeout(s,100)},t.getScreenId=globalThis.getScreenId},9544:function(e,t){var n,r,i="screen";if("undefined"!=typeof window&&"undefined"!=typeof navigator&&void 0!==navigator.userAgent){var o=void 0!==window.InstallTrigger;window.opera||navigator.userAgent.indexOf(" OPR/"),window.chrome,window.addEventListener("message",function(e){e.origin==window.location.origin&&function(e){if("PermissionDeniedError"==e){if(r)return r("PermissionDeniedError");throw Error("PermissionDeniedError")}"rtcmulticonnection-extension-loaded"==e&&(i="desktop"),e.sourceId&&r&&r(n=e.sourceId,!0===e.canRequestAudioTrack)}(e.data)})}function s(e){if(!e)throw'"callback" parameter is mandatory.';if(n)return e(n);r=e,window.postMessage("get-sourceId","*")}function a(e,t){if(n="",o)return e(null,{mozMediaSource:"window",mediaSource:"window"});var a={mandatory:{chromeMediaSource:i,maxWidth:screen.width>1920?screen.width:1920,maxHeight:screen.height>1080?screen.height:1080},optional:[]};if("desktop"==i&&!n){t?function(e){if(!e)throw'"callback" parameter is mandatory.';if(n)return e(n);r=e,window.postMessage("audio-plus-tab","*")}(function(t,n){a.mandatory.chromeMediaSourceId=t,n&&(a.canRequestAudioTrack=!0),e("PermissionDeniedError"==t?t:null,a)}):s(function(t){a.mandatory.chromeMediaSourceId=t,e("PermissionDeniedError"==t?t:null,a)});return}"desktop"==i&&(a.mandatory.chromeMediaSourceId=n),e(null,a)}t.getScreenConstraints=a,t.getScreenConstraintsWithAudio=function(e){a(e,!0)},t.isChromeExtensionAvailable=function(e){if(e){if("desktop"==i)return e(!0);window.postMessage("are-you-there","*"),setTimeout(function(){"screen"==i?e(!1):e(!0)},2e3)}},t.getChromeExtensionStatus=function(e,t){if(o)return t("not-chrome");2!=arguments.length&&(t=e,e="lfcgfepafnobdloecchnfaclibenjold");var n=document.createElement("img");n.src="chrome-extension://"+e+"/icon.png",n.onload=function(){i="screen",window.postMessage("are-you-there","*"),setTimeout(function(){"screen"==i?t("installed-disabled"):t("installed-enabled")},2e3)},n.onerror=function(){t("not-installed")}},t.getSourceId=s},5971:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlatformUtils=void 0;var r=n(1795),i=function(){function e(){}return e.getInstance=function(){return this.instance||(this.instance=new e),e.instance},e.prototype.isChromeBrowser=function(){return"Chrome"===r.name},e.prototype.isSafariBrowser=function(){return"Safari"===r.name},e.prototype.isChromeMobileBrowser=function(){return"Chrome Mobile"===r.name},e.prototype.isFirefoxBrowser=function(){return"Firefox"===r.name},e.prototype.isFirefoxMobileBrowser=function(){return"Firefox Mobile"===r.name||"Firefox for iOS"===r.name},e.prototype.isOperaBrowser=function(){return"Opera"===r.name},e.prototype.isOperaMobileBrowser=function(){return"Opera Mobile"===r.name},e.prototype.isEdgeBrowser=function(){var e=(null==r?void 0:r.version)?parseFloat(r.version):-1;return"Microsoft Edge"===r.name&&e>=80},e.prototype.isEdgeMobileBrowser=function(){var e,t,n=(null==r?void 0:r.version)?parseFloat(r.version):-1;return"Microsoft Edge"===r.name&&((null===(e=r.os)||void 0===e?void 0:e.family)==="Android"||(null===(t=r.os)||void 0===t?void 0:t.family)==="iOS")&&n>45},e.prototype.isAndroidBrowser=function(){return"Android Browser"===r.name},e.prototype.isElectron=function(){return"Electron"===r.name},e.prototype.isNodeJs=function(){return"Node.js"===r.name},e.prototype.isSamsungBrowser=function(){return"Samsung Internet Mobile"===r.name||"Samsung Internet"===r.name},e.prototype.isMotorolaEdgeDevice=function(){var e;return(null===(e=r.product)||void 0===e?void 0:e.toLowerCase().includes("motorola edge"))||!1},e.prototype.isIPhoneOrIPad=function(){var e=r.ua?r.ua:navigator.userAgent,t="ontouchend"in document,n=/\b(\w*Macintosh\w*)\b/.test(e)&&t,i=/\b(\w*iPhone\w*)\b/.test(e)&&/\b(\w*Mobile\w*)\b/.test(e)&&t;return n||i},e.prototype.isIOSWithSafari=function(){var e=r.ua?r.ua:navigator.userAgent;return this.isIPhoneOrIPad()&&/\b(\w*Apple\w*)\b/.test(navigator.vendor)&&/\b(\w*Safari\w*)\b/.test(e)&&!/\b(\w*CriOS\w*)\b/.test(e)&&!/\b(\w*FxiOS\w*)\b/.test(e)},e.prototype.isIonicIos=function(){return this.isIPhoneOrIPad()&&-1===r.ua.indexOf("Safari")},e.prototype.isIonicAndroid=function(){return"Android"===r.os.family&&"Android Browser"==r.name},e.prototype.isMobileDevice=function(){return"iOS"===r.os.family||"Android"===r.os.family},e.prototype.isReactNative=function(){return!1},e.prototype.isChromium=function(){return this.isChromeBrowser()||this.isChromeMobileBrowser()||this.isOperaBrowser()||this.isOperaMobileBrowser()||this.isEdgeBrowser()||this.isEdgeMobileBrowser()||this.isSamsungBrowser()||this.isIonicAndroid()||this.isIonicIos()||this.isElectron()||this.isMotorolaEdgeDevice()},e.prototype.canScreenShare=function(){var e=(null==r?void 0:r.version)?parseFloat(r.version):-1;return!this.isMobileDevice()&&(this.isChromeBrowser()||this.isFirefoxBrowser()||this.isOperaBrowser()||this.isElectron()||this.isEdgeBrowser()||this.isSafariBrowser()&&e>=13)},e.prototype.getName=function(){return r.name||""},e.prototype.getVersion=function(){return r.version||""},e.prototype.getFamily=function(){return r.os.family||""},e.prototype.getDescription=function(){return r.description||""},e}();t.PlatformUtils=i},734:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.WebRtcPeerSendrecv=t.WebRtcPeerSendonly=t.WebRtcPeerRecvonly=t.WebRtcPeer=void 0;var c=n(8483),u=n(7429),d=n(6056),l=n(5364),p=n(5971),h=l.OpenViduLogger.getInstance(),f=function(){function e(e){var t=this;this.remoteCandidatesQueue=[],this.localCandidatesQueue=[],this.iceCandidateList=[],p.PlatformUtils.getInstance(),this.configuration=o(o({},e),{iceServers:e.iceServers&&e.iceServers.length>0?e.iceServers:c(),mediaStream:void 0!==e.mediaStream?e.mediaStream:null,mode:e.mode?e.mode:"sendrecv",id:e.id?e.id:this.generateUniqueId()}),h.debug("[WebRtcPeer] configuration:\n".concat(JSON.stringify(this.configuration,null,2))),this.pc=new RTCPeerConnection({iceServers:this.configuration.iceServers}),this.pc.addEventListener("icecandidate",function(e){if(null!==e.candidate){var n=e.candidate,r=new RTCIceCandidate(n);t.configuration.onIceCandidate(r),""!==r.candidate&&t.localCandidatesQueue.push(r)}}),this.pc.addEventListener("signalingstatechange",function(){return s(t,void 0,void 0,function(){var e,t;return a(this,function(n){switch(n.label){case 0:if("stable"!==this.pc.signalingState)return[3,6];n.label=1;case 1:if(!(this.iceCandidateList.length>0))return[3,6];e=this.iceCandidateList.shift(),n.label=2;case 2:return n.trys.push([2,4,,5]),[4,this.pc.addIceCandidate(e)];case 3:return n.sent(),[3,5];case 4:return t=n.sent(),h.error("Error when calling RTCPeerConnection#addIceCandidate for RTCPeerConnection "+this.getId(),t),[3,5];case 5:return[3,1];case 6:return[2]}})})})}return e.prototype.getId=function(){return this.configuration.id},e.prototype.dispose=function(){h.debug("Disposing WebRtcPeer"),this.pc&&"closed"!==this.pc.signalingState&&(this.pc.close(),this.remoteCandidatesQueue=[],this.localCandidatesQueue=[])},e.prototype.createOfferLegacy=function(){this.configuration.mediaStream&&this.deprecatedPeerConnectionTrackApi();var e=this.configuration.mediaConstraints.audio,t=this.configuration.mediaConstraints.video,n={offerToReceiveAudio:"sendonly"!==this.configuration.mode&&e,offerToReceiveVideo:"sendonly"!==this.configuration.mode&&t};return h.debug("[createOfferLegacy] RTCPeerConnection.createOffer() options:",JSON.stringify(n)),this.pc.createOffer(n)},e.prototype.createOffer=function(){var e,t,n,r,i,o,c,u;return s(this,void 0,void 0,function(){var s,d,l,p,f,m,v,g,b,E,y,S,w,O,C,I,R,P,T,k,_,x,N;return a(this,function(a){switch(a.label){case 0:if(!("addTransceiver"in this.pc))return h.warn("[createOffer] Method RTCPeerConnection.addTransceiver() is NOT available; using LEGACY offerToReceive{Audio,Video}"),[2,this.createOfferLegacy()];if(h.debug("[createOffer] Method RTCPeerConnection.addTransceiver() is available; using it"),!("recvonly"!==this.configuration.mode))return[3,7];if(!this.configuration.mediaStream)throw Error("[WebRtcPeer.createOffer] Direction is '".concat(this.configuration.mode,"', but no stream was configured to be sent"));s=0,d=this.configuration.mediaStream.getTracks(),a.label=1;case 1:if(!(s<d.length))return[3,6];if(l=d[s],p={direction:this.configuration.mode,streams:[this.configuration.mediaStream]},"video"===l.kind&&this.configuration.simulcast)for(f=l.getSettings(),m=l.getConstraints(),v=null!==(n=null!==(t=null!==(e=f.width)&&void 0!==e?e:m.width.ideal)&&void 0!==t?t:m.width)&&void 0!==n?n:0,g=null!==(o=null!==(i=null!==(r=f.height)&&void 0!==r?r:m.height.ideal)&&void 0!==i?i:m.height)&&void 0!==o?o:0,h.info("[createOffer] Video track dimensions: ".concat(v,"x").concat(g)),E=0,E=(b=v*g)>=518400?3:b>=129600?2:1,p.sendEncodings=[],y=0;y<E;y++)w={rid:"rdiv"+(S=Math.pow(2,E-y-1)).toString(),scalabilityMode:"L1T1"},["detail","text"].includes(l.contentHint)?(w.scaleResolutionDownBy=1,w.maxFramerate=Math.floor(30/S)):w.scaleResolutionDownBy=S,p.sendEncodings.push(w);if(O=this.pc.addTransceiver(l,p),"video"!==l.kind||(C=O.sender.getParameters(),I=!1,(null===(c=C.degradationPreference)||void 0===c?void 0:c.length)||(["detail","text"].includes(l.contentHint)?C.degradationPreference="maintain-resolution":C.degradationPreference="balanced",h.info("[createOffer] Video sender Degradation Preference set: ".concat(C.degradationPreference)),I=!0),this.configuration.simulcast&&(null===(u=C.encodings)||void 0===u?void 0:u.length)!==p.sendEncodings.length&&(C.encodings=p.sendEncodings,I=!0),!I))return[3,5];h.debug("[createOffer] Setting new RTCRtpSendParameters to video sender"),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,O.sender.setParameters(C)];case 3:return a.sent(),[3,5];case 4:throw R=a.sent(),P="[WebRtcPeer.createOffer] Cannot set RTCRtpSendParameters to video sender",R instanceof Error&&(P+=": ".concat(R.message)),Error(P);case 5:return s++,[3,1];case 6:return[3,8];case 7:for(T=0,k=["audio","video"];T<k.length;T++)_=k[T],this.configuration.mediaConstraints[_]&&(this.configuration.mediaStream=new MediaStream,this.pc.addTransceiver(_,{direction:this.configuration.mode,streams:[this.configuration.mediaStream]}));a.label=8;case 8:return a.trys.push([8,10,,11]),[4,this.pc.createOffer()];case 9:return x=a.sent(),[3,11];case 10:throw N=a.sent(),P="[WebRtcPeer.createOffer] Browser failed creating an SDP Offer",N instanceof Error&&(P+=": ".concat(N.message)),Error(P);case 11:return[2,x]}})})},e.prototype.deprecatedPeerConnectionTrackApi=function(){for(var e=0,t=this.configuration.mediaStream.getTracks();e<t.length;e++){var n=t[e];this.pc.addTrack(n,this.configuration.mediaStream)}},e.prototype.createAnswer=function(){var e=this;return new Promise(function(t,n){if("getTransceivers"in e.pc){h.debug("[createAnswer] Method RTCPeerConnection.getTransceivers() is available; using it");for(var r=function(t){if(!e.configuration.mediaConstraints[t])return"continue";var r=e.pc.getTransceivers().find(function(e){return e.receiver.track.kind===t});if(!r)return{value:n(Error("".concat(t," requested, but no transceiver was created from remote description")))};r.direction=e.configuration.mode},i=0,o=["audio","video"];i<o.length;i++){var s=r(o[i]);if("object"==typeof s)return s.value}e.pc.createAnswer().then(function(e){return t(e)}).catch(function(e){return n(e)})}else{var a=void 0;if(e.configuration.mediaConstraints){var c={offerToReceiveAudio:"boolean"!=typeof e.configuration.mediaConstraints.audio||e.configuration.mediaConstraints.audio,offerToReceiveVideo:"boolean"!=typeof e.configuration.mediaConstraints.video||e.configuration.mediaConstraints.video};e.pc.createAnswer(c).then(function(e){return t(e)}).catch(function(e){return n(e)})}}})},e.prototype.processLocalOffer=function(e){var t=this;return new Promise(function(n,r){t.pc.setLocalDescription(e).then(function(){var e=t.pc.localDescription;return e?(h.debug("Local description set",e.sdp),n()):r("Local description is not defined")}).catch(function(e){return r(e)})})},e.prototype.processRemoteOffer=function(e){var t=this;return new Promise(function(n,r){var i={type:"offer",sdp:e};if(h.debug("SDP offer received, setting remote description",i),"closed"===t.pc.signalingState)return r("RTCPeerConnection is closed when trying to set remote description");t.setRemoteDescription(i).then(function(){return n()}).catch(function(e){return r(e)})})},e.prototype.processLocalAnswer=function(e){var t=this;return new Promise(function(n,r){if(h.debug("SDP answer created, setting local description"),"closed"===t.pc.signalingState)return r("RTCPeerConnection is closed when trying to set local description");t.pc.setLocalDescription(e).then(function(){return n()}).catch(function(e){return r(e)})})},e.prototype.processRemoteAnswer=function(e){var t=this;return new Promise(function(n,r){if(h.debug("SDP answer received, setting remote description"),"closed"===t.pc.signalingState)return r("RTCPeerConnection is closed when trying to set remote description");t.setRemoteDescription({type:"answer",sdp:e}).then(function(){n()}).catch(function(e){return r(e)})})},e.prototype.setRemoteDescription=function(e){return s(this,void 0,void 0,function(){return a(this,function(t){return[2,this.pc.setRemoteDescription(e)]})})},e.prototype.addIceCandidate=function(e){var t=this;return new Promise(function(n,r){switch(h.debug("Remote ICE candidate received",e),t.remoteCandidatesQueue.push(e),t.pc.signalingState){case"closed":r(Error("PeerConnection object is closed"));break;case"stable":t.pc.remoteDescription?t.pc.addIceCandidate(e).then(function(){return n()}).catch(function(e){return r(e)}):(t.iceCandidateList.push(e),n());break;default:t.iceCandidateList.push(e),n()}})},e.prototype.addIceConnectionStateChangeListener=function(e){var t=this;this.pc.addEventListener("iceconnectionstatechange",function(){switch(t.pc.iceConnectionState){case"disconnected":var n="IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') change to "disconnected". Possible network disconnection';h.warn(n),t.configuration.onIceConnectionStateException(d.ExceptionEventName.ICE_CONNECTION_DISCONNECTED,n);break;case"failed":var r="IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') to "failed"';h.error(r),t.configuration.onIceConnectionStateException(d.ExceptionEventName.ICE_CONNECTION_FAILED,r);break;case"closed":h.log("IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') change to "closed"');break;case"new":h.log("IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') change to "new"');break;case"checking":h.log("IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') change to "checking"');break;case"connected":h.log("IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') change to "connected"');break;case"completed":h.log("IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') change to "completed"')}})},e.prototype.generateUniqueId=function(){return(0,u.v4)()},e}();t.WebRtcPeer=f;var m=function(e){function t(t){return t.mode="recvonly",e.call(this,t)||this}return i(t,e),t}(f);t.WebRtcPeerRecvonly=m;var v=function(e){function t(t){return t.mode="sendonly",e.call(this,t)||this}return i(t,e),t}(f);t.WebRtcPeerSendonly=v;var g=function(e){function t(t){return t.mode="sendrecv",e.call(this,t)||this}return i(t,e),t}(f);t.WebRtcPeerSendrecv=g},7137:function(e,t,n){"use strict";var r,i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.WebRtcStats=void 0;var s=n(5364),a=n(5971),c=s.OpenViduLogger.getInstance(),u=function(){function e(e){this.stream=e,this.STATS_ITEM_NAME="webrtc-stats-config",this.webRtcStatsEnabled=!1,this.statsInterval=1,r=a.PlatformUtils.getInstance()}return e.prototype.isEnabled=function(){return this.webRtcStatsEnabled},e.prototype.initWebRtcStats=function(){var e=this,t=localStorage.getItem(this.STATS_ITEM_NAME);if(t){this.webRtcStatsEnabled=!0;var n=JSON.parse(t);c.warn("WebRtc stats enabled for stream "+this.stream.streamId+" of connection "+this.stream.connection.connectionId),c.warn("localStorage item: "+JSON.stringify(n)),this.POST_URL=n.httpEndpoint,this.statsInterval=n.interval,this.webRtcStatsIntervalId=setInterval(function(){return i(e,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,this.sendStatsToHttpEndpoint()];case 1:return e.sent(),[2]}})})},1e3*this.statsInterval)}else c.debug("WebRtc stats not enabled")},e.prototype.getSelectedIceCandidateInfo=function(){var e=this;return new Promise(function(t,n){return i(e,void 0,void 0,function(){var e,n,i,s,a,c,u,d,l,p,h,f,m,v,g,b,E,y,S,w,O;return o(this,function(o){switch(o.label){case 0:return[4,this.stream.getRTCPeerConnection().getStats()];case 1:if(e=o.sent(),i=new Map,s=new Map,a=new Map,e.forEach(function(e){switch("transport"===e.type&&(r.isChromium()||r.isSafariBrowser()||r.isReactNative())&&(n=e),e.type){case"candidate-pair":i.set(e.id,e);break;case"local-candidate":s.set(e.id,e);break;case"remote-candidate":a.set(e.id,e)}}),null!=n)u=n.selectedCandidatePairId,c=i.get(u);else for(p=0,d=i.size,l=i.values();p<d;p++)if((h=l.next().value).selected){c=h;break}if(f=c.localCandidateId,m=c.remoteCandidateId,v=s.get(f))for(b=0,g=this.stream.getLocalIceCandidateList().filter(function(e){return!!e.candidate&&(e.candidate.indexOf(v.ip)>=0||e.candidate.indexOf(v.address)>=0)&&e.candidate.indexOf(v.port)>=0}),v.raw=[],E=g;b<E.length;b++)y=E[b],v.raw.push(y.candidate);else v="ERROR: No active local ICE candidate. Probably ICE-TCP is being used";if(S=a.get(m))for(w=0,g=this.stream.getRemoteIceCandidateList().filter(function(e){return!!e.candidate&&(e.candidate.indexOf(S.ip)>=0||e.candidate.indexOf(S.address)>=0)&&e.candidate.indexOf(S.port)>=0}),S.raw=[],O=g;w<O.length;w++)y=O[w],S.raw.push(y.candidate);else S="ERROR: No active remote ICE candidate. Probably ICE-TCP is being used";return[2,t({localCandidate:v,remoteCandidate:S})]}})})})},e.prototype.stopWebRtcStats=function(){this.webRtcStatsEnabled&&(clearInterval(this.webRtcStatsIntervalId),c.warn("WebRtc stats stopped for disposed stream "+this.stream.streamId+" of connection "+this.stream.connection.connectionId))},e.prototype.sendStats=function(e,t){return i(this,void 0,void 0,function(){var n,r;return o(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),n={headers:{"Content-type":"application/json"},body:JSON.stringify(t),method:"POST"},[4,fetch(e,n)];case 1:return i.sent(),[3,3];case 2:return r=i.sent(),c.error("sendStats error: ".concat(JSON.stringify(r))),[3,3];case 3:return[2]}})})},e.prototype.sendStatsToHttpEndpoint=function(){return i(this,void 0,void 0,function(){var e,t,n;return o(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,this.getCommonStats()];case 1:return e=r.sent(),t=this.generateJSONStatsResponse(e),[4,this.sendStats(this.POST_URL,t)];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),c.log(n),[3,4];case 4:return[2]}})})},e.prototype.getCommonStats=function(){return i(this,void 0,void 0,function(){var e=this;return o(this,function(t){return[2,new Promise(function(t,n){return i(e,void 0,void 0,function(){var e,r,i,s,a,u=this;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.stream.getRTCPeerConnection().getStats()];case 1:return e=o.sent(),r=this.getWebRtcStatsResponseOutline(),i=["framesReceived","framesDropped","framesSent","frameHeight","frameWidth"],s=["availableOutgoingBitrate","currentRoundTripTime"],e.forEach(function(e){var t=null!=e.mediaType?e.mediaType:e.kind,n=function(n,o){null!=e[o]&&null!=r[n]&&(!t&&i.indexOf(o)>-1&&(t="video"),null!=n&&null!=t&&null!=o&&null!=r[n][t]?r[n][t][o]=Number(e[o]):null!=n&&null!=o&&s.includes(o)&&(r[n][o]=Number(e[o])))};switch(e.type){case"outbound-rtp":n("outbound","bytesSent"),n("outbound","packetsSent"),n("outbound","framesEncoded"),n("outbound","nackCount"),n("outbound","firCount"),n("outbound","pliCount"),n("outbound","qpSum");break;case"inbound-rtp":n("inbound","bytesReceived"),n("inbound","packetsReceived"),n("inbound","packetsLost"),n("inbound","jitter"),n("inbound","framesDecoded"),n("inbound","nackCount"),n("inbound","firCount"),n("inbound","pliCount");break;case"track":n("inbound","jitterBufferDelay"),n("inbound","framesReceived"),n("outbound","framesDropped"),n("outbound","framesSent"),n(u.stream.isLocal()?"outbound":"inbound","frameHeight"),n(u.stream.isLocal()?"outbound":"inbound","frameWidth");break;case"candidate-pair":n("candidatepair","currentRoundTripTime"),n("candidatepair","availableOutgoingBitrate")}}),(null==r?void 0:r.candidatepair)&&0!==Object.keys(r.candidatepair).length||delete r.candidatepair,[2,t(r)];case 2:return a=o.sent(),c.error("Error getting common stats: ",a),[2,n(a)];case 3:return[2]}})})})]})})},e.prototype.generateJSONStatsResponse=function(e){return{"@timestamp":new Date().toISOString(),participant_id:this.stream.connection.data,session_id:this.stream.session.sessionId,platform:r.getName(),platform_description:r.getDescription(),stream:"webRTC",webrtc_stats:e}},e.prototype.getWebRtcStatsResponseOutline=function(){return this.stream.isLocal()?{outbound:{audio:{},video:{}},candidatepair:{}}:{inbound:{audio:{},video:{}}}},e}();t.WebRtcStats=u},4905:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.EventDispatcher=t.ExceptionEventName=t.ExceptionEvent=t.SpeechToTextEvent=t.NetworkQualityLevelChangedEvent=t.FilterEvent=t.ConnectionPropertyChangedEvent=t.StreamPropertyChangedEvent=t.VideoElementEvent=t.StreamManagerEvent=t.StreamEvent=t.SignalEvent=t.SessionDisconnectedEvent=t.RecordingEvent=t.PublisherSpeakingEvent=t.ConnectionEvent=t.Event=t.VideoInsertMode=t.TypeOfVideo=t.OpenViduErrorName=t.OpenViduError=t.LocalRecorderState=t.Filter=t.LocalRecorder=t.Connection=t.Stream=t.StreamManager=t.Subscriber=t.Publisher=t.Session=t.OpenVidu=void 0;var o=n(3129),s=n(4527);Object.defineProperty(t,"OpenVidu",{enumerable:!0,get:function(){return s.OpenVidu}});var a=n(7678);Object.defineProperty(t,"Session",{enumerable:!0,get:function(){return a.Session}});var c=n(2917);Object.defineProperty(t,"Publisher",{enumerable:!0,get:function(){return c.Publisher}});var u=n(4980);Object.defineProperty(t,"Subscriber",{enumerable:!0,get:function(){return u.Subscriber}});var d=n(2028);Object.defineProperty(t,"StreamManager",{enumerable:!0,get:function(){return d.StreamManager}});var l=n(7686);Object.defineProperty(t,"Stream",{enumerable:!0,get:function(){return l.Stream}});var p=n(3274);Object.defineProperty(t,"Connection",{enumerable:!0,get:function(){return p.Connection}});var h=n(1944);Object.defineProperty(t,"LocalRecorder",{enumerable:!0,get:function(){return h.LocalRecorder}});var f=n(6153);Object.defineProperty(t,"Filter",{enumerable:!0,get:function(){return f.Filter}});var m=n(9690);Object.defineProperty(t,"LocalRecorderState",{enumerable:!0,get:function(){return m.LocalRecorderState}});var v=n(7009);Object.defineProperty(t,"OpenViduError",{enumerable:!0,get:function(){return v.OpenViduError}}),Object.defineProperty(t,"OpenViduErrorName",{enumerable:!0,get:function(){return v.OpenViduErrorName}});var g=n(1513);Object.defineProperty(t,"TypeOfVideo",{enumerable:!0,get:function(){return g.TypeOfVideo}});var b=n(4270);Object.defineProperty(t,"VideoInsertMode",{enumerable:!0,get:function(){return b.VideoInsertMode}});var E=n(6300);Object.defineProperty(t,"Event",{enumerable:!0,get:function(){return E.Event}});var y=n(5223);Object.defineProperty(t,"ConnectionEvent",{enumerable:!0,get:function(){return y.ConnectionEvent}});var S=n(8271);Object.defineProperty(t,"PublisherSpeakingEvent",{enumerable:!0,get:function(){return S.PublisherSpeakingEvent}});var w=n(8856);Object.defineProperty(t,"RecordingEvent",{enumerable:!0,get:function(){return w.RecordingEvent}});var O=n(3439);Object.defineProperty(t,"SessionDisconnectedEvent",{enumerable:!0,get:function(){return O.SessionDisconnectedEvent}});var C=n(3685);Object.defineProperty(t,"SignalEvent",{enumerable:!0,get:function(){return C.SignalEvent}});var I=n(3590);Object.defineProperty(t,"StreamEvent",{enumerable:!0,get:function(){return I.StreamEvent}});var R=n(3977);Object.defineProperty(t,"StreamManagerEvent",{enumerable:!0,get:function(){return R.StreamManagerEvent}});var P=n(6367);Object.defineProperty(t,"VideoElementEvent",{enumerable:!0,get:function(){return P.VideoElementEvent}});var T=n(7614);Object.defineProperty(t,"StreamPropertyChangedEvent",{enumerable:!0,get:function(){return T.StreamPropertyChangedEvent}});var k=n(6203);Object.defineProperty(t,"ConnectionPropertyChangedEvent",{enumerable:!0,get:function(){return k.ConnectionPropertyChangedEvent}});var _=n(146);Object.defineProperty(t,"FilterEvent",{enumerable:!0,get:function(){return _.FilterEvent}});var x=n(9233);Object.defineProperty(t,"NetworkQualityLevelChangedEvent",{enumerable:!0,get:function(){return x.NetworkQualityLevelChangedEvent}});var N=n(1342);Object.defineProperty(t,"SpeechToTextEvent",{enumerable:!0,get:function(){return N.SpeechToTextEvent}});var L=n(6056);Object.defineProperty(t,"ExceptionEvent",{enumerable:!0,get:function(){return L.ExceptionEvent}}),Object.defineProperty(t,"ExceptionEventName",{enumerable:!0,get:function(){return L.ExceptionEventName}});var M=n(3013);Object.defineProperty(t,"EventDispatcher",{enumerable:!0,get:function(){return M.EventDispatcher}}),i(n(6252),t),o.JL.setOptions({enabled:!1})},1795:function(e,t,n){var r;e=n.nmd(e),(function(){"use strict";var i={function:!0,object:!0},o=i[typeof window]&&window||this,s=i[typeof t]&&t,a=i.object&&e&&!e.nodeType&&e,c=s&&a&&"object"==typeof n.g&&n.g;c&&(c.global===c||c.window===c||c.self===c)&&(o=c);var u=/\bOpera/,d=Object.prototype,l=d.hasOwnProperty,p=d.toString;function h(e){return(e=String(e)).charAt(0).toUpperCase()+e.slice(1)}function f(e){return e=E(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:h(e)}function m(e,t){for(var n in e)l.call(e,n)&&t(e[n],n,e)}function v(e){return null==e?h(e):p.call(e).slice(8,-1)}function g(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function b(e,t){var n=null;return function(e,t){var n=-1,r=e?e.length:0;if("number"==typeof r&&r>-1&&r<=9007199254740991)for(;++n<r;)t(e[n],n,e);else m(e,t)}(e,function(r,i){n=t(n,r,i,e)}),n}function E(e){return String(e).replace(/^ +| +$/g,"")}var y=function e(t){var n,r,i,s,a,c=o,d=t&&"object"==typeof t&&"String"!=v(t);d&&(c=t,t=null);var l=c.navigator||{},h=l.userAgent||"";t||(t=h);var y=d?!!l.likeChrome:/\bChrome\b/.test(t)&&!/internal|\n/i.test(p.toString()),S="Object",w=d?S:"ScriptBridgingProxyObject",O=d?S:"Environment",C=d&&c.java?"JavaPackage":v(c.java),I=d?S:"RuntimeObject",R=/\bJava/.test(C)&&c.java,P=R&&v(c.environment)==O,T=c.document||{},k=c.operamini||c.opera,_=u.test(_=d&&k?k["[[Class]]"]:v(k))?_:k=null,x=t,N=[],L=null,M=t==h,A=M&&k&&"function"==typeof k.version&&k.version(),V=b([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],function(e,n){return e||RegExp("\\b"+(n.pattern||g(n))+"\\b","i").exec(t)&&(n.label||n)}),D=b(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"],function(e,n){return e||RegExp("\\b"+(n.pattern||g(n))+"\\b","i").exec(t)&&(n.label||n)}),j=F([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),B=b({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}},function(e,n,r){return e||(n[j]||n[/^[a-z]+(?: +[a-z]+\b)*/i.exec(j)]||RegExp("\\b"+g(r)+"(?:\\b|\\w*\\d)","i").exec(t))&&r}),U=b(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "],function(e,n){var r,i,o,s=n.pattern||g(n);return!e&&(e=RegExp("\\b"+s+"(?:/[\\d.]+|[ \\w.]*)","i").exec(t))&&(r=e,i=n.label||n,o={"10.0":"10","6.4":"10 Technical Preview","6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"},s&&i&&/^Win/i.test(r)&&!/^Windows Phone /i.test(r)&&(o=o[/[\d.]+$/.exec(r)])&&(r="Windows "+o),r=String(r),s&&i&&(r=r.replace(RegExp(s,"i"),i)),e=r=f(r.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])),e});function F(e){return b(e,function(e,n){var r=n.pattern||g(n);return!e&&(e=RegExp("\\b"+r+" *\\d+[.\\w_]*","i").exec(t)||RegExp("\\b"+r+" *\\w+-[\\w]*","i").exec(t)||RegExp("\\b"+r+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(t))&&((e=String(n.label&&!RegExp(r,"i").test(n.label)?n.label:e).split("/"))[1]&&!/[\d.]+/.test(e[0])&&(e[0]+=" "+e[1]),n=n.label||n,e=f(e[0].replace(RegExp(r,"i"),n).replace(RegExp("; *(?:"+n+"[_-])?","i")," ").replace(RegExp("("+n+")[-_.]?(\\w)","i"),"$1 $2"))),e})}function W(e){return b(e,function(e,n){return e||(RegExp(n+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(t)||0)[1]||null})}if(V&&(V=[V]),/\bAndroid\b/.test(U)&&!j&&(s=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(t))&&(j=E(s[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),B&&!j?j=F([B]):B&&j&&(j=j.replace(RegExp("^("+g(B)+")[-_.\\s]","i"),B+" ").replace(RegExp("^("+g(B)+")[-_.]?(\\w)","i"),B+" $2")),(s=/\bGoogle TV\b/.exec(j))&&(j=s[0]),/\bSimulator\b/i.test(t)&&(j=(j?j+" ":"")+"Simulator"),"Opera Mini"==D&&/\bOPiOS\b/.test(t)&&N.push("running in Turbo/Uncompressed mode"),"IE"==D&&/\blike iPhone OS\b/.test(t)?(B=(s=e(t.replace(/like iPhone OS/,""))).manufacturer,j=s.product):/^iP/.test(j)?(D||(D="Safari"),U="iOS"+((s=/ OS ([\d_]+)/i.exec(t))?" "+s[1].replace(/_/g,"."):"")):"Konqueror"==D&&/^Linux\b/i.test(U)?U="Kubuntu":B&&"Google"!=B&&(/Chrome/.test(D)&&!/\bMobile Safari\b/i.test(t)||/\bVita\b/.test(j))||/\bAndroid\b/.test(U)&&/^Chrome/.test(D)&&/\bVersion\//i.test(t)?(D="Android Browser",U=/\bAndroid\b/.test(U)?U:"Android"):"Silk"==D?(/\bMobi/i.test(t)||(U="Android",N.unshift("desktop mode")),/Accelerated *= *true/i.test(t)&&N.unshift("accelerated")):"UC Browser"==D&&/\bUCWEB\b/.test(t)?N.push("speed mode"):"PaleMoon"==D&&(s=/\bFirefox\/([\d.]+)\b/.exec(t))?N.push("identifying as Firefox "+s[1]):"Firefox"==D&&(s=/\b(Mobile|Tablet|TV)\b/i.exec(t))?(U||(U="Firefox OS"),j||(j=s[1])):!D||(s=!/\bMinefield\b/i.test(t)&&/\b(?:Firefox|Safari)\b/.exec(D))?(D&&!j&&/[\/,]|^[^(]+?\)/.test(t.slice(t.indexOf(s+"/")+8))&&(D=null),(s=j||B||U)&&(j||B||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(U))&&(D=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(U)?U:s)+" Browser")):"Electron"==D&&(s=(/\bChrome\/([\d.]+)\b/.exec(t)||0)[1])&&N.push("Chromium "+s),A||(A=W(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",g(D),"(?:Firefox|Minefield|NetFront)"])),(s="iCab"==V&&parseFloat(A)>3&&"WebKit"||/\bOpera\b/.test(D)&&(/\bOPR\b/.test(t)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(t)&&!/^(?:Trident|EdgeHTML)$/.test(V)&&"WebKit"||!V&&/\bMSIE\b/i.test(t)&&("Mac OS"==U?"Tasman":"Trident")||"WebKit"==V&&/\bPlayStation\b(?! Vita\b)/i.test(D)&&"NetFront")&&(V=[s]),"IE"==D&&(s=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(t)||0)[1])?(D+=" Mobile",U="Windows Phone "+(/\+$/.test(s)?s:s+".x"),N.unshift("desktop mode")):/\bWPDesktop\b/i.test(t)?(D="IE Mobile",U="Windows Phone 8.x",N.unshift("desktop mode"),A||(A=(/\brv:([\d.]+)/.exec(t)||0)[1])):"IE"!=D&&"Trident"==V&&(s=/\brv:([\d.]+)/.exec(t))&&(D&&N.push("identifying as "+D+(A?" "+A:"")),D="IE",A=s[1]),M){if(r="global",i=null!=(n=c)?typeof n[r]:"number",/^(?:boolean|number|string|undefined)$/.test(i)||"object"==i&&!n[r])v(s=c.runtime)==w?(D="Adobe AIR",U=s.flash.system.Capabilities.os):v(s=c.phantom)==I?(D="PhantomJS",A=(s=s.version||null)&&s.major+"."+s.minor+"."+s.patch):"number"==typeof T.documentMode&&(s=/\bTrident\/(\d+)/i.exec(t))?(A=[A,T.documentMode],(s=+s[1]+4)!=A[1]&&(N.push("IE "+A[1]+" mode"),V&&(V[1]=""),A[1]=s),A="IE"==D?String(A[1].toFixed(1)):A[0]):"number"==typeof T.documentMode&&/^(?:Chrome|Firefox)\b/.test(D)&&(N.push("masking as "+D+" "+A),D="IE",A="11.0",V=["Trident"],U="Windows");else if(R&&(x=(s=R.lang.System).getProperty("os.arch"),U=U||s.getProperty("os.name")+" "+s.getProperty("os.version")),P){try{A=c.require("ringo/engine").version.join("."),D="RingoJS"}catch(e){(s=c.system)&&s.global.system==c.system&&(D="Narwhal",U||(U=s[0].os||null))}D||(D="Rhino")}else"object"==typeof c.process&&!c.process.browser&&(s=c.process)&&("object"==typeof s.versions&&("string"==typeof s.versions.electron?(N.push("Node "+s.versions.node),D="Electron",A=s.versions.electron):"string"==typeof s.versions.nw&&(N.push("Chromium "+A,"Node "+s.versions.node),D="NW.js",A=s.versions.nw)),D||(D="Node.js",x=s.arch,U=s.platform,A=(A=/[\d.]+/.exec(s.version))?A[0]:null));U=U&&f(U)}if(A&&(s=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(A)||/(?:alpha|beta)(?: ?\d)?/i.exec(t+";"+(M&&l.appMinorVersion))||/\bMinefield\b/i.test(t)&&"a")&&(L=/b/i.test(s)?"beta":"alpha",A=A.replace(RegExp(s+"\\+?$"),"")+("beta"==L?R?"b":"β":R?"a":"α")+(/\d+\+?/.exec(s)||"")),"Fennec"==D||"Firefox"==D&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(U))D="Firefox Mobile";else if("Maxthon"==D&&A)A=A.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(j))"Xbox 360"==j&&(U=null),"Xbox 360"==j&&/\bIEMobile\b/.test(t)&&N.unshift("mobile mode");else if((/^(?:Chrome|IE|Opera)$/.test(D)||D&&!j&&!/Browser|Mobi/.test(D))&&("Windows CE"==U||/Mobi/i.test(t)))D+=" Mobile";else if("IE"==D&&M)try{null===c.external&&N.unshift("platform preview")}catch(e){N.unshift("embedded")}else(/\bBlackBerry\b/.test(j)||/\bBB10\b/.test(t))&&(s=(RegExp(j.replace(/ +/g," *")+"/([.\\d]+)","i").exec(t)||0)[1]||A)?(U=((s=[s,/BB10/.test(t)])[1]?(j=null,B="BlackBerry"):"Device Software")+" "+s[0],A=null):this!=m&&"Wii"!=j&&(M&&k||/Opera/.test(D)&&/\b(?:MSIE|Firefox)\b/i.test(t)||"Firefox"==D&&/\bOS X (?:\d+\.){2,}/.test(U)||"IE"==D&&(U&&!/^Win/.test(U)&&A>5.5||/\bWindows XP\b/.test(U)&&A>8||8==A&&!/\bTrident\b/.test(t)))&&!u.test(s=e.call(m,t.replace(u,"")+";"))&&s.name&&(s="ing as "+s.name+((s=s.version)?" "+s:""),u.test(D)?(/\bIE\b/.test(s)&&"Mac OS"==U&&(U=null),s="identify"+s):(s="mask"+s,D=_?f(_.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(s)&&(U=null),M||(A=null)),V=["Presto"],N.push(s));(s=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(t)||0)[1])&&(s=[parseFloat(s.replace(/\.(\d)$/,".0$1")),s],"Safari"==D&&"+"==s[1].slice(-1)?(D="WebKit Nightly",L="alpha",A=s[1].slice(0,-1)):(A==s[1]||A==(s[2]=(/\bSafari\/([\d.]+\+?)/i.exec(t)||0)[1]))&&(A=null),s[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(t)||0)[1],537.36==s[0]&&537.36==s[2]&&parseFloat(s[1])>=28&&"WebKit"==V&&(V=["Blink"]),M&&(y||s[1])?(V&&(V[1]="like Chrome"),s=s[1]||((s=s[0])<530?1:s<532?2:s<532.05?3:s<533?4:s<534.03?5:s<534.07?6:s<534.1?7:s<534.13?8:s<534.16?9:s<534.24?10:s<534.3?11:s<535.01?12:s<535.02?"13+":s<535.07?15:s<535.11?16:s<535.19?17:s<536.05?18:s<536.1?19:s<537.01?20:s<537.11?"21+":s<537.13?23:s<537.18?24:s<537.24?25:s<537.36?26:"Blink"!=V?"27":"28")):(V&&(V[1]="like Safari"),s=(s=s[0])<400?1:s<500?2:s<526?3:s<533?4:s<534?"4+":s<535?5:s<537?6:s<538?7:s<601?8:s<602?9:s<604?10:s<606?11:s<608?12:"12"),V&&(V[1]+=" "+(s+="number"==typeof s?".x":/[.+]/.test(s)?"":"+")),"Safari"==D&&(!A||parseInt(A)>45)?A=s:"Chrome"==D&&/\bHeadlessChrome/i.test(t)&&N.unshift("headless")),"Opera"==D&&(s=/\bzbov|zvav$/.exec(U))?(D+=" ",N.unshift("desktop mode"),"zvav"==s?(D+="Mini",A=null):D+="Mobile",U=U.replace(RegExp(" *"+s+"$"),"")):"Safari"==D&&/\bChrome\b/.exec(V&&V[1])?(N.unshift("desktop mode"),D="Chrome Mobile",A=null,/\bOS X\b/.test(U)?(B="Apple",U="iOS 4.3+"):U=null):/\bSRWare Iron\b/.test(D)&&!A&&(A=W("Chrome")),A&&0==A.indexOf(s=/[\d.]+$/.exec(U))&&t.indexOf("/"+s+"-")>-1&&(U=E(U.replace(s,""))),U&&-1!=U.indexOf(D)&&!RegExp(D+" OS").test(U)&&(U=U.replace(RegExp(" *"+g(D)+" *"),"")),V&&!/\b(?:Avant|Nook)\b/.test(D)&&(/Browser|Lunascape|Maxthon/.test(D)||"Safari"!=D&&/^iOS/.test(U)&&/\bSafari\b/.test(V[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(D)&&V[1])&&(s=V[V.length-1])&&N.push(s),N.length&&(N=["("+N.join("; ")+")"]),B&&j&&0>j.indexOf(B)&&N.push("on "+B),j&&N.push((/^on /.test(N[N.length-1])?"":"on ")+j),U&&(a=(s=/ ([\d.+]+)$/.exec(U))&&"/"==U.charAt(U.length-s[0].length-1),U={architecture:32,family:s&&!a?U.replace(s[0],""):U,version:s?s[1]:null,toString:function(){var e=this.version;return this.family+(e&&!a?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(s=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(x))&&!/\bi686\b/i.test(x)?(U&&(U.architecture=64,U.family=U.family.replace(RegExp(" *"+s),"")),D&&(/\bWOW64\b/i.test(t)||M&&/\w(?:86|32)$/.test(l.cpuClass||l.platform)&&!/\bWin64; x64\b/i.test(t))&&N.unshift("32-bit")):U&&/^OS X/.test(U.family)&&"Chrome"==D&&parseFloat(A)>=39&&(U.architecture=64),t||(t=null);var H={};return H.description=t,H.layout=V&&V[0],H.manufacturer=B,H.name=D,H.prerelease=L,H.product=j,H.ua=t,H.version=D&&A,H.os=U||{architecture:null,family:null,version:null,toString:function(){return"null"}},H.parse=e,H.toString=function(){return this.description||""},H.version&&N.unshift(A),H.name&&N.unshift(D),U&&D&&!(U==String(U).split(" ")[0]&&(U==D.split(" ")[0]||j))&&N.push(j?"("+U+")":"on "+U),N.length&&(H.description=N.join(" ")),H}();o.platform=y,void 0!==(r=(function(){return y}).call(t,n,t,e))&&(e.exports=r)}).call(this)},6376:function(e,t,n){let r=n(4359),{MAX_LENGTH:i,MAX_SAFE_INTEGER:o}=n(3295),{re:s,t:a}=n(5765),c=n(2893),{compareIdentifiers:u}=n(6742);class d{constructor(e,t){if(t=c(t),e instanceof d){if(!!t.loose===e.loose&&!!t.includePrerelease===e.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw TypeError(`Invalid Version: ${e}`);if(e.length>i)throw TypeError(`version is longer than ${i} characters`);r("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let n=e.trim().match(t.loose?s[a.LOOSE]:s[a.FULL]);if(!n)throw TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>o||this.major<0)throw TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(e=>{if(/^[0-9]+$/.test(e)){let t=+e;if(t>=0&&t<o)return t}return e}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(r("SemVer.compare",this.version,this.options,e),!(e instanceof d)){if("string"==typeof e&&e===this.version)return 0;e=new d(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof d||(e=new d(e,this.options)),u(this.major,e.major)||u(this.minor,e.minor)||u(this.patch,e.patch)}comparePre(e){if(e instanceof d||(e=new d(e,this.options)),this.prerelease.length&&!e.prerelease.length)return -1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{let n=this.prerelease[t],i=e.prerelease[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return -1;if(n===i)continue;else return u(n,i)}while(++t)}compareBuild(e){e instanceof d||(e=new d(e,this.options));let t=0;do{let n=this.build[t],i=e.build[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return -1;if(n===i)continue;else return u(n,i)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":(0!==this.minor||0!==this.patch||0===this.prerelease.length)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(0!==this.patch||0===this.prerelease.length)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let e=this.prerelease.length;for(;--e>=0;)"number"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}t&&(0===u(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}}e.exports=d},6378:function(e,t,n){let r=n(6376);e.exports=(e,t)=>new r(e,t).major},7789:function(e,t,n){let r=n(6376);e.exports=(e,t)=>new r(e,t).minor},3295:function(e){let t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:t,MAX_SAFE_COMPONENT_LENGTH:16}},4359:function(e,t,n){var r=n(3454);let i="object"==typeof r&&r.env&&r.env.NODE_DEBUG&&/\bsemver\b/i.test(r.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=i},6742:function(e){let t=/^[0-9]+$/,n=(e,n)=>{let r=t.test(e),i=t.test(n);return r&&i&&(e=+e,n=+n),e===n?0:r&&!i?-1:i&&!r?1:e<n?-1:1};e.exports={compareIdentifiers:n,rcompareIdentifiers:(e,t)=>n(t,e)}},2893:function(e){let t=["includePrerelease","loose","rtl"];e.exports=e=>e?"object"!=typeof e?{loose:!0}:t.filter(t=>e[t]).reduce((e,t)=>(e[t]=!0,e),{}):{}},5765:function(e,t,n){let{MAX_SAFE_COMPONENT_LENGTH:r}=n(3295),i=n(4359);t=e.exports={};let o=t.re=[],s=t.src=[],a=t.t={},c=0,u=(e,t,n)=>{let r=c++;i(e,r,t),a[e]=r,s[r]=t,o[r]=new RegExp(t,n?"g":void 0)};u("NUMERICIDENTIFIER","0|[1-9]\\d*"),u("NUMERICIDENTIFIERLOOSE","[0-9]+"),u("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),u("MAINVERSION",`(${s[a.NUMERICIDENTIFIER]})\\.(${s[a.NUMERICIDENTIFIER]})\\.(${s[a.NUMERICIDENTIFIER]})`),u("MAINVERSIONLOOSE",`(${s[a.NUMERICIDENTIFIERLOOSE]})\\.(${s[a.NUMERICIDENTIFIERLOOSE]})\\.(${s[a.NUMERICIDENTIFIERLOOSE]})`),u("PRERELEASEIDENTIFIER",`(?:${s[a.NUMERICIDENTIFIER]}|${s[a.NONNUMERICIDENTIFIER]})`),u("PRERELEASEIDENTIFIERLOOSE",`(?:${s[a.NUMERICIDENTIFIERLOOSE]}|${s[a.NONNUMERICIDENTIFIER]})`),u("PRERELEASE",`(?:-(${s[a.PRERELEASEIDENTIFIER]}(?:\\.${s[a.PRERELEASEIDENTIFIER]})*))`),u("PRERELEASELOOSE",`(?:-?(${s[a.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${s[a.PRERELEASEIDENTIFIERLOOSE]})*))`),u("BUILDIDENTIFIER","[0-9A-Za-z-]+"),u("BUILD",`(?:\\+(${s[a.BUILDIDENTIFIER]}(?:\\.${s[a.BUILDIDENTIFIER]})*))`),u("FULLPLAIN",`v?${s[a.MAINVERSION]}${s[a.PRERELEASE]}?${s[a.BUILD]}?`),u("FULL",`^${s[a.FULLPLAIN]}$`),u("LOOSEPLAIN",`[v=\\s]*${s[a.MAINVERSIONLOOSE]}${s[a.PRERELEASELOOSE]}?${s[a.BUILD]}?`),u("LOOSE",`^${s[a.LOOSEPLAIN]}$`),u("GTLT","((?:<|>)?=?)"),u("XRANGEIDENTIFIERLOOSE",`${s[a.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),u("XRANGEIDENTIFIER",`${s[a.NUMERICIDENTIFIER]}|x|X|\\*`),u("XRANGEPLAIN",`[v=\\s]*(${s[a.XRANGEIDENTIFIER]})(?:\\.(${s[a.XRANGEIDENTIFIER]})(?:\\.(${s[a.XRANGEIDENTIFIER]})(?:${s[a.PRERELEASE]})?${s[a.BUILD]}?)?)?`),u("XRANGEPLAINLOOSE",`[v=\\s]*(${s[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[a.XRANGEIDENTIFIERLOOSE]})(?:${s[a.PRERELEASELOOSE]})?${s[a.BUILD]}?)?)?`),u("XRANGE",`^${s[a.GTLT]}\\s*${s[a.XRANGEPLAIN]}$`),u("XRANGELOOSE",`^${s[a.GTLT]}\\s*${s[a.XRANGEPLAINLOOSE]}$`),u("COERCE",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?(?:$|[^\\d])`),u("COERCERTL",s[a.COERCE],!0),u("LONETILDE","(?:~>?)"),u("TILDETRIM",`(\\s*)${s[a.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",u("TILDE",`^${s[a.LONETILDE]}${s[a.XRANGEPLAIN]}$`),u("TILDELOOSE",`^${s[a.LONETILDE]}${s[a.XRANGEPLAINLOOSE]}$`),u("LONECARET","(?:\\^)"),u("CARETTRIM",`(\\s*)${s[a.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",u("CARET",`^${s[a.LONECARET]}${s[a.XRANGEPLAIN]}$`),u("CARETLOOSE",`^${s[a.LONECARET]}${s[a.XRANGEPLAINLOOSE]}$`),u("COMPARATORLOOSE",`^${s[a.GTLT]}\\s*(${s[a.LOOSEPLAIN]})$|^$`),u("COMPARATOR",`^${s[a.GTLT]}\\s*(${s[a.FULLPLAIN]})$|^$`),u("COMPARATORTRIM",`(\\s*)${s[a.GTLT]}\\s*(${s[a.LOOSEPLAIN]}|${s[a.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",u("HYPHENRANGE",`^\\s*(${s[a.XRANGEPLAIN]})\\s+-\\s+(${s[a.XRANGEPLAIN]})\\s*$`),u("HYPHENRANGELOOSE",`^\\s*(${s[a.XRANGEPLAINLOOSE]})\\s+-\\s+(${s[a.XRANGEPLAINLOOSE]})\\s*$`),u("STAR","(<|>)?=?\\s*\\*"),u("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),u("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},7429:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"NIL",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"v1",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"v3",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"v4",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"v5",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"validate",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"version",{enumerable:!0,get:function(){return c.default}});var r=p(n(3990)),i=p(n(8237)),o=p(n(5355)),s=p(n(3764)),a=p(n(6314)),c=p(n(8464)),u=p(n(6435)),d=p(n(4008)),l=p(n(8222));function p(e){return e&&e.__esModule?e:{default:e}}},4163:function(e,t){"use strict";function n(e){return(e+64>>>9<<4)+14+1}function r(e,t){let n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function i(e,t,n,i,o,s){var a;return r((a=r(r(t,e),r(i,s)))<<o|a>>>32-o,n)}function o(e,t,n,r,o,s,a){return i(t&n|~t&r,e,t,o,s,a)}function s(e,t,n,r,o,s,a){return i(t&r|n&~r,e,t,o,s,a)}function a(e,t,n,r,o,s,a){return i(t^n^r,e,t,o,s,a)}function c(e,t,n,r,o,s,a){return i(n^(t|~r),e,t,o,s,a)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default=function(e){if("string"==typeof e){let t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let n=0;n<t.length;++n)e[n]=t.charCodeAt(n)}return function(e){let t=[],n=32*e.length,r="0123456789abcdef";for(let i=0;i<n;i+=8){let n=e[i>>5]>>>i%32&255,o=parseInt(r.charAt(n>>>4&15)+r.charAt(15&n),16);t.push(o)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[n(t)-1]=t;let i=1732584193,u=-271733879,d=-1732584194,l=271733878;for(let t=0;t<e.length;t+=16){let n=i,p=u,h=d,f=l;i=o(i,u,d,l,e[t],7,-680876936),l=o(l,i,u,d,e[t+1],12,-389564586),d=o(d,l,i,u,e[t+2],17,606105819),u=o(u,d,l,i,e[t+3],22,-1044525330),i=o(i,u,d,l,e[t+4],7,-176418897),l=o(l,i,u,d,e[t+5],12,1200080426),d=o(d,l,i,u,e[t+6],17,-1473231341),u=o(u,d,l,i,e[t+7],22,-45705983),i=o(i,u,d,l,e[t+8],7,1770035416),l=o(l,i,u,d,e[t+9],12,-1958414417),d=o(d,l,i,u,e[t+10],17,-42063),u=o(u,d,l,i,e[t+11],22,-1990404162),i=o(i,u,d,l,e[t+12],7,1804603682),l=o(l,i,u,d,e[t+13],12,-40341101),d=o(d,l,i,u,e[t+14],17,-1502002290),u=o(u,d,l,i,e[t+15],22,1236535329),i=s(i,u,d,l,e[t+1],5,-165796510),l=s(l,i,u,d,e[t+6],9,-1069501632),d=s(d,l,i,u,e[t+11],14,643717713),u=s(u,d,l,i,e[t],20,-373897302),i=s(i,u,d,l,e[t+5],5,-701558691),l=s(l,i,u,d,e[t+10],9,38016083),d=s(d,l,i,u,e[t+15],14,-660478335),u=s(u,d,l,i,e[t+4],20,-405537848),i=s(i,u,d,l,e[t+9],5,568446438),l=s(l,i,u,d,e[t+14],9,-1019803690),d=s(d,l,i,u,e[t+3],14,-187363961),u=s(u,d,l,i,e[t+8],20,1163531501),i=s(i,u,d,l,e[t+13],5,-1444681467),l=s(l,i,u,d,e[t+2],9,-51403784),d=s(d,l,i,u,e[t+7],14,1735328473),u=s(u,d,l,i,e[t+12],20,-1926607734),i=a(i,u,d,l,e[t+5],4,-378558),l=a(l,i,u,d,e[t+8],11,-2022574463),d=a(d,l,i,u,e[t+11],16,1839030562),u=a(u,d,l,i,e[t+14],23,-35309556),i=a(i,u,d,l,e[t+1],4,-1530992060),l=a(l,i,u,d,e[t+4],11,1272893353),d=a(d,l,i,u,e[t+7],16,-155497632),u=a(u,d,l,i,e[t+10],23,-1094730640),i=a(i,u,d,l,e[t+13],4,681279174),l=a(l,i,u,d,e[t],11,-358537222),d=a(d,l,i,u,e[t+3],16,-722521979),u=a(u,d,l,i,e[t+6],23,76029189),i=a(i,u,d,l,e[t+9],4,-640364487),l=a(l,i,u,d,e[t+12],11,-421815835),d=a(d,l,i,u,e[t+15],16,530742520),u=a(u,d,l,i,e[t+2],23,-995338651),i=c(i,u,d,l,e[t],6,-198630844),l=c(l,i,u,d,e[t+7],10,1126891415),d=c(d,l,i,u,e[t+14],15,-1416354905),u=c(u,d,l,i,e[t+5],21,-57434055),i=c(i,u,d,l,e[t+12],6,1700485571),l=c(l,i,u,d,e[t+3],10,-1894986606),d=c(d,l,i,u,e[t+10],15,-1051523),u=c(u,d,l,i,e[t+1],21,-2054922799),i=c(i,u,d,l,e[t+8],6,1873313359),l=c(l,i,u,d,e[t+15],10,-30611744),d=c(d,l,i,u,e[t+6],15,-1560198380),u=c(u,d,l,i,e[t+13],21,1309151649),i=c(i,u,d,l,e[t+4],6,-145523070),l=c(l,i,u,d,e[t+11],10,-1120210379),d=c(d,l,i,u,e[t+2],15,718787259),u=c(u,d,l,i,e[t+9],21,-343485551),i=r(i,n),u=r(u,p),d=r(d,h),l=r(l,f)}return[i,u,d,l]}(function(e){if(0===e.length)return[];let t=8*e.length,r=new Uint32Array(n(t));for(let n=0;n<t;n+=8)r[n>>5]|=(255&e[n/8])<<n%32;return r}(e),8*e.length))}},4790:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;let n="undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);t.default={randomUUID:n}},6314:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default="00000000-0000-0000-0000-000000000000"},8222:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,i=(r=n(6435))&&r.__esModule?r:{default:r};t.default=function(e){let t;if(!(0,i.default)(e))throw TypeError("Invalid UUID");let n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n}},58:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},3319:function(e,t){"use strict";let n;Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if(!n&&!(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(r)};let r=new Uint8Array(16)},3757:function(e,t){"use strict";function n(e,t){return e<<t|e>>>32-t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default=function(e){let t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){let t=unescape(encodeURIComponent(e));e=[];for(let n=0;n<t.length;++n)e.push(t.charCodeAt(n))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);let i=e.length/4+2,o=Math.ceil(i/16),s=Array(o);for(let t=0;t<o;++t){let n=new Uint32Array(16);for(let r=0;r<16;++r)n[r]=e[64*t+4*r]<<24|e[64*t+4*r+1]<<16|e[64*t+4*r+2]<<8|e[64*t+4*r+3];s[t]=n}s[o-1][14]=(e.length-1)*8/4294967296,s[o-1][14]=Math.floor(s[o-1][14]),s[o-1][15]=(e.length-1)*8&4294967295;for(let e=0;e<o;++e){let i=new Uint32Array(80);for(let t=0;t<16;++t)i[t]=s[e][t];for(let e=16;e<80;++e)i[e]=n(i[e-3]^i[e-8]^i[e-14]^i[e-16],1);let o=r[0],a=r[1],c=r[2],u=r[3],d=r[4];for(let e=0;e<80;++e){let r=Math.floor(e/20),s=n(o,5)+function(e,t,n,r){switch(e){case 0:return t&n^~t&r;case 1:case 3:return t^n^r;case 2:return t&n^t&r^n&r}}(r,a,c,u)+d+t[r]+i[e]>>>0;d=u,u=c,c=n(a,30)>>>0,a=o,o=s}r[0]=r[0]+o>>>0,r[1]=r[1]+a>>>0,r[2]=r[2]+c>>>0,r[3]=r[3]+u>>>0,r[4]=r[4]+d>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]}},4008:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.unsafeStringify=s;var r,i=(r=n(6435))&&r.__esModule?r:{default:r};let o=[];for(let e=0;e<256;++e)o.push((e+256).toString(16).slice(1));function s(e,t=0){return(o[e[t+0]]+o[e[t+1]]+o[e[t+2]]+o[e[t+3]]+"-"+o[e[t+4]]+o[e[t+5]]+"-"+o[e[t+6]]+o[e[t+7]]+"-"+o[e[t+8]]+o[e[t+9]]+"-"+o[e[t+10]]+o[e[t+11]]+o[e[t+12]]+o[e[t+13]]+o[e[t+14]]+o[e[t+15]]).toLowerCase()}t.default=function(e,t=0){let n=s(e,t);if(!(0,i.default)(n))throw TypeError("Stringified UUID is invalid");return n}},3990:function(e,t,n){"use strict";let r,i;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,s=(o=n(3319))&&o.__esModule?o:{default:o},a=n(4008);let c=0,u=0;t.default=function(e,t,n){let o=t&&n||0,d=t||Array(16),l=(e=e||{}).node||r,p=void 0!==e.clockseq?e.clockseq:i;if(null==l||null==p){let t=e.random||(e.rng||s.default)();null==l&&(l=r=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==p&&(p=i=(t[6]<<8|t[7])&16383)}let h=void 0!==e.msecs?e.msecs:Date.now(),f=void 0!==e.nsecs?e.nsecs:u+1,m=h-c+(f-u)/1e4;if(m<0&&void 0===e.clockseq&&(p=p+1&16383),(m<0||h>c)&&void 0===e.nsecs&&(f=0),f>=1e4)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");c=h,u=f,i=p,h+=122192928e5;let v=((268435455&h)*1e4+f)%4294967296;d[o++]=v>>>24&255,d[o++]=v>>>16&255,d[o++]=v>>>8&255,d[o++]=255&v;let g=h/4294967296*1e4&268435455;d[o++]=g>>>8&255,d[o++]=255&g,d[o++]=g>>>24&15|16,d[o++]=g>>>16&255,d[o++]=p>>>8|128,d[o++]=255&p;for(let e=0;e<6;++e)d[o+e]=l[e];return t||(0,a.unsafeStringify)(d)}},8237:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(7925)),i=o(n(4163));function o(e){return e&&e.__esModule?e:{default:e}}let s=(0,r.default)("v3",48,i.default);t.default=s},7925:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.DNS=void 0,t.default=function(e,t,n){function r(e,r,s,a){var c;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));let t=[];for(let n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}(e)),"string"==typeof r&&(r=(0,o.default)(r)),(null===(c=r)||void 0===c?void 0:c.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let u=new Uint8Array(16+e.length);if(u.set(r),u.set(e,r.length),(u=n(u))[6]=15&u[6]|t,u[8]=63&u[8]|128,s){a=a||0;for(let e=0;e<16;++e)s[a+e]=u[e];return s}return(0,i.unsafeStringify)(u)}try{r.name=e}catch(e){}return r.DNS=s,r.URL=a,r};var r,i=n(4008),o=(r=n(8222))&&r.__esModule?r:{default:r};let s="6ba7b810-9dad-11d1-80b4-00c04fd430c8";t.DNS=s;let a="6ba7b811-9dad-11d1-80b4-00c04fd430c8";t.URL=a},5355:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(n(4790)),i=s(n(3319)),o=n(4008);function s(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t,n){if(r.default.randomUUID&&!t&&!e)return r.default.randomUUID();e=e||{};let s=e.random||(e.rng||i.default)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=s[e];return t}return(0,o.unsafeStringify)(s)}},3764:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(7925)),i=o(n(3757));function o(e){return e&&e.__esModule?e:{default:e}}let s=(0,r.default)("v5",80,i.default);t.default=s},6435:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,i=(r=n(58))&&r.__esModule?r:{default:r};t.default=function(e){return"string"==typeof e&&i.default.test(e)}},8464:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,i=(r=n(6435))&&r.__esModule?r:{default:r};t.default=function(e){if(!(0,i.default)(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)}},4114:function(e){function t(){}e.exports=t,t.mixin=function(e){var t=e.prototype||e;t.isWildEmitter=!0,t.on=function(e,t,n){this.callbacks=this.callbacks||{};var r=3==arguments.length,i=r?arguments[1]:void 0,o=r?arguments[2]:arguments[1];return o._groupName=i,(this.callbacks[e]=this.callbacks[e]||[]).push(o),this},t.once=function(e,t,n){var r=this,i=3==arguments.length,o=i?arguments[1]:void 0,s=i?arguments[2]:arguments[1];return this.on(e,o,function t(){r.off(e,t),s.apply(this,arguments)}),this},t.releaseGroup=function(e){var t,n,r,i;for(t in this.callbacks=this.callbacks||{},this.callbacks)for(n=0,r=(i=this.callbacks[t]).length;n<r;n++)i[n]._groupName===e&&(i.splice(n,1),n--,r--);return this},t.off=function(e,t){this.callbacks=this.callbacks||{};var n,r=this.callbacks[e];return r&&(1==arguments.length?delete this.callbacks[e]:-1!==(n=r.indexOf(t))&&(r.splice(n,1),0===r.length&&delete this.callbacks[e])),this},t.emit=function(e){this.callbacks=this.callbacks||{};var t,n,r,i=[].slice.call(arguments,1),o=this.callbacks[e],s=this.getWildcardCallbacks(e);if(o)for(t=0,n=(r=o.slice()).length;t<n&&r[t];++t)r[t].apply(this,i);if(s)for(t=0,n=s.length,n=(r=s.slice()).length;t<n&&r[t];++t)r[t].apply(this,[e].concat(i));return this},t.getWildcardCallbacks=function(e){this.callbacks=this.callbacks||{};var t,n,r=[];for(t in this.callbacks)n=t.split("*"),("*"===t||2===n.length&&e.slice(0,n[0].length)===n[0])&&(r=r.concat(this.callbacks[t]));return r}},t.mixin(t)},4795:function(e,t,n){var r;/*!
 * EventEmitter v5.2.9 - git.io/ee
 * Unlicense - http://unlicense.org/
 * Oliver Caldwell - https://oli.me.uk/
 * @preserve
 */!function(t){"use strict";function i(){}var o=i.prototype,s=t.EventEmitter;function a(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return -1}function c(e){return function(){return this[e].apply(this,arguments)}}o.getListeners=function(e){var t,n,r=this._getEvents();if(e instanceof RegExp)for(n in t={},r)r.hasOwnProperty(n)&&e.test(n)&&(t[n]=r[n]);else t=r[e]||(r[e]=[]);return t},o.flattenListeners=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n.push(e[t].listener);return n},o.getListenersAsObject=function(e){var t,n=this.getListeners(e);return n instanceof Array&&((t={})[e]=n),t||n},o.addListener=function(e,t){if(!function e(t){return"function"==typeof t||t instanceof RegExp||!!t&&"object"==typeof t&&e(t.listener)}(t))throw TypeError("listener must be a function");var n,r=this.getListenersAsObject(e),i="object"==typeof t;for(n in r)r.hasOwnProperty(n)&&-1===a(r[n],t)&&r[n].push(i?t:{listener:t,once:!1});return this},o.on=c("addListener"),o.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},o.once=c("addOnceListener"),o.defineEvent=function(e){return this.getListeners(e),this},o.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},o.removeListener=function(e,t){var n,r,i=this.getListenersAsObject(e);for(r in i)i.hasOwnProperty(r)&&-1!==(n=a(i[r],t))&&i[r].splice(n,1);return this},o.off=c("removeListener"),o.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},o.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},o.manipulateListeners=function(e,t,n){var r,i,o=e?this.removeListener:this.addListener,s=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(r=n.length;r--;)o.call(this,t,n[r]);else for(r in t)t.hasOwnProperty(r)&&(i=t[r])&&("function"==typeof i?o.call(this,r,i):s.call(this,r,i));return this},o.removeEvent=function(e){var t,n=this._getEvents();if("string"==typeof e)delete n[e];else if(e instanceof RegExp)for(t in n)n.hasOwnProperty(t)&&e.test(t)&&delete n[t];else delete this._events;return this},o.removeAllListeners=c("removeEvent"),o.emitEvent=function(e,t){var n,r,i,o,s=this.getListenersAsObject(e);for(o in s)if(s.hasOwnProperty(o))for(i=0,n=s[o].slice(0);i<n.length;i++)!0===(r=n[i]).once&&this.removeListener(e,r.listener),r.listener.apply(this,t||[])===this._getOnceReturnValue()&&this.removeListener(e,r.listener);return this},o.trigger=c("emitEvent"),o.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},o.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},o._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},o._getEvents=function(){return this._events||(this._events={})},i.noConflict=function(){return t.EventEmitter=s,i},void 0!==(r=(function(){return i}).call(t,n,t,e))&&(e.exports=r)}("undefined"!=typeof window?window:this||{})},8808:function(e){"use strict";e.exports=JSON.parse('["stun.l.google.com:19302","stun1.l.google.com:19302","stun2.l.google.com:19302","stun3.l.google.com:19302","stun4.l.google.com:19302","stun.ekiga.net","stun.ideasip.com","stun.schlund.de","stun.stunprotocol.org:3478","stun.voiparound.com","stun.voipbuster.com","stun.voipstunt.com","stun.voxgratia.org"]')},4576:function(e){"use strict";e.exports=[]},5549:function(e){"use strict";e.exports=JSON.parse('{"author":"OpenVidu","dependencies":{"freeice":"2.2.2","hark":"1.2.3","jsnlog":"2.30.0","mime":"3.0.0","platform":"1.3.6","semver":"7.3.8","uuid":"9.0.0","wolfy87-eventemitter":"5.2.9","events":"3.3.0","inherits":"2.0.4"},"description":"OpenVidu Browser","devDependencies":{"@types/node":"18.11.9","@types/platform":"1.3.4","browserify":"17.0.0","grunt":"1.5.3","grunt-cli":"1.4.3","grunt-contrib-copy":"1.0.0","grunt-contrib-sass":"2.0.0","grunt-contrib-uglify":"5.2.2","grunt-contrib-watch":"1.1.0","grunt-postcss":"0.9.0","grunt-string-replace":"1.3.3","grunt-ts":"6.0.0-beta.22","terser":"5.15.1","tsify":"5.0.4","tslint":"6.1.3","typedoc":"0.23.21","typescript":"4.9.3"},"license":"Apache-2.0","main":"lib/index.js","name":"openvidu-browser","repository":{"type":"git","url":"git://github.com/OpenVidu/openvidu"},"scripts":{"browserify":"VERSION=${VERSION:-dev}; mkdir -p static/js/ && cd src && ../node_modules/browserify/bin/cmd.js Main.ts -p [ tsify ] --exclude kurento-browser-extensions --debug -o ../static/js/openvidu-browser-$VERSION.js -v","browserify-prod":"VERSION=${VERSION:-dev}; mkdir -p static/js/ && cd src && ../node_modules/browserify/bin/cmd.js --debug Main.ts -p [ tsify ] --exclude kurento-browser-extensions | ../node_modules/terser/bin/terser --source-map content=inline --output ../static/js/openvidu-browser-$VERSION.min.js","build":"cd src/OpenVidu && ./../../node_modules/typescript/bin/tsc && cd ../.. && ./node_modules/typescript/bin/tsc --declaration src/index.ts --outDir ./lib --sourceMap --target es5 --lib dom,es5,es2015.promise,scripthost && rm -rf ./ts4.4 && mkdir -p ./ts4.4/lib && cp -r ./lib ./ts4.4 && find ./ts4.4/lib -type f ! -iname \'*.d.ts\' -delete && ./config/replace_for_ts44.sh","docs":"./generate-docs.sh"},"types":"lib/index.d.ts","typesVersions":{"<4.4":{"*":["ts4.4/*"]}},"version":"2.28.0"}')}}]);